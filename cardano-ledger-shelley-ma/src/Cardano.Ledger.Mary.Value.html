<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Mary.Value</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier">PolicyID</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier">AssetID</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier">policies</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier">showValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">FromCBOR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">ToCBOR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">fromCBOR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">toCBOR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Cardano.Ledger.Era</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Cardano.Ledger.Torsor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Torsor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Data.CannonicalMaps</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">cannonicalMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">cannonicalMapUnion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">pointWise</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Abelian</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Group</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Internal</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-identifier">link</span></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-identifier">link2</span></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-identifier">splitLookup</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assocs</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Shelley.Spec.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Shelley.Spec.Ledger.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">ScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier">Shelley.Spec.Ledger.Serialization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">decodeRecordNamed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Asset ID</span><span>
</span><span id="line-60"></span><span class="hs-keyword">newtype</span><span> </span><span id="AssetID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-var">AssetID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AssetID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-var">AssetID</span></a></span></span><span> </span><span class="hs-special">{</span><span id="assetID"><span class="annot"><span class="annottext">AssetID -&gt; ByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetID"><span class="hs-identifier hs-var hs-var">assetID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679168727"><span id="local-6989586621679168729"><span id="local-6989586621679168731"><span class="annot"><span class="annottext">Int -&gt; AssetID -&gt; ShowS
[AssetID] -&gt; ShowS
AssetID -&gt; String
(Int -&gt; AssetID -&gt; ShowS)
-&gt; (AssetID -&gt; String) -&gt; ([AssetID] -&gt; ShowS) -&gt; Show AssetID
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AssetID] -&gt; ShowS
$cshowList :: [AssetID] -&gt; ShowS
show :: AssetID -&gt; String
$cshow :: AssetID -&gt; String
showsPrec :: Int -&gt; AssetID -&gt; ShowS
$cshowsPrec :: Int -&gt; AssetID -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>      </span><span id="local-6989586621679168722"><span id="local-6989586621679168724"><span class="annot"><span class="annottext">AssetID -&gt; AssetID -&gt; Bool
(AssetID -&gt; AssetID -&gt; Bool)
-&gt; (AssetID -&gt; AssetID -&gt; Bool) -&gt; Eq AssetID
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AssetID -&gt; AssetID -&gt; Bool
$c/= :: AssetID -&gt; AssetID -&gt; Bool
== :: AssetID -&gt; AssetID -&gt; Bool
$c== :: AssetID -&gt; AssetID -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>      </span><span id="local-6989586621679168714"><span id="local-6989586621679168716"><span id="local-6989586621679168718"><span class="annot"><span class="annottext">Typeable AssetID
Typeable AssetID
-&gt; (AssetID -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy AssetID -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy [AssetID] -&gt; Size)
-&gt; ToCBOR AssetID
AssetID -&gt; Encoding
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [AssetID] -&gt; Size
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetID -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; ToCBOR a
encodedListSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [AssetID] -&gt; Size
$cencodedListSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [AssetID] -&gt; Size
encodedSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetID -&gt; Size
$cencodedSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetID -&gt; Size
toCBOR :: AssetID -&gt; Encoding
$ctoCBOR :: AssetID -&gt; Encoding
$cp1ToCBOR :: Typeable AssetID
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToCBOR</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>      </span><span id="local-6989586621679168708"><span id="local-6989586621679168710"><span class="annot"><span class="annottext">Typeable AssetID
Decoder s AssetID
Typeable AssetID
-&gt; (forall s. Decoder s AssetID)
-&gt; (Proxy AssetID -&gt; Text)
-&gt; FromCBOR AssetID
Proxy AssetID -&gt; Text
forall s. Decoder s AssetID
forall a.
Typeable a
-&gt; (forall s. Decoder s a) -&gt; (Proxy a -&gt; Text) -&gt; FromCBOR a
label :: Proxy AssetID -&gt; Text
$clabel :: Proxy AssetID -&gt; Text
fromCBOR :: Decoder s AssetID
$cfromCBOR :: forall s. Decoder s AssetID
$cp1FromCBOR :: Typeable AssetID
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">FromCBOR</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>      </span><span id="local-6989586621679168692"><span id="local-6989586621679168694"><span id="local-6989586621679168696"><span id="local-6989586621679168698"><span id="local-6989586621679168700"><span id="local-6989586621679168702"><span id="local-6989586621679168704"><span class="annot"><span class="annottext">Eq AssetID
Eq AssetID
-&gt; (AssetID -&gt; AssetID -&gt; Ordering)
-&gt; (AssetID -&gt; AssetID -&gt; Bool)
-&gt; (AssetID -&gt; AssetID -&gt; Bool)
-&gt; (AssetID -&gt; AssetID -&gt; Bool)
-&gt; (AssetID -&gt; AssetID -&gt; Bool)
-&gt; (AssetID -&gt; AssetID -&gt; AssetID)
-&gt; (AssetID -&gt; AssetID -&gt; AssetID)
-&gt; Ord AssetID
AssetID -&gt; AssetID -&gt; Bool
AssetID -&gt; AssetID -&gt; Ordering
AssetID -&gt; AssetID -&gt; AssetID
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: AssetID -&gt; AssetID -&gt; AssetID
$cmin :: AssetID -&gt; AssetID -&gt; AssetID
max :: AssetID -&gt; AssetID -&gt; AssetID
$cmax :: AssetID -&gt; AssetID -&gt; AssetID
&gt;= :: AssetID -&gt; AssetID -&gt; Bool
$c&gt;= :: AssetID -&gt; AssetID -&gt; Bool
&gt; :: AssetID -&gt; AssetID -&gt; Bool
$c&gt; :: AssetID -&gt; AssetID -&gt; Bool
&lt;= :: AssetID -&gt; AssetID -&gt; Bool
$c&lt;= :: AssetID -&gt; AssetID -&gt; Bool
&lt; :: AssetID -&gt; AssetID -&gt; Bool
$c&lt; :: AssetID -&gt; AssetID -&gt; Bool
compare :: AssetID -&gt; AssetID -&gt; Ordering
$ccompare :: AssetID -&gt; AssetID -&gt; Ordering
$cp1Ord :: Eq AssetID
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>      </span><span id="local-6989586621679168685"><span id="local-6989586621679168687"><span id="local-6989586621679168689"><span class="annot"><span class="annottext">Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo)
Proxy AssetID -&gt; String
(Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy AssetID -&gt; String)
-&gt; NoThunks AssetID
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy AssetID -&gt; String
$cshowTypeOf :: Proxy AssetID -&gt; String
wNoThunks :: Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; AssetID -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>      </span><span id="local-6989586621679168682"><span class="annot"><span class="annottext">AssetID -&gt; ()
(AssetID -&gt; ()) -&gt; NFData AssetID
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: AssetID -&gt; ()
$crnf :: AssetID -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Policy ID</span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="PolicyID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-var">PolicyID</span></a></span></span><span> </span><span id="local-6989586621679168680"><span class="annot"><a href="#local-6989586621679168680"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PolicyID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-var">PolicyID</span></a></span></span><span> </span><span class="hs-special">{</span><span id="policyID"><span class="annot"><span class="annottext">PolicyID era -&gt; ScriptHash era
</span><a href="Cardano.Ledger.Mary.Value.html#policyID"><span class="hs-identifier hs-var hs-var">policyID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168680"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679168672"><span id="local-6989586621679168674"><span id="local-6989586621679168676"><span class="annot"><span class="annottext">Int -&gt; PolicyID era -&gt; ShowS
[PolicyID era] -&gt; ShowS
PolicyID era -&gt; String
(Int -&gt; PolicyID era -&gt; ShowS)
-&gt; (PolicyID era -&gt; String)
-&gt; ([PolicyID era] -&gt; ShowS)
-&gt; Show (PolicyID era)
forall era. Int -&gt; PolicyID era -&gt; ShowS
forall era. [PolicyID era] -&gt; ShowS
forall era. PolicyID era -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PolicyID era] -&gt; ShowS
$cshowList :: forall era. [PolicyID era] -&gt; ShowS
show :: PolicyID era -&gt; String
$cshow :: forall era. PolicyID era -&gt; String
showsPrec :: Int -&gt; PolicyID era -&gt; ShowS
$cshowsPrec :: forall era. Int -&gt; PolicyID era -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168668"><span id="local-6989586621679168670"><span class="annot"><span class="annottext">PolicyID era -&gt; PolicyID era -&gt; Bool
(PolicyID era -&gt; PolicyID era -&gt; Bool)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Bool) -&gt; Eq (PolicyID era)
forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c/= :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
== :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c== :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168661"><span id="local-6989586621679168663"><span id="local-6989586621679168665"><span class="annot"><span class="annottext">Typeable (PolicyID era)
Typeable (PolicyID era)
-&gt; (PolicyID era -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy (PolicyID era) -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy [PolicyID era] -&gt; Size)
-&gt; ToCBOR (PolicyID era)
PolicyID era -&gt; Encoding
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID era] -&gt; Size
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID era) -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; ToCBOR a
forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (PolicyID era)
forall era.
(Era era, Typeable (Script era)) =&gt;
PolicyID era -&gt; Encoding
forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID era] -&gt; Size
forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID era) -&gt; Size
encodedListSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID era] -&gt; Size
$cencodedListSizeExpr :: forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID era] -&gt; Size
encodedSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID era) -&gt; Size
$cencodedSizeExpr :: forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID era) -&gt; Size
toCBOR :: PolicyID era -&gt; Encoding
$ctoCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
PolicyID era -&gt; Encoding
$cp1ToCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (PolicyID era)
</span><a href="#local-6989586621679168661"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToCBOR</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168656"><span id="local-6989586621679168658"><span class="annot"><span class="annottext">Typeable (PolicyID era)
Decoder s (PolicyID era)
Typeable (PolicyID era)
-&gt; (forall s. Decoder s (PolicyID era))
-&gt; (Proxy (PolicyID era) -&gt; Text)
-&gt; FromCBOR (PolicyID era)
Proxy (PolicyID era) -&gt; Text
forall s. Decoder s (PolicyID era)
forall a.
Typeable a
-&gt; (forall s. Decoder s a) -&gt; (Proxy a -&gt; Text) -&gt; FromCBOR a
forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (PolicyID era)
forall era.
(Era era, Typeable (Script era)) =&gt;
Proxy (PolicyID era) -&gt; Text
forall era s.
(Era era, Typeable (Script era)) =&gt;
Decoder s (PolicyID era)
label :: Proxy (PolicyID era) -&gt; Text
$clabel :: forall era.
(Era era, Typeable (Script era)) =&gt;
Proxy (PolicyID era) -&gt; Text
fromCBOR :: Decoder s (PolicyID era)
$cfromCBOR :: forall era s.
(Era era, Typeable (Script era)) =&gt;
Decoder s (PolicyID era)
$cp1FromCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (PolicyID era)
</span><a href="#local-6989586621679168656"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">FromCBOR</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168641"><span id="local-6989586621679168643"><span id="local-6989586621679168645"><span id="local-6989586621679168647"><span id="local-6989586621679168649"><span id="local-6989586621679168651"><span id="local-6989586621679168653"><span class="annot"><span class="annottext">Eq (PolicyID era)
Eq (PolicyID era)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Ordering)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Bool)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Bool)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Bool)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; Bool)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; PolicyID era)
-&gt; (PolicyID era -&gt; PolicyID era -&gt; PolicyID era)
-&gt; Ord (PolicyID era)
PolicyID era -&gt; PolicyID era -&gt; Bool
PolicyID era -&gt; PolicyID era -&gt; Ordering
PolicyID era -&gt; PolicyID era -&gt; PolicyID era
forall era. Eq (PolicyID era)
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
forall era. PolicyID era -&gt; PolicyID era -&gt; Ordering
forall era. PolicyID era -&gt; PolicyID era -&gt; PolicyID era
min :: PolicyID era -&gt; PolicyID era -&gt; PolicyID era
$cmin :: forall era. PolicyID era -&gt; PolicyID era -&gt; PolicyID era
max :: PolicyID era -&gt; PolicyID era -&gt; PolicyID era
$cmax :: forall era. PolicyID era -&gt; PolicyID era -&gt; PolicyID era
&gt;= :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c&gt;= :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
&gt; :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c&gt; :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
&lt;= :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c&lt;= :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
&lt; :: PolicyID era -&gt; PolicyID era -&gt; Bool
$c&lt; :: forall era. PolicyID era -&gt; PolicyID era -&gt; Bool
compare :: PolicyID era -&gt; PolicyID era -&gt; Ordering
$ccompare :: forall era. PolicyID era -&gt; PolicyID era -&gt; Ordering
$cp1Ord :: forall era. Eq (PolicyID era)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168635"><span id="local-6989586621679168637"><span id="local-6989586621679168639"><span class="annot"><span class="annottext">Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
Proxy (PolicyID era) -&gt; String
(Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (PolicyID era) -&gt; String)
-&gt; NoThunks (PolicyID era)
forall era. Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
forall era. Proxy (PolicyID era) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (PolicyID era) -&gt; String
$cshowTypeOf :: forall era. Proxy (PolicyID era) -&gt; String
wNoThunks :: Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall era. Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall era. Context -&gt; PolicyID era -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679168635"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168633"><span class="annot"><span class="annottext">PolicyID era -&gt; ()
(PolicyID era -&gt; ()) -&gt; NFData (PolicyID era)
forall era. PolicyID era -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: PolicyID era -&gt; ()
$crnf :: forall era. PolicyID era -&gt; ()
</span><a href="#local-6989586621679168633"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | The Value representing MultiAssets</span><span>
</span><span id="line-76"></span><span id="local-6989586621679168631"><span id="local-6989586621679168632"></span></span><span class="hs-keyword">data</span><span> </span><span id="Value"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span></span><span> </span><span id="local-6989586621679168843"><span class="annot"><a href="#local-6989586621679168843"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Value"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168843"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-type">AssetID</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679168624"><span id="local-6989586621679168626"><span id="local-6989586621679168628"><span class="annot"><span class="annottext">Int -&gt; Value era -&gt; ShowS
[Value era] -&gt; ShowS
Value era -&gt; String
(Int -&gt; Value era -&gt; ShowS)
-&gt; (Value era -&gt; String)
-&gt; ([Value era] -&gt; ShowS)
-&gt; Show (Value era)
forall era. Int -&gt; Value era -&gt; ShowS
forall era. [Value era] -&gt; ShowS
forall era. Value era -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Value era] -&gt; ShowS
$cshowList :: forall era. [Value era] -&gt; ShowS
show :: Value era -&gt; String
$cshow :: forall era. Value era -&gt; String
showsPrec :: Int -&gt; Value era -&gt; ShowS
$cshowsPrec :: forall era. Int -&gt; Value era -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Value era -&gt; Rep (Value era) x)
-&gt; (forall x. Rep (Value era) x -&gt; Value era)
-&gt; Generic (Value era)
forall x. Rep (Value era) x -&gt; Value era
forall x. Value era -&gt; Rep (Value era) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall era x. Rep (Value era) x -&gt; Value era
forall era x. Value era -&gt; Rep (Value era) x
$cto :: forall era x. Rep (Value era) x -&gt; Value era
$cfrom :: forall era x. Value era -&gt; Rep (Value era) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679168620"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168617"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168620"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168620"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679168616"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168616"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679168615"><span class="annot"><span class="annottext">== :: Value era -&gt; Value era -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679168614"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168614"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Bool) -&gt; Value era -&gt; Value era -&gt; Bool
forall t. Val t =&gt; (Integer -&gt; Integer -&gt; Bool) -&gt; t -&gt; t -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var">pointwise</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168616"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168614"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- TODO make these specific</span><span>
</span><span id="line-83"></span><span id="local-6989586621679168612"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168610"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168612"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679168609"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168603"><span id="local-6989586621679168605"><span id="local-6989586621679168607"><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168609"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="local-6989586621679168602"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168597"><span id="local-6989586621679168599"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168602"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168595"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168595"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168594"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168594"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679168593"><span class="annot"><span class="annottext">&lt;&gt; :: Value era -&gt; Value era -&gt; Value era
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168592"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168592"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679168591"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168591"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168595"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168592"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map AssetID Integer -&gt; Map AssetID Integer -&gt; Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMapUnion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; Map AssetID Integer
-&gt; Map AssetID Integer
-&gt; Map AssetID Integer
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMapUnion</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168594"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168591"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679168589"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168583"><span id="local-6989586621679168585"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168589"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679168581"><span class="annot"><span class="annottext">mempty :: Value era
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679168580"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168574"><span id="local-6989586621679168576"><span class="annot"><span class="hs-identifier hs-type">Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168580"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679168572"><span class="annot"><span class="annottext">invert :: Value era -&gt; Value era
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">invert</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168570"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168570"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168569"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168569"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168570"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map AssetID Integer -&gt; Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Map AssetID Integer -&gt; Map AssetID Integer
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168569"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621679168567"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abelian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168567"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- ===================================================</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Make the Val instance of Value</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679168564"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679168555"><span id="local-6989586621679168558"><span id="local-6989586621679168560"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168564"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168564"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679168547"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679168547"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679168546"><span class="annot"><span class="annottext">&lt;&#215;&gt; :: i -&gt; Value era -&gt; Value era
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&#215;&gt;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168544"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168544"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168543"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168543"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679168547"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168544"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map AssetID Integer -&gt; Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Map AssetID Integer -&gt; Map AssetID Integer
forall k a.
(Ord k, CannonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">cannonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679168547"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168543"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679168542"><span class="annot"><span class="annottext">isZero :: Value era -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">isZero</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168540"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168540"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168539"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168539"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168540"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168539"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679168536"><span class="annot"><span class="annottext">coin :: Value era -&gt; Coin
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">coin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168534"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168534"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168534"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679168532"><span class="annot"><span class="annottext">inject :: Coin -&gt; Value era
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621679168530"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168530"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168530"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679168529"><span class="annot"><span class="annottext">modifyCoin :: (Coin -&gt; Coin) -&gt; Value era -&gt; Value era
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyCoin</span></a></span></span><span> </span><span id="local-6989586621679168527"><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621679168527"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168526"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168526"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168525"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168525"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168524"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168525"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621679168524"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168524"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621679168527"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168526"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679168523"><span class="annot"><span class="annottext">pointwise :: (Integer -&gt; Integer -&gt; Bool) -&gt; Value era -&gt; Value era -&gt; Bool
</span><a href="#local-6989586621679168523"><span class="hs-identifier hs-var hs-var hs-var hs-var">pointwise</span></a></span></span><span> </span><span id="local-6989586621679168522"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679168522"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168521"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168521"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168520"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168520"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168519"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168519"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679168518"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168518"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679168522"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168521"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168519"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map AssetID Integer -&gt; Map AssetID Integer -&gt; Bool)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Bool
forall k v.
(Ord k, CannonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Bool)
-&gt; Map AssetID Integer -&gt; Map AssetID Integer -&gt; Bool
forall k v.
(Ord k, CannonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679168522"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168520"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168518"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679168517"><span class="annot"><span class="annottext">size :: Value era -&gt; Integer
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679168515"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168515"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- add uint for the Coin portion in this size calculation</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="annottext">(Map AssetID Integer -&gt; Integer -&gt; Integer)
-&gt; Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Integer
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer -&gt; Integer -&gt; Integer
forall (t :: * -&gt; *) p. Foldable t =&gt; t p -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168513"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168512"><span class="hs-identifier hs-var">uint</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168515"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-comment">-- add addrHashLen for each Policy ID</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621679168513"><span class="annot"><span class="annottext">accum :: t p -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168513"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679168511"><span class="annot"><span class="annottext">t p
</span><a href="#local-6989586621679168511"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679168510"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168510"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p -&gt; Integer -&gt; Integer) -&gt; Integer -&gt; t p -&gt; Integer
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; Integer -&gt; Integer
forall p. p -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168509"><span class="hs-identifier hs-var">accumIns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168510"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168508"><span class="hs-identifier hs-var">addrHashLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t p
</span><a href="#local-6989586621679168511"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-comment">-- add assetIdLen and uint for each asset of that Policy ID</span><span>
</span><span id="line-124"></span><span>          </span><span id="local-6989586621679168509"><span class="annot"><span class="annottext">accumIns :: p -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168509"><span class="hs-identifier hs-var hs-var">accumIns</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679168507"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168507"><span class="hs-identifier hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168507"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168506"><span class="hs-identifier hs-var">assetIdLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168512"><span class="hs-identifier hs-var">uint</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-comment">-- TODO move these constants somewhere (they are also specified in CDDL)</span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><a href="#local-6989586621679168512"><span class="hs-identifier hs-type">uint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621679168512"><span class="annot"><span class="annottext">uint :: Integer
</span><a href="#local-6989586621679168512"><span class="hs-identifier hs-var hs-var">uint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><a href="#local-6989586621679168506"><span class="hs-identifier hs-type">assetIdLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621679168506"><span class="annot"><span class="annottext">assetIdLen :: Integer
</span><a href="#local-6989586621679168506"><span class="hs-identifier hs-var hs-var">assetIdLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- address hash length is always same as Policy ID length</span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="#local-6989586621679168508"><span class="hs-identifier hs-type">addrHashLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621679168508"><span class="annot"><span class="annottext">addrHashLen :: Integer
</span><a href="#local-6989586621679168508"><span class="hs-identifier hs-var hs-var">addrHashLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">28</span></span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- CBOR</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- TODO filter out 0s at deserialization</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- TODO Probably the actual serialization will be of the formal Coin OR Value type</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Maybe better to make this distinction in the TxOut de/serialization</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679168505"><span class="hs-keyword">instance</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679168499"><span id="local-6989586621679168501"><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679168498"><span class="annot"><span class="annottext">toCBOR :: Value era -&gt; Encoding
</span><a href="#local-6989586621679168498"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168497"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168497"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168496"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168496"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168497"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168496"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679168495"><span class="hs-keyword">instance</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679168491"><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168495"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168495"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168495"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679168490"><span class="annot"><span class="annottext">fromCBOR :: Decoder s (Value era)
</span><a href="#local-6989586621679168490"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; (Value era -&gt; Int)
-&gt; Decoder s (Value era)
-&gt; Decoder s (Value era)
forall a s. Text -&gt; (a -&gt; Int) -&gt; Decoder s a -&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeRecordNamed</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Value&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Value era -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Decoder s (Value era) -&gt; Decoder s (Value era))
-&gt; Decoder s (Value era) -&gt; Decoder s (Value era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679168488"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168488"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Integer
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span id="local-6989586621679168487"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168487"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map (PolicyID era) (Map AssetID Integer))
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><span class="annottext">Value era -&gt; Decoder s (Value era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Value era -&gt; Decoder s (Value era))
-&gt; Value era -&gt; Decoder s (Value era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168488"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168487"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- Compactible</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- This is used in the TxOut which stores the (CompactForm Value). For now that is just Value</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- We may revisit this, and make it some kind serialized bytes.</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="local-6989586621679168486"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168486"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- TODO a proper compact form</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="CompactForm"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var">CompactForm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168486"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompactValue"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getCompactValue"><span class="annot"><span class="annottext">CompactForm (Value era) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#getCompactValue"><span class="hs-identifier hs-var hs-var">getCompactValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168486"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679168474"><span id="local-6989586621679168476"><span id="local-6989586621679168478"><span class="annot"><span class="annottext">Typeable (CompactForm (Value era))
Typeable (CompactForm (Value era))
-&gt; (CompactForm (Value era) -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy (CompactForm (Value era)) -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
    -&gt; Proxy [CompactForm (Value era)] -&gt; Size)
-&gt; ToCBOR (CompactForm (Value era))
CompactForm (Value era) -&gt; Encoding
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (Value era)] -&gt; Size
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (Value era)) -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. ToCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; ToCBOR a
forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (CompactForm (Value era))
forall era.
(Era era, Typeable (Script era)) =&gt;
CompactForm (Value era) -&gt; Encoding
forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (Value era)] -&gt; Size
forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (Value era)) -&gt; Size
encodedListSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (Value era)] -&gt; Size
$cencodedListSizeExpr :: forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (Value era)] -&gt; Size
encodedSizeExpr :: (forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (Value era)) -&gt; Size
$cencodedSizeExpr :: forall era.
(Era era, Typeable (Script era)) =&gt;
(forall t. ToCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (Value era)) -&gt; Size
toCBOR :: CompactForm (Value era) -&gt; Encoding
$ctoCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
CompactForm (Value era) -&gt; Encoding
$cp1ToCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (CompactForm (Value era))
</span><a href="#local-6989586621679168474"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToCBOR</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168469"><span id="local-6989586621679168471"><span class="annot"><span class="annottext">Typeable (CompactForm (Value era))
Decoder s (CompactForm (Value era))
Typeable (CompactForm (Value era))
-&gt; (forall s. Decoder s (CompactForm (Value era)))
-&gt; (Proxy (CompactForm (Value era)) -&gt; Text)
-&gt; FromCBOR (CompactForm (Value era))
Proxy (CompactForm (Value era)) -&gt; Text
forall s. Decoder s (CompactForm (Value era))
forall a.
Typeable a
-&gt; (forall s. Decoder s a) -&gt; (Proxy a -&gt; Text) -&gt; FromCBOR a
forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (CompactForm (Value era))
forall era.
(Era era, Typeable (Script era)) =&gt;
Proxy (CompactForm (Value era)) -&gt; Text
forall era s.
(Era era, Typeable (Script era)) =&gt;
Decoder s (CompactForm (Value era))
label :: Proxy (CompactForm (Value era)) -&gt; Text
$clabel :: forall era.
(Era era, Typeable (Script era)) =&gt;
Proxy (CompactForm (Value era)) -&gt; Text
fromCBOR :: Decoder s (CompactForm (Value era))
$cfromCBOR :: forall era s.
(Era era, Typeable (Script era)) =&gt;
Decoder s (CompactForm (Value era))
$cp1FromCBOR :: forall era.
(Era era, Typeable (Script era)) =&gt;
Typeable (CompactForm (Value era))
</span><a href="#local-6989586621679168469"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">FromCBOR</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679168468"><span class="annot"><span class="annottext">toCompact :: Value era -&gt; CompactForm (Value era)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCompact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; CompactForm (Value era)
forall era. Value era -&gt; CompactForm (Value era)
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679168466"><span class="annot"><span class="annottext">fromCompact :: CompactForm (Value era) -&gt; Value era
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCompact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompactForm (Value era) -&gt; Value era
forall era. CompactForm (Value era) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#getCompactValue"><span class="hs-identifier hs-var hs-var">getCompactValue</span></a></span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679168464"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168464"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-type">Torsor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168464"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- TODO a proper torsor form</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Delta"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var">Delta</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168464"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168464"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679168460"><span class="annot"><span class="annottext">addDelta :: Value era -&gt; Delta (Value era) -&gt; Value era
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">addDelta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Delta (Value era) -&gt; Value era
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-operator hs-var">(&lt;+&gt;)</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679168457"><span class="annot"><span class="annottext">toDelta :: Value era -&gt; Delta (Value era)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/shelley-spec-ledger-0.1.0.0/noopt/doc/html/shelley-spec-ledger/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDelta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Delta (Value era)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- Operations on Values</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Extract the set of policies in the Value.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">--   This function is equivalent to computing the support of the value in the</span><span>
</span><span id="line-186"></span><span class="hs-comment">--   spec.</span><span>
</span><span id="line-187"></span><span id="local-6989586621679168454"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier hs-type">policies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168454"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168454"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-188"></span><span id="policies"><span class="annot"><span class="annottext">policies :: Value era -&gt; Set (PolicyID era)
</span><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier hs-var hs-var">policies</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679168453"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168453"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer) -&gt; Set (PolicyID era)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168453"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679168451"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168451"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-type">AssetID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168451"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-191"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: PolicyID era -&gt; AssetID -&gt; Value era -&gt; Integer
</span><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679168450"><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168450"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span id="local-6989586621679168449"><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168449"><span class="hs-identifier hs-var">aid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679168448"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168448"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Maybe (Map AssetID Integer)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168450"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168448"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Map AssetID Integer)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679168446"><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168446"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; AssetID -&gt; Map AssetID Integer -&gt; Integer
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">Map.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168449"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168446"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | insert comb policy asset n v,</span><span>
</span><span id="line-197"></span><span class="hs-comment">--   if comb = \ old new -&gt; old, the integer in the Value is prefered over n</span><span>
</span><span id="line-198"></span><span class="hs-comment">--   if comb = \ old new -&gt; new, then n is prefered over the integer in the Value</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   if (comb old new) == 0, then that value should not be stored in the Map part of the Value.</span><span>
</span><span id="line-200"></span><span id="local-6989586621679168444"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168444"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-type">AssetID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168444"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168444"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-207"></span><span id="insert"><span class="annot"><span class="annottext">insert :: (Integer -&gt; Integer -&gt; Integer)
-&gt; PolicyID era -&gt; AssetID -&gt; Integer -&gt; Value era -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679168443"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168443"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679168442"><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span id="local-6989586621679168441"><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168441"><span class="hs-identifier hs-var">aid</span></a></span></span><span> </span><span id="local-6989586621679168440"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168439"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621679168438"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168438"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; (Map (PolicyID era) (Map AssetID Integer),
    Maybe (Map AssetID Integer),
    Map (PolicyID era) (Map AssetID Integer))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">splitLookup</span></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168438"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679168437"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168437"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679168436"><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168436"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168435"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168435"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AssetID
-&gt; Map AssetID Integer
-&gt; (Map AssetID Integer, Maybe Integer, Map AssetID Integer)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">splitLookup</span></span><span> </span><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168441"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168436"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679168434"><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168434"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679168433"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168433"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168432"><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168432"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168431"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-214"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679168430"><span class="annot"><span class="annottext">m3 :: Map AssetID Integer
</span><a href="#local-6989586621679168430"><span class="hs-identifier hs-var hs-var">m3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AssetID Integer -&gt; Map AssetID Integer -&gt; Map AssetID Integer
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168434"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168432"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168430"><span class="hs-identifier hs-var">m3</span></a></span><span>
</span><span id="line-216"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168437"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168435"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map AssetID Integer
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168430"><span class="hs-identifier hs-var">m3</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168437"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168435"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map AssetID Integer
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetID
-&gt; Integer
-&gt; Map AssetID Integer
-&gt; Map AssetID Integer
-&gt; Map AssetID Integer
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168441"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168431"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168434"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168432"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168437"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168435"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>            </span><span id="local-6989586621679168431"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621679168431"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679168443"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168433"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AssetID Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map AssetID Integer
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span>
</span><span id="line-225"></span><span>                </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span><span>
</span><span id="line-226"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-227"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168436"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-228"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetID -&gt; Integer -&gt; Map AssetID Integer -&gt; Map AssetID Integer
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168441"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetID Integer
</span><a href="#local-6989586621679168436"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>                </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168437"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-231"></span><span>                </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168435"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679168428"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168428"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Map AssetID Integer)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168427"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168427"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
forall era.
Integer -&gt; Map (PolicyID era) (Map AssetID Integer) -&gt; Value era
</span><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168439"><span class="hs-identifier hs-var">cn</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168428"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168427"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-238"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PolicyID era
-&gt; Map AssetID Integer
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
-&gt; Map (PolicyID era) (Map AssetID Integer)
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679168442"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetID -&gt; Integer -&gt; Map AssetID Integer
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">AssetID
</span><a href="#local-6989586621679168441"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168440"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168428"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168427"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- ========================================================</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Display a Value as a String, one token per line</span><span>
</span><span id="line-244"></span><span id="local-6989586621679168425"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier hs-type">showValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168425"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-245"></span><span id="showValue"><span class="annot"><span class="annottext">showValue :: Value era -&gt; String
</span><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier hs-var hs-var">showValue</span></a></span></span><span> </span><span id="local-6989586621679168424"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168424"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168422"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((PolicyID era, AssetID, Integer) -&gt; String)
-&gt; [(PolicyID era, AssetID, Integer)] -&gt; Context
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(PolicyID era, AssetID, Integer) -&gt; String
forall a a era. (Show a, Show a) =&gt; (PolicyID era, a, a) -&gt; String
</span><a href="#local-6989586621679168420"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID era, AssetID, Integer)]
</span><a href="#local-6989586621679168419"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679168422"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168422"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168419"><span class="annot"><span class="annottext">[(PolicyID era, AssetID, Integer)]
</span><a href="#local-6989586621679168419"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; (Integer, [(PolicyID era, AssetID, Integer)])
forall era.
Value era -&gt; (Integer, [(PolicyID era, AssetID, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var">gettriples</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679168424"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679168420"><span class="annot"><span class="annottext">trans :: (PolicyID era, a, a) -&gt; String
</span><a href="#local-6989586621679168420"><span class="hs-identifier hs-var hs-var">trans</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span id="local-6989586621679168417"><span class="annot"><span class="annottext">ScriptHash era
</span><a href="#local-6989586621679168417"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168416"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168415"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168415"><span class="hs-identifier hs-var">cnt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><span class="annottext">ScriptHash era -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash era
</span><a href="#local-6989586621679168417"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,  &quot;</span></span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168416"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,  &quot;</span></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168415"><span class="hs-identifier hs-var">cnt</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span id="local-6989586621679168758"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-type">gettriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168758"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679168758"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetID"><span class="hs-identifier hs-type">AssetID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-256"></span><span id="gettriples"><span class="annot"><span class="annottext">gettriples :: Value era -&gt; (Integer, [(PolicyID era, AssetID, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var hs-var">gettriples</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679168414"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168414"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679168413"><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168413"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679168414"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((PolicyID era, Map AssetID Integer)
 -&gt; [(PolicyID era, AssetID, Integer)]
 -&gt; [(PolicyID era, AssetID, Integer)])
-&gt; [(PolicyID era, AssetID, Integer)]
-&gt; [(PolicyID era, Map AssetID Integer)]
-&gt; [(PolicyID era, AssetID, Integer)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(PolicyID era, Map AssetID Integer)
-&gt; [(PolicyID era, AssetID, Integer)]
-&gt; [(PolicyID era, AssetID, Integer)]
forall a b c. (a, Map b c) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="#local-6989586621679168412"><span class="hs-identifier hs-var">accum1</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
-&gt; [(PolicyID era, Map AssetID Integer)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">assocs</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID era) (Map AssetID Integer)
</span><a href="#local-6989586621679168413"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679168412"><span class="annot"><span class="annottext">accum1 :: (a, Map b c) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="#local-6989586621679168412"><span class="hs-identifier hs-var hs-var">accum1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679168411"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168411"><span class="hs-identifier hs-var">policy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168410"><span class="annot"><span class="annottext">Map b c
</span><a href="#local-6989586621679168410"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679168409"><span class="annot"><span class="annottext">[(a, b, c)]
</span><a href="#local-6989586621679168409"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b, c) -&gt; [(a, b, c)] -&gt; [(a, b, c)])
-&gt; [(a, b, c)] -&gt; [(b, c)] -&gt; [(a, b, c)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(b, c) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="#local-6989586621679168408"><span class="hs-identifier hs-var">accum2</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b, c)]
</span><a href="#local-6989586621679168409"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map b c -&gt; [(b, c)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">assocs</span></span><span> </span><span class="annot"><span class="annottext">Map b c
</span><a href="#local-6989586621679168410"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679168408"><span class="annot"><span class="annottext">accum2 :: (b, c) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="#local-6989586621679168408"><span class="hs-identifier hs-var hs-var">accum2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679168407"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679168407"><span class="hs-identifier hs-var">asset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679168406"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679168406"><span class="hs-identifier hs-var">cnt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679168405"><span class="annot"><span class="annottext">[(a, b, c)]
</span><a href="#local-6989586621679168405"><span class="hs-identifier hs-var">ans2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679168411"><span class="hs-identifier hs-var">policy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679168407"><span class="hs-identifier hs-var">asset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679168406"><span class="hs-identifier hs-var">cnt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b, c) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, b, c)]
</span><a href="#local-6989586621679168405"><span class="hs-identifier hs-var">ans2</span></a></span><span>
</span><span id="line-261"></span></pre></body></html>