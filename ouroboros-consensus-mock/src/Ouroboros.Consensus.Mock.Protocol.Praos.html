<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_Fn2SeS69nNBEEX93ZtWn8j"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns               #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass             #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures             #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards            #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving         #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications           #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances       #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses    #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | Proof of concept implementation of Praos</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Mock.Protocol.Praos</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier">Praos</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier">PraosFields</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier">PraosExtraFields</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier">PraosParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier">PraosChainDepState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier">HotKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier">forgePraosFields</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier">HotKeyEvolutionError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier">evolveKey</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Tags</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier">PraosCrypto</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier">PraosStandardCrypto</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier">PraosMockCrypto</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier">PraosValidateView</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier">praosValidateView</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier">PraosValidationError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Type instances</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">ConsensusConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier">BlockInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ticked</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">serializeEncoding'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeListLenOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.DSIGN.Ed448</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Ed448DSIGN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.Hash.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">HashAlgorithm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">hashToBytes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>                     </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">hashWithSerialiser</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">sizeHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.Hash.MD5</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">MD5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.Hash.SHA256</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">SHA256</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.KES.Class</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.KES.Mock</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.KES.Simple</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.Util</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.VRF.Class</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.VRF.Mock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">MockVRF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.VRF.Simple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">SimpleVRF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier">Cardano.Slotting.EpochInfo</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html"><span class="hs-identifier">Ouroboros.Consensus.Mock.Ledger.Stake</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.NodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Abstract</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Signed</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Util.Condense</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Fields required by Praos in the header
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | The fields that Praos required in the header</span><span>
</span><span id="line-86"></span><span id="local-6989586621679161531"><span id="local-6989586621679161532"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-var">PraosFields</span></a></span></span><span> </span><span id="local-6989586621679161753"><span class="annot"><a href="#local-6989586621679161753"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679161752"><span class="annot"><a href="#local-6989586621679161752"><span class="hs-identifier hs-type">toSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-var">PraosFields</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-87"></span><span>      </span><span id="praosSignature"><span class="annot"><span class="annottext">PraosFields c toSign -&gt; SignedKES (PraosKES c) toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignature"><span class="hs-identifier hs-var hs-var">praosSignature</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SignedKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161753"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679161752"><span class="hs-identifier hs-type">toSign</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosExtraFields"><span class="annot"><span class="annottext">PraosFields c toSign -&gt; PraosExtraFields c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosExtraFields"><span class="hs-identifier hs-var hs-var">praosExtraFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161753"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PraosFields c toSign -&gt; Rep (PraosFields c toSign) x)
-&gt; (forall x. Rep (PraosFields c toSign) x -&gt; PraosFields c toSign)
-&gt; Generic (PraosFields c toSign)
forall x. Rep (PraosFields c toSign) x -&gt; PraosFields c toSign
forall x. PraosFields c toSign -&gt; Rep (PraosFields c toSign) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c toSign x.
Rep (PraosFields c toSign) x -&gt; PraosFields c toSign
forall c toSign x.
PraosFields c toSign -&gt; Rep (PraosFields c toSign) x
$cto :: forall c toSign x.
Rep (PraosFields c toSign) x -&gt; PraosFields c toSign
$cfrom :: forall c toSign x.
PraosFields c toSign -&gt; Rep (PraosFields c toSign) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span id="local-6989586621679161523"><span id="local-6989586621679161524"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161517"><span id="local-6989586621679161519"><span id="local-6989586621679161521"><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161524"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679161523"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161524"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161523"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- use generic instance</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Fields that should be included in the signature</span><span>
</span><span id="line-96"></span><span id="local-6989586621679161514"><span id="local-6989586621679161515"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosExtraFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-var">PraosExtraFields</span></a></span></span><span> </span><span id="local-6989586621679161747"><span class="annot"><a href="#local-6989586621679161747"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosExtraFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-var">PraosExtraFields</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-97"></span><span>      </span><span id="praosCreator"><span class="annot"><span class="annottext">PraosExtraFields c -&gt; CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosCreator"><span class="hs-identifier hs-var hs-var">praosCreator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosRho"><span class="annot"><span class="annottext">PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosRho"><span class="hs-identifier hs-var hs-var">praosRho</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertifiedVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161747"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosY"><span class="annot"><span class="annottext">PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosY"><span class="hs-identifier hs-var hs-var">praosY</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertifiedVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161747"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x)
-&gt; (forall x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c)
-&gt; Generic (PraosExtraFields c)
forall x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
forall x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
forall c x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
$cto :: forall c x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
$cfrom :: forall c x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679161507"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161501"><span id="local-6989586621679161503"><span id="local-6989586621679161505"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161507"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161507"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">-- use generic instance</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="PraosValidateView"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span></span><span> </span><span id="local-6989586621679161791"><span class="annot"><a href="#local-6989586621679161791"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679161790"><span class="annot"><a href="#local-6989586621679161790"><span class="hs-identifier hs-type">signed</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161791"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679161790"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-108"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PraosValidateView"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161791"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161790"><span class="hs-identifier hs-type">signed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679161790"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Convenience constructor for 'PraosValidateView'</span><span>
</span><span id="line-111"></span><span id="local-6989586621679161498"><span id="local-6989586621679161499"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier hs-type">praosValidateView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">SignedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161499"><span class="hs-identifier hs-type">hdr</span></a></span><span>
</span><span id="line-112"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161498"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161499"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679161499"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161498"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161499"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679161499"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161498"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-116"></span><span id="praosValidateView"><span class="annot"><span class="annottext">praosValidateView :: (hdr -&gt; PraosFields c (Signed hdr)) -&gt; hdr -&gt; PraosValidateView c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier hs-var hs-var">praosValidateView</span></a></span></span><span> </span><span id="local-6989586621679161497"><span class="annot"><span class="annottext">hdr -&gt; PraosFields c (Signed hdr)
</span><a href="#local-6989586621679161497"><span class="hs-identifier hs-var">getFields</span></a></span></span><span> </span><span id="local-6989586621679161496"><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679161496"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">PraosFields c (Signed hdr) -&gt; Signed hdr -&gt; PraosValidateView c
forall c signed.
Signable (PraosKES c) signed =&gt;
PraosFields c signed -&gt; signed -&gt; PraosValidateView c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; PraosFields c (Signed hdr)
</span><a href="#local-6989586621679161497"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679161496"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; Signed hdr
forall hdr. SignedHeader hdr =&gt; hdr -&gt; Signed hdr
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">headerSigned</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679161496"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Forging
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679161493"><span id="local-6989586621679161494"></span></span><span class="hs-keyword">data</span><span> </span><span id="HotKey"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span></span><span> </span><span id="local-6989586621679161765"><span class="annot"><a href="#local-6989586621679161765"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>    </span><span id="HotKey"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Period</span></a></span><span>  </span><span class="hs-comment">-- ^ Absolute period of the KES key</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SignKeyKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161765"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="HotKeyPoisoned"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. HotKey c -&gt; Rep (HotKey c) x)
-&gt; (forall x. Rep (HotKey c) x -&gt; HotKey c) -&gt; Generic (HotKey c)
forall x. Rep (HotKey c) x -&gt; HotKey c
forall x. HotKey c -&gt; Rep (HotKey c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (HotKey c) x -&gt; HotKey c
forall c x. HotKey c -&gt; Rep (HotKey c) x
$cto :: forall c x. Rep (HotKey c) x -&gt; HotKey c
$cfrom :: forall c x. HotKey c -&gt; Rep (HotKey c) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679161488"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161482"><span id="local-6989586621679161484"><span id="local-6989586621679161486"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161488"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161488"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679161475"><span id="local-6989586621679161477"><span id="local-6989586621679161479"><span id="local-6989586621679161481"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161481"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161481"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | The 'HotKey' could not be evolved to the given 'Period'.</span><span>
</span><span id="line-135"></span><span class="hs-keyword">newtype</span><span> </span><span id="HotKeyEvolutionError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HotKeyEvolutionError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Period</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161467"><span id="local-6989586621679161469"><span id="local-6989586621679161471"><span class="annot"><span class="annottext">Int -&gt; HotKeyEvolutionError -&gt; ShowS
[HotKeyEvolutionError] -&gt; ShowS
HotKeyEvolutionError -&gt; String
(Int -&gt; HotKeyEvolutionError -&gt; ShowS)
-&gt; (HotKeyEvolutionError -&gt; String)
-&gt; ([HotKeyEvolutionError] -&gt; ShowS)
-&gt; Show HotKeyEvolutionError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HotKeyEvolutionError] -&gt; ShowS
$cshowList :: [HotKeyEvolutionError] -&gt; ShowS
show :: HotKeyEvolutionError -&gt; String
$cshow :: HotKeyEvolutionError -&gt; String
showsPrec :: Int -&gt; HotKeyEvolutionError -&gt; ShowS
$cshowsPrec :: Int -&gt; HotKeyEvolutionError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | To be used in conjunction with, e.g., 'updateMVar'.</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- NOTE: when the key's period is after the target period, we shouldn't use</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- it, but we currently do. In real TPraos we check this in</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- 'tpraosCheckCanForge'.</span><span>
</span><span id="line-143"></span><span id="local-6989586621679161761"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-type">evolveKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-144"></span><span>     </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161761"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161761"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161761"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">UpdateInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161761"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161761"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-type">HotKeyEvolutionError</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-148"></span><span id="evolveKey"><span class="annot"><span class="annottext">evolveKey :: SlotNo
-&gt; HotKey c
-&gt; (HotKey c,
    UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-var hs-var">evolveKey</span></a></span></span><span> </span><span id="local-6989586621679161466"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161466"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span id="local-6989586621679161465"><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161465"><span class="hs-identifier hs-var">hotKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161465"><span class="hs-identifier hs-var">hotKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span id="local-6989586621679161464"><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161464"><span class="hs-identifier hs-var">keyPeriod</span></a></span></span><span> </span><span id="local-6989586621679161463"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161463"><span class="hs-identifier hs-var">oldKey</span></a></span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161464"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161462"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161465"><span class="hs-identifier hs-var">hotKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKey c -&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError
forall updated unchanged failed.
unchanged -&gt; UpdateInfo updated unchanged failed
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">Unchanged</span></a></span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161465"><span class="hs-identifier hs-var">hotKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; SignKeyKES (PraosKES c)
-&gt; Period
-&gt; Maybe (SignKeyKES (PraosKES c))
forall v.
(KESAlgorithm v, HasCallStack) =&gt;
ContextKES v -&gt; SignKeyKES v -&gt; Period -&gt; Maybe (SignKeyKES v)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">updateKES</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161463"><span class="hs-identifier hs-var">oldKey</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161464"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>           </span><span class="annot"><span class="annottext">Maybe (SignKeyKES (PraosKES c))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
forall c. HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError
forall updated unchanged failed.
failed -&gt; UpdateInfo updated unchanged failed
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">UpdateFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(HotKeyEvolutionError
 -&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError)
-&gt; HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Period -&gt; HotKeyEvolutionError
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161462"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679161458"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161458"><span class="hs-identifier hs-var">newKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>             </span><span class="annot"><span class="annottext">SlotNo
-&gt; HotKey c
-&gt; (HotKey c,
    UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError)
forall c.
PraosCrypto c =&gt;
SlotNo
-&gt; HotKey c
-&gt; (HotKey c,
    UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-var">evolveKey</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161466"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Period -&gt; SignKeyKES (PraosKES c) -&gt; HotKey c
forall c. Period -&gt; SignKeyKES (PraosKES c) -&gt; HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161464"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Period
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161458"><span class="hs-identifier hs-var">newKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
forall c. HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError
forall updated unchanged failed.
failed -&gt; UpdateInfo updated unchanged failed
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">UpdateFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(HotKeyEvolutionError
 -&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError)
-&gt; HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) (HotKey c) HotKeyEvolutionError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Period -&gt; HotKeyEvolutionError
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161462"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>   </span><span class="annot"><a href="#local-6989586621679161462"><span class="hs-identifier hs-type">targetPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Period</span></a></span><span>
</span><span id="line-162"></span><span>   </span><span id="local-6989586621679161462"><span class="annot"><span class="annottext">targetPeriod :: Period
</span><a href="#local-6989586621679161462"><span class="hs-identifier hs-var hs-var">targetPeriod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Period
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Period) -&gt; Word64 -&gt; Period
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161466"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679161454"><span id="local-6989586621679161455"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier hs-type">forgePraosFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-165"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679161454"><span class="hs-identifier hs-type">toSign</span></a></span><span>
</span><span id="line-166"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-167"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-169"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-170"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679161454"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161455"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161454"><span class="hs-identifier hs-type">toSign</span></a></span></span></span><span>
</span><span id="line-172"></span><span id="forgePraosFields"><span class="annot"><span class="annottext">forgePraosFields :: PraosProof c
-&gt; HotKey c
-&gt; (PraosExtraFields c -&gt; toSign)
-&gt; PraosFields c toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier hs-var hs-var">forgePraosFields</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161450"><span id="local-6989586621679161451"><span id="local-6989586621679161452"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
CoreNodeId
praosLeader :: forall c. PraosProof c -&gt; CoreNodeId
praosProofY :: forall c.
PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosProofRho :: forall c.
PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosLeader :: CoreNodeId
praosProofY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosProofRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161446"><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161446"><span class="hs-identifier hs-var">hotKey</span></a></span></span><span> </span><span id="local-6989586621679161445"><span class="annot"><span class="annottext">PraosExtraFields c -&gt; toSign
</span><a href="#local-6989586621679161445"><span class="hs-identifier hs-var">mkToSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679161446"><span class="hs-identifier hs-var">hotKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span id="local-6989586621679161444"><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161444"><span class="hs-identifier hs-var">kesPeriod</span></a></span></span><span> </span><span id="local-6989586621679161443"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161443"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosFields :: forall c toSign.
SignedKES (PraosKES c) toSign
-&gt; PraosExtraFields c -&gt; PraosFields c toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-175"></span><span>          </span><span class="annot"><span class="annottext">praosSignature :: SignedKES (PraosKES c) toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignature"><span class="hs-identifier hs-var">praosSignature</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; Period
-&gt; toSign
-&gt; SignKeyKES (PraosKES c)
-&gt; SignedKES (PraosKES c) toSign
forall v a.
(KESAlgorithm v, Signable v a) =&gt;
ContextKES v -&gt; Period -&gt; a -&gt; SignKeyKES v -&gt; SignedKES v a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">signedKES</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679161444"><span class="hs-identifier hs-var">kesPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosExtraFields c -&gt; toSign
</span><a href="#local-6989586621679161445"><span class="hs-identifier hs-var">mkToSign</span></a></span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679161441"><span class="hs-identifier hs-var">signedFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679161443"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosExtraFields :: PraosExtraFields c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosExtraFields"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679161441"><span class="hs-identifier hs-var">signedFields</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PraosFields c toSign
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trying to sign with a poisoned key&quot;</span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679161441"><span class="annot"><span class="annottext">signedFields :: PraosExtraFields c
</span><a href="#local-6989586621679161441"><span class="hs-identifier hs-var hs-var">signedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields :: forall c.
CoreNodeId
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; PraosExtraFields c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">praosCreator :: CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosCreator"><span class="hs-identifier hs-var">praosCreator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161450"><span class="hs-identifier hs-var">praosLeader</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosRho"><span class="hs-identifier hs-var">praosRho</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161452"><span class="hs-identifier hs-var">praosProofRho</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosY"><span class="hs-identifier hs-var">praosY</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161451"><span class="hs-identifier hs-var">praosProofY</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Praos specific types
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679161438"><span id="local-6989586621679161439"></span></span><span class="hs-keyword">data</span><span> </span><span id="VRFType"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-var">VRFType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NONCE"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#NONCE"><span class="hs-identifier hs-var">NONCE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="TEST"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161430"><span id="local-6989586621679161432"><span id="local-6989586621679161434"><span class="annot"><span class="annottext">Int -&gt; VRFType -&gt; ShowS
[VRFType] -&gt; ShowS
VRFType -&gt; String
(Int -&gt; VRFType -&gt; ShowS)
-&gt; (VRFType -&gt; String) -&gt; ([VRFType] -&gt; ShowS) -&gt; Show VRFType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [VRFType] -&gt; ShowS
$cshowList :: [VRFType] -&gt; ShowS
show :: VRFType -&gt; String
$cshow :: VRFType -&gt; String
showsPrec :: Int -&gt; VRFType -&gt; ShowS
$cshowsPrec :: Int -&gt; VRFType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161426"><span id="local-6989586621679161428"><span class="annot"><span class="annottext">VRFType -&gt; VRFType -&gt; Bool
(VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool) -&gt; Eq VRFType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VRFType -&gt; VRFType -&gt; Bool
$c/= :: VRFType -&gt; VRFType -&gt; Bool
== :: VRFType -&gt; VRFType -&gt; Bool
$c== :: VRFType -&gt; VRFType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161410"><span id="local-6989586621679161412"><span id="local-6989586621679161414"><span id="local-6989586621679161416"><span id="local-6989586621679161418"><span id="local-6989586621679161420"><span id="local-6989586621679161422"><span class="annot"><span class="annottext">Eq VRFType
Eq VRFType
-&gt; (VRFType -&gt; VRFType -&gt; Ordering)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; VRFType)
-&gt; (VRFType -&gt; VRFType -&gt; VRFType)
-&gt; Ord VRFType
VRFType -&gt; VRFType -&gt; Bool
VRFType -&gt; VRFType -&gt; Ordering
VRFType -&gt; VRFType -&gt; VRFType
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: VRFType -&gt; VRFType -&gt; VRFType
$cmin :: VRFType -&gt; VRFType -&gt; VRFType
max :: VRFType -&gt; VRFType -&gt; VRFType
$cmax :: VRFType -&gt; VRFType -&gt; VRFType
&gt;= :: VRFType -&gt; VRFType -&gt; Bool
$c&gt;= :: VRFType -&gt; VRFType -&gt; Bool
&gt; :: VRFType -&gt; VRFType -&gt; Bool
$c&gt; :: VRFType -&gt; VRFType -&gt; Bool
&lt;= :: VRFType -&gt; VRFType -&gt; Bool
$c&lt;= :: VRFType -&gt; VRFType -&gt; Bool
&lt; :: VRFType -&gt; VRFType -&gt; Bool
$c&lt; :: VRFType -&gt; VRFType -&gt; Bool
compare :: VRFType -&gt; VRFType -&gt; Ordering
$ccompare :: VRFType -&gt; VRFType -&gt; Ordering
$cp1Ord :: Eq VRFType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. VRFType -&gt; Rep VRFType x)
-&gt; (forall x. Rep VRFType x -&gt; VRFType) -&gt; Generic VRFType
forall x. Rep VRFType x -&gt; VRFType
forall x. VRFType -&gt; Rep VRFType x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep VRFType x -&gt; VRFType
$cfrom :: forall x. VRFType -&gt; Rep VRFType x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161401"><span id="local-6989586621679161403"><span id="local-6989586621679161405"><span class="annot"><span class="annottext">Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
Proxy VRFType -&gt; String
(Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy VRFType -&gt; String)
-&gt; NoThunks VRFType
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy VRFType -&gt; String
$cshowTypeOf :: Proxy VRFType -&gt; String
wNoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679161401"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161393"><span id="local-6989586621679161395"><span id="local-6989586621679161397"><span id="local-6989586621679161399"><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span></span></span></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- use generic instance</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161386"><span id="local-6989586621679161388"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- This is a cheat, and at some point we probably want to decide on Serialise/ToCBOR</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679161384"><span class="annot"><span class="annottext">toCBOR :: VRFType -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VRFType -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679161375"><span id="local-6989586621679161377"><span id="local-6989586621679161379"><span id="local-6989586621679161381"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161381"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161381"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-201"></span><span id="local-6989586621679161370"><span id="local-6989586621679161372"><span id="local-6989586621679161374"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161374"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161374"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679161362"><span id="local-6989586621679161364"><span id="local-6989586621679161366"><span id="local-6989586621679161368"><span id="local-6989586621679161369"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161369"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161369"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161368"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-204"></span><span id="local-6989586621679161356"><span id="local-6989586621679161358"><span id="local-6989586621679161360"><span id="local-6989586621679161361"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161361"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161361"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161360"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">data</span><span> </span><span id="PraosProof"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-var">PraosProof</span></a></span></span><span> </span><span id="local-6989586621679161754"><span class="annot"><a href="#local-6989586621679161754"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosProof"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-var">PraosProof</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-207"></span><span>      </span><span id="praosProofRho"><span class="annot"><span class="annottext">PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofRho"><span class="hs-identifier hs-var hs-var">praosProofRho</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertifiedVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161754"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosProofY"><span class="annot"><span class="annottext">PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofY"><span class="hs-identifier hs-var hs-var">praosProofY</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertifiedVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161754"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosLeader"><span class="annot"><span class="annottext">PraosProof c -&gt; CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-identifier hs-var hs-var">praosLeader</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679161354"><span id="local-6989586621679161355"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosValidationError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-var">PraosValidationError</span></a></span></span><span> </span><span id="local-6989586621679161626"><span class="annot"><a href="#local-6989586621679161626"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>      </span><span id="PraosInvalidSlot"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSlot"><span class="hs-identifier hs-var">PraosInvalidSlot</span></a></span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosUnknownCoreId"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosUnknownCoreId"><span class="hs-identifier hs-var">PraosUnknownCoreId</span></a></span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInvalidSig"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSig"><span class="hs-identifier hs-var">PraosInvalidSig</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">VerKeyKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SigKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInvalidCert"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">VerKeyVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInsufficientStake"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInsufficientStake"><span class="hs-identifier hs-var">PraosInsufficientStake</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 PraosValidationError c -&gt; Rep (PraosValidationError c) x)
-&gt; (forall x.
    Rep (PraosValidationError c) x -&gt; PraosValidationError c)
-&gt; Generic (PraosValidationError c)
forall x. Rep (PraosValidationError c) x -&gt; PraosValidationError c
forall x. PraosValidationError c -&gt; Rep (PraosValidationError c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x.
Rep (PraosValidationError c) x -&gt; PraosValidationError c
forall c x.
PraosValidationError c -&gt; Rep (PraosValidationError c) x
$cto :: forall c x.
Rep (PraosValidationError c) x -&gt; PraosValidationError c
$cfrom :: forall c x.
PraosValidationError c -&gt; Rep (PraosValidationError c) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- We override 'showTypeOf' to make sure to show @c@</span><span>
</span><span id="line-221"></span><span id="local-6989586621679161346"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161342"><span id="local-6989586621679161344"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161346"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161346"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679161340"><span class="annot"><span class="annottext">showTypeOf :: Proxy (PraosValidationError c) -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy (PraosValidationError c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(TypeRep -&gt; String) -&gt; TypeRep -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy (PraosValidationError c) -&gt; TypeRep
forall k (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosValidationError c)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161346"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621679161329"><span id="local-6989586621679161331"><span id="local-6989586621679161333"><span id="local-6989586621679161335"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161335"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161335"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-225"></span><span id="local-6989586621679161324"><span id="local-6989586621679161326"><span id="local-6989586621679161328"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161328"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161328"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621679161322"><span id="local-6989586621679161323"></span></span><span class="hs-keyword">data</span><span> </span><span id="BlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-var">BlockInfo</span></a></span></span><span> </span><span id="local-6989586621679161631"><span class="annot"><a href="#local-6989586621679161631"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-var">BlockInfo</span></a></span></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="biSlot"><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="biRho"><span class="annot"><span class="annottext">BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var hs-var">biRho</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">CertifiedVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161631"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="biStake"><span class="annot"><span class="annottext">BlockInfo c -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biStake"><span class="hs-identifier hs-var hs-var">biStake</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BlockInfo c -&gt; Rep (BlockInfo c) x)
-&gt; (forall x. Rep (BlockInfo c) x -&gt; BlockInfo c)
-&gt; Generic (BlockInfo c)
forall x. Rep (BlockInfo c) x -&gt; BlockInfo c
forall x. BlockInfo c -&gt; Rep (BlockInfo c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (BlockInfo c) x -&gt; BlockInfo c
forall c x. BlockInfo c -&gt; Rep (BlockInfo c) x
$cto :: forall c x. Rep (BlockInfo c) x -&gt; BlockInfo c
$cfrom :: forall c x. BlockInfo c -&gt; Rep (BlockInfo c) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621679161309"><span id="local-6989586621679161311"><span id="local-6989586621679161313"><span id="local-6989586621679161315"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161315"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161315"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-235"></span><span id="local-6989586621679161304"><span id="local-6989586621679161306"><span id="local-6989586621679161308"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161308"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161308"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679161297"><span id="local-6989586621679161299"><span id="local-6989586621679161301"><span id="local-6989586621679161303"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161303"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161303"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Protocol proper
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">data</span><span> </span><span id="Praos"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-var">Praos</span></a></span></span><span> </span><span id="local-6989586621679161296"><span class="annot"><a href="#local-6989586621679161296"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Praos parameters that are node independent</span><span>
</span><span id="line-245"></span><span id="local-6989586621679161294"><span id="local-6989586621679161295"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosParams"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-var">PraosParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosParams"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-var">PraosParams</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-246"></span><span>      </span><span id="praosLeaderF"><span class="annot"><span class="annottext">PraosParams -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeaderF"><span class="hs-identifier hs-var hs-var">praosLeaderF</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosSecurityParam"><span class="annot"><span class="annottext">PraosParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSecurityParam"><span class="hs-identifier hs-var hs-var">praosSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">SecurityParam</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosSlotsPerEpoch"><span class="annot"><span class="annottext">PraosParams -&gt; Word64
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSlotsPerEpoch"><span class="hs-identifier hs-var hs-var">praosSlotsPerEpoch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosLifetimeKES"><span class="annot"><span class="annottext">PraosParams -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLifetimeKES"><span class="hs-identifier hs-var hs-var">praosLifetimeKES</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PraosParams -&gt; Rep PraosParams x)
-&gt; (forall x. Rep PraosParams x -&gt; PraosParams)
-&gt; Generic PraosParams
forall x. Rep PraosParams x -&gt; PraosParams
forall x. PraosParams -&gt; Rep PraosParams x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PraosParams x -&gt; PraosParams
$cfrom :: forall x. PraosParams -&gt; Rep PraosParams x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161281"><span id="local-6989586621679161283"><span id="local-6989586621679161285"><span class="annot"><span class="annottext">Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
Proxy PraosParams -&gt; String
(Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy PraosParams -&gt; String)
-&gt; NoThunks PraosParams
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy PraosParams -&gt; String
$cshowTypeOf :: Proxy PraosParams -&gt; String
wNoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679161281"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ConsensusConfig"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ConsensusConfig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span id="local-6989586621679161647"><span class="annot"><a href="#local-6989586621679161647"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosConfig"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-var">PraosConfig</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="praosParams"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosParams
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var hs-var">praosParams</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosInitialEta"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialEta"><span class="hs-identifier hs-var hs-var">praosInitialEta</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosInitialStake"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialStake"><span class="hs-identifier hs-var hs-var">praosInitialStake</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosSignKeyVRF"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SignKeyVRF (PraosVRF c)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignKeyVRF"><span class="hs-identifier hs-var hs-var">praosSignKeyVRF</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SignKeyVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161647"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosVerKeys"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosVerKeys"><span class="hs-identifier hs-var hs-var">praosVerKeys</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">VerKeyKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161647"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">VerKeyVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161647"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x)
-&gt; (forall x.
    Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c))
-&gt; Generic (ConsensusConfig (Praos c))
forall x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
forall x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
forall c x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
$cto :: forall c x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
$cfrom :: forall c x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span id="local-6989586621679161270"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161262"><span id="local-6989586621679161264"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161270"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ChainSelection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161270"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-comment">-- Use defaults</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-keyword">newtype</span><span> </span><span id="PraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span></span><span> </span><span id="local-6989586621679161640"><span class="annot"><a href="#local-6989586621679161640"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-266"></span><span>      </span><span id="praosHistory"><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161640"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679161255"><span id="local-6989586621679161257"><span class="annot"><span class="annottext">PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
(PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool)
-&gt; (PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool)
-&gt; Eq (PraosChainDepState c)
forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
$c/= :: forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
== :: PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
$c== :: forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161249"><span id="local-6989586621679161251"><span id="local-6989586621679161253"><span class="annot"><span class="annottext">Int -&gt; PraosChainDepState c -&gt; ShowS
[PraosChainDepState c] -&gt; ShowS
PraosChainDepState c -&gt; String
(Int -&gt; PraosChainDepState c -&gt; ShowS)
-&gt; (PraosChainDepState c -&gt; String)
-&gt; ([PraosChainDepState c] -&gt; ShowS)
-&gt; Show (PraosChainDepState c)
forall c. PraosCrypto c =&gt; Int -&gt; PraosChainDepState c -&gt; ShowS
forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; ShowS
forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PraosChainDepState c] -&gt; ShowS
$cshowList :: forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; ShowS
show :: PraosChainDepState c -&gt; String
$cshow :: forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; String
showsPrec :: Int -&gt; PraosChainDepState c -&gt; ShowS
$cshowsPrec :: forall c. PraosCrypto c =&gt; Int -&gt; PraosChainDepState c -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161243"><span id="local-6989586621679161245"><span id="local-6989586621679161247"><span class="annot"><span class="annottext">Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
Proxy (PraosChainDepState c) -&gt; String
(Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (PraosChainDepState c) -&gt; String)
-&gt; NoThunks (PraosChainDepState c)
forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
forall c. PraosCrypto c =&gt; Proxy (PraosChainDepState c) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (PraosChainDepState c) -&gt; String
$cshowTypeOf :: forall c. PraosCrypto c =&gt; Proxy (PraosChainDepState c) -&gt; String
wNoThunks :: Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679161243"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161235"><span id="local-6989586621679161237"><span id="local-6989586621679161239"><span id="local-6989586621679161241"><span class="annot"><span class="annottext">Decoder s (PraosChainDepState c)
Decoder s [PraosChainDepState c]
[PraosChainDepState c] -&gt; Encoding
PraosChainDepState c -&gt; Encoding
(PraosChainDepState c -&gt; Encoding)
-&gt; (forall s. Decoder s (PraosChainDepState c))
-&gt; ([PraosChainDepState c] -&gt; Encoding)
-&gt; (forall s. Decoder s [PraosChainDepState c])
-&gt; Serialise (PraosChainDepState c)
forall s. Decoder s [PraosChainDepState c]
forall s. Decoder s (PraosChainDepState c)
forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; Encoding
forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; Encoding
forall c s. PraosCrypto c =&gt; Decoder s [PraosChainDepState c]
forall c s. PraosCrypto c =&gt; Decoder s (PraosChainDepState c)
forall a.
(a -&gt; Encoding)
-&gt; (forall s. Decoder s a)
-&gt; ([a] -&gt; Encoding)
-&gt; (forall s. Decoder s [a])
-&gt; Serialise a
decodeList :: Decoder s [PraosChainDepState c]
$cdecodeList :: forall c s. PraosCrypto c =&gt; Decoder s [PraosChainDepState c]
encodeList :: [PraosChainDepState c] -&gt; Encoding
$cencodeList :: forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; Encoding
decode :: Decoder s (PraosChainDepState c)
$cdecode :: forall c s. PraosCrypto c =&gt; Decoder s (PraosChainDepState c)
encode :: PraosChainDepState c -&gt; Encoding
$cencode :: forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; Encoding
</span><a href="#local-6989586621679161235"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Serialise</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Ticking the Praos chain dep state has no effect</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- For the real Praos implementation, ticking is crucial, as it determines the</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- point where the &quot;nonce under construction&quot; is swapped out for the &quot;active&quot;</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- nonce. However, for the mock implementation, we keep the full history, and</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- choose the right nonce from that; this means that ticking has no effect.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- We do however need access to the ticked stake distribution.</span><span>
</span><span id="line-279"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Ticked"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">Ticked</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span> </span><span id="local-6989586621679161634"><span class="annot"><a href="#local-6989586621679161634"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TickedPraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-var">TickedPraosChainDepState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-280"></span><span>      </span><span id="tickedPraosLedgerView"><span class="annot"><span class="annottext">Ticked (PraosChainDepState c) -&gt; Ticked (LedgerView (Praos c))
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#tickedPraosLedgerView"><span class="hs-identifier hs-var hs-var">tickedPraosLedgerView</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Ticked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">LedgerView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161634"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="untickedPraosChainDepState"><span class="annot"><span class="annottext">Ticked (PraosChainDepState c) -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#untickedPraosChainDepState"><span class="hs-identifier hs-var hs-var">untickedPraosChainDepState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161634"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621679161231"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161219"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679161212"><span class="annot"><span class="annottext">protocolSecurityParam :: ConsensusConfig (Praos c) -&gt; SecurityParam
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">protocolSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSecurityParam"><span class="hs-identifier hs-var hs-var">praosSecurityParam</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosParams -&gt; SecurityParam)
-&gt; (ConsensusConfig (Praos c) -&gt; PraosParams)
-&gt; ConsensusConfig (Praos c)
-&gt; SecurityParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosParams
forall c. ConsensusConfig (Praos c) -&gt; PraosParams
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var hs-var">praosParams</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="LedgerView"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">LedgerView</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="IsLeader"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">IsLeader</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span>           </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidationErr"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ValidationErr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidateView"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ValidateView</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span>    </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ChainDepState"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ChainDepState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="CanBeLeader"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">CanBeLeader</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161231"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679161209"><span class="annot"><span class="annottext">checkIsLeader :: ConsensusConfig (Praos c)
-&gt; CanBeLeader (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; Maybe (IsLeader (Praos c))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIsLeader</span></a></span></span><span> </span><span id="local-6989586621679161207"><span class="annot"><span class="annottext">cfg :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161207"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161202"><span id="local-6989586621679161203"><span id="local-6989586621679161204"><span id="local-6989586621679161205"><span id="local-6989586621679161206"><span class="annot"><a href="#local-6989586621679161202"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161201"><span class="annot"><span class="annottext">CanBeLeader (Praos c)
</span><a href="#local-6989586621679161201"><span class="hs-identifier hs-var">nid</span></a></span></span><span> </span><span id="local-6989586621679161200"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161200"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span id="local-6989586621679161199"><span class="annot"><a href="#local-6989586621679161199"><span class="hs-identifier hs-var">_u</span></a></span></span><span>  </span><span id="local-6989586621679161198"><span class="annot"><a href="#local-6989586621679161198"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">getOutputVRFNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161195"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161193"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PraosProof c -&gt; Maybe (PraosProof c)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PraosProof :: forall c.
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CoreNodeId
-&gt; PraosProof c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-297"></span><span>               </span><span class="annot"><span class="annottext">praosProofRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofRho"><span class="hs-identifier hs-var">praosProofRho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161192"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-298"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosProofY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofY"><span class="hs-identifier hs-var">praosProofY</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161195"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-299"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosLeader :: CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-identifier hs-var">praosLeader</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanBeLeader (Praos c)
CoreNodeId
</span><a href="#local-6989586621679161201"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-300"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (IsLeader (Praos c))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679161191"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161191"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161190"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161190"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161193"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161193"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var">rhoYT</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161207"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679161198"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161200"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">CanBeLeader (Praos c)
CoreNodeId
</span><a href="#local-6989586621679161201"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>      </span><span id="local-6989586621679161192"><span class="annot"><span class="annottext">rho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161192"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; SignKeyVRF (PraosVRF c)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; a -&gt; SignKeyVRF v -&gt; CertifiedVRF v a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">evalCertified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161191"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">SignKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161203"><span class="hs-identifier hs-var">praosSignKeyVRF</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span id="local-6989586621679161195"><span class="annot"><span class="annottext">y :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161195"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; SignKeyVRF (PraosVRF c)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; a -&gt; SignKeyVRF v -&gt; CertifiedVRF v a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">evalCertified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161190"><span class="hs-identifier hs-var">y'</span></a></span><span>   </span><span class="annot"><span class="annottext">SignKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161203"><span class="hs-identifier hs-var">praosSignKeyVRF</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679161187"><span class="annot"><span class="annottext">tickChainDepState :: ConsensusConfig (Praos c)
-&gt; Ticked (LedgerView (Praos c))
-&gt; SlotNo
-&gt; ChainDepState (Praos c)
-&gt; Ticked (ChainDepState (Praos c))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">tickChainDepState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679161185"><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
</span><a href="#local-6989586621679161185"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
-&gt; PraosChainDepState c -&gt; Ticked (PraosChainDepState c)
forall c.
Ticked (LedgerView (Praos c))
-&gt; PraosChainDepState c -&gt; Ticked (PraosChainDepState c)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-var">TickedPraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
</span><a href="#local-6989586621679161185"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679161184"><span class="annot"><span class="annottext">updateChainDepState :: ConsensusConfig (Praos c)
-&gt; ValidateView (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; Except (ValidationErr (Praos c)) (ChainDepState (Praos c))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateChainDepState</span></a></span></span><span> </span><span id="local-6989586621679161182"><span class="annot"><span class="annottext">cfg :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161182"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161177"><span id="local-6989586621679161178"><span id="local-6989586621679161179"><span id="local-6989586621679161180"><span id="local-6989586621679161181"><span class="annot"><a href="#local-6989586621679161177"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-311"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161175"><span id="local-6989586621679161176"><span class="annot"><a href="#local-6989586621679161175"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161174"><span class="annot"><a href="#local-6989586621679161174"><span class="hs-identifier hs-var">toSign</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                      </span><span id="local-6989586621679161173"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span></span><span>
</span><span id="line-313"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#TickedStakeDist"><span class="hs-identifier hs-type">TickedStakeDist</span></a></span><span> </span><span id="local-6989586621679161171"><span class="annot"><a href="#local-6989586621679161171"><span class="hs-identifier hs-var">sd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679161170"><span class="annot"><a href="#local-6989586621679161170"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161167"><span id="local-6989586621679161168"><span id="local-6989586621679161169"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
CoreNodeId
praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: CoreNodeId
praosY :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: forall c. PraosExtraFields c -&gt; CoreNodeId
</span><a href="#local-6989586621679161167"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679161175"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621679161166"><span class="annot"><span class="annottext">nid :: CoreNodeId
</span><a href="#local-6989586621679161166"><span class="hs-identifier hs-var hs-var">nid</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161169"><span class="hs-identifier hs-var">praosCreator</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-comment">-- check that the new block advances time</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679161170"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679161165"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161165"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161165"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; PraosValidationError c
forall c. SlotNo -&gt; SlotNo -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSlot"><span class="hs-identifier hs-var">PraosInvalidSlot</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161165"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT (PraosValidationError c) Identity ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- check that block creator is a known core node</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679161164"><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679161164"><span class="hs-identifier hs-var">vkKES</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161163"><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161163"><span class="hs-identifier hs-var">vkVRF</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
-&gt; Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
-&gt; Maybe (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161166"><span class="hs-identifier hs-var">nid</span></a></span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679161177"><span class="hs-identifier hs-var">praosVerKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">Maybe (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT
      (PraosValidationError c)
      Identity
      (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c)))
-&gt; PraosValidationError c
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId -&gt; PraosValidationError c
forall c. CoreNodeId -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosUnknownCoreId"><span class="hs-identifier hs-var">PraosUnknownCoreId</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161166"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679161161"><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679161161"><span class="hs-identifier hs-var">vks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679161161"><span class="hs-identifier hs-var">vks</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- verify block signature</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; VerKeyKES (PraosKES c)
-&gt; Period
-&gt; signed
-&gt; SignedKES (PraosKES c) signed
-&gt; Either String ()
forall v a.
(KESAlgorithm v, Signable v a) =&gt;
ContextKES v
-&gt; VerKeyKES v -&gt; Period -&gt; a -&gt; SignedKES v a -&gt; Either String ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">verifySignedKES</span></a></span><span>
</span><span id="line-330"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>           </span><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679161164"><span class="hs-identifier hs-var">vkKES</span></a></span><span>
</span><span id="line-332"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Period
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Period) -&gt; Word64 -&gt; Period
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>           </span><span class="annot"><span class="annottext">signed
</span><a href="#local-6989586621679161174"><span class="hs-identifier hs-var">toSign</span></a></span><span>
</span><span id="line-334"></span><span>           </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed
</span><a href="#local-6989586621679161176"><span class="hs-identifier hs-var">praosSignature</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-335"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT (PraosValidationError c) Identity ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679161159"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679161159"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; VerKeyKES (PraosKES c)
-&gt; Natural
-&gt; SigKES (PraosKES c)
-&gt; PraosValidationError c
forall c.
String
-&gt; VerKeyKES (PraosKES c)
-&gt; Natural
-&gt; SigKES (PraosKES c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSig"><span class="hs-identifier hs-var">PraosInvalidSig</span></a></span><span>
</span><span id="line-337"></span><span>                                  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679161159"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-338"></span><span>                                  </span><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679161164"><span class="hs-identifier hs-var">vkKES</span></a></span><span>
</span><span id="line-339"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Natural) -&gt; Word64 -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed -&gt; SigKES (PraosKES c)
forall v a. SignedKES v a -&gt; SigKES v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">getSig</span></a></span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed
</span><a href="#local-6989586621679161176"><span class="hs-identifier hs-var">praosSignature</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161157"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161157"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161156"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161156"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161155"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161155"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var">rhoYT</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161182"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679161170"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161166"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- verify rho proof</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; Bool
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; VerKeyVRF v -&gt; a -&gt; CertifiedVRF v a -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">verifyCertified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161163"><span class="hs-identifier hs-var">vkVRF</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161157"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161168"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
forall c.
VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161163"><span class="hs-identifier hs-var">vkVRF</span></a></span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161157"><span class="hs-identifier hs-var">rho'</span></a></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">getOutputVRFNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161168"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; CertVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedProof</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161168"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-comment">-- verify y proof</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; Bool
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; VerKeyVRF v -&gt; a -&gt; CertifiedVRF v a -&gt; Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">verifyCertified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161163"><span class="hs-identifier hs-var">vkVRF</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161156"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161167"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
forall c.
VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679161163"><span class="hs-identifier hs-var">vkVRF</span></a></span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161156"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-357"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">getOutputVRFNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161167"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; CertVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedProof</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161167"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">-- verify stake</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">getOutputVRFNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161167"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161155"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Natural -&gt; PraosValidationError c
forall c. Double -&gt; Natural -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInsufficientStake"><span class="hs-identifier hs-var">PraosInsufficientStake</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161155"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; PraosValidationError c)
-&gt; Natural -&gt; PraosValidationError c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-363"></span><span>                       </span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">getOutputVRFNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var">certifiedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161167"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679161152"><span class="annot"><span class="annottext">bi :: BlockInfo c
</span><a href="#local-6989586621679161152"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; StakeDist
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span>
</span><span id="line-366"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">biSlot :: SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var">biSlot</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161173"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-367"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var">biRho</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161168"><span class="hs-identifier hs-var">praosRho</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biStake :: StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biStake"><span class="hs-identifier hs-var">biStake</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId Rational -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-var">StakeDist</span></a></span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId Rational
</span><a href="#local-6989586621679161171"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-369"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">PraosChainDepState c
-&gt; ExceptT (PraosValidationError c) Identity (PraosChainDepState c)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PraosChainDepState c
 -&gt; ExceptT
      (PraosValidationError c) Identity (PraosChainDepState c))
-&gt; PraosChainDepState c
-&gt; ExceptT (PraosValidationError c) Identity (PraosChainDepState c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c] -&gt; PraosChainDepState c
forall c. [BlockInfo c] -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; PraosChainDepState c)
-&gt; [BlockInfo c] -&gt; PraosChainDepState c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161152"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679161170"><span class="hs-identifier hs-var">cds</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679161150"><span class="annot"><span class="annottext">reupdateChainDepState :: ConsensusConfig (Praos c)
-&gt; ValidateView (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; ChainDepState (Praos c)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">reupdateChainDepState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-374"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161147"><span id="local-6989586621679161148"><span class="annot"><a href="#local-6989586621679161147"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>                        </span><span id="local-6989586621679161146"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161146"><span class="hs-identifier hs-var">slot</span></a></span></span><span>
</span><span id="line-376"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#TickedStakeDist"><span class="hs-identifier hs-type">TickedStakeDist</span></a></span><span> </span><span id="local-6989586621679161145"><span class="annot"><a href="#local-6989586621679161145"><span class="hs-identifier hs-var">sd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679161144"><span class="annot"><a href="#local-6989586621679161144"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161141"><span id="local-6989586621679161142"><span id="local-6989586621679161143"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
CoreNodeId
praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: CoreNodeId
praosY :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: forall c. PraosExtraFields c -&gt; CoreNodeId
</span><a href="#local-6989586621679161141"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679161147"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679161140"><span class="annot"><span class="annottext">bi :: BlockInfo c
</span><a href="#local-6989586621679161140"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; StakeDist
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span>
</span><span id="line-379"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">biSlot :: SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var">biSlot</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161146"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-380"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var">biRho</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161142"><span class="hs-identifier hs-var">praosRho</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biStake :: StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biStake"><span class="hs-identifier hs-var">biStake</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId Rational -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-var">StakeDist</span></a></span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId Rational
</span><a href="#local-6989586621679161145"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c] -&gt; PraosChainDepState c
forall c. [BlockInfo c] -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; PraosChainDepState c)
-&gt; [BlockInfo c] -&gt; PraosChainDepState c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161140"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679161144"><span class="hs-identifier hs-var">cds</span></a></span></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-comment">-- (Standard) Praos uses the standard chain selection rule, so no need to</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-comment">-- override (though see note regarding clock skew).</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621679161139"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161133"><span id="local-6989586621679161135"><span id="local-6989586621679161137"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161139"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161139"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-comment">-- use generic instance</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span id="local-6989586621679161600"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-type">slotEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161600"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span>
</span><span id="line-392"></span><span id="slotEpoch"><span class="annot"><span class="annottext">slotEpoch :: ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var hs-var">slotEpoch</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161127"><span id="local-6989586621679161128"><span id="local-6989586621679161129"><span id="local-6989586621679161130"><span id="local-6989586621679161131"><span class="annot"><a href="#local-6989586621679161127"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161126"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161126"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">Identity EpochNo -&gt; EpochNo
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity EpochNo -&gt; EpochNo) -&gt; Identity EpochNo -&gt; EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity -&gt; SlotNo -&gt; Identity EpochNo
forall (m :: * -&gt; *).
HasCallStack =&gt;
EpochInfo m -&gt; SlotNo -&gt; m EpochNo
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">epochInfoEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity
</span><a href="#local-6989586621679161124"><span class="hs-identifier hs-var">epochInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161126"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679161124"><span class="annot"><span class="annottext">epochInfo :: EpochInfo Identity
</span><a href="#local-6989586621679161124"><span class="hs-identifier hs-var hs-var">epochInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSize -&gt; EpochInfo Identity
forall (m :: * -&gt; *). Monad m =&gt; EpochSize -&gt; EpochInfo m
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">fixedSizeEpochInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EpochSize
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">EpochSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679161121"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161118"><span id="local-6989586621679161119"><span id="local-6989586621679161120"><span id="local-6989586621679161121"><span class="annot"><span class="annottext">Double
Natural
Word64
SecurityParam
praosLifetimeKES :: Natural
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: Word64
praosLifetimeKES :: PraosParams -&gt; Natural
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679161118"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679161131"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span id="local-6989586621679161580"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#blockInfoEpoch"><span class="hs-identifier hs-type">blockInfoEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161580"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161580"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span>
</span><span id="line-399"></span><span id="blockInfoEpoch"><span class="annot"><span class="annottext">blockInfoEpoch :: ConsensusConfig (Praos c) -&gt; BlockInfo c -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#blockInfoEpoch"><span class="hs-identifier hs-var hs-var">blockInfoEpoch</span></a></span></span><span> </span><span id="local-6989586621679161116"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161116"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var">slotEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161116"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; EpochNo)
-&gt; (BlockInfo c -&gt; SlotNo) -&gt; BlockInfo c -&gt; EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621679161593"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-type">epochFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161593"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span></span><span>
</span><span id="line-402"></span><span id="epochFirst"><span class="annot"><span class="annottext">epochFirst :: ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-var hs-var">epochFirst</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161110"><span id="local-6989586621679161111"><span id="local-6989586621679161112"><span id="local-6989586621679161113"><span id="local-6989586621679161114"><span class="annot"><a href="#local-6989586621679161110"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161109"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161109"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">Identity SlotNo -&gt; SlotNo
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity SlotNo -&gt; SlotNo) -&gt; Identity SlotNo -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity -&gt; EpochNo -&gt; Identity SlotNo
forall (m :: * -&gt; *).
HasCallStack =&gt;
EpochInfo m -&gt; EpochNo -&gt; m SlotNo
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">epochInfoFirst</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity
</span><a href="#local-6989586621679161107"><span class="hs-identifier hs-var">epochInfo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161109"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679161107"><span class="annot"><span class="annottext">epochInfo :: EpochInfo Identity
</span><a href="#local-6989586621679161107"><span class="hs-identifier hs-var hs-var">epochInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSize -&gt; EpochInfo Identity
forall (m :: * -&gt; *). Monad m =&gt; EpochSize -&gt; EpochInfo m
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">fixedSizeEpochInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EpochSize
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">EpochSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679161106"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161103"><span id="local-6989586621679161104"><span id="local-6989586621679161105"><span id="local-6989586621679161106"><span class="annot"><span class="annottext">Double
Natural
Word64
SecurityParam
praosLifetimeKES :: Natural
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: Word64
praosLifetimeKES :: PraosParams -&gt; Natural
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679161103"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679161114"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span id="local-6989586621679161590"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-type">infosSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161590"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161590"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-409"></span><span id="infosSlice"><span class="annot"><span class="annottext">infosSlice :: SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-var hs-var">infosSlice</span></a></span></span><span> </span><span id="local-6989586621679161101"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161101"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679161100"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161100"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679161099"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161099"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockInfo c -&gt; Bool) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679161097"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161101"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>                      </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; [BlockInfo c]) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(BlockInfo c -&gt; Bool) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679161095"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161100"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161099"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-type">infosEta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679161594"><span class="annot"><a href="#local-6989586621679161594"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161594"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161594"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161594"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-415"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span>
</span><span id="line-416"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-417"></span><span id="infosEta"><span class="annot"><span class="annottext">infosEta :: ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var hs-var">infosEta</span></a></span></span><span> </span><span id="local-6989586621679161092"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161092"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Natural
forall c. ConsensusConfig (Praos c) -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialEta"><span class="hs-identifier hs-var hs-var">praosInitialEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161092"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span id="local-6989586621679161091"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161091"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679161090"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161090"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679161089"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161089"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679161088"><span class="annot"><span class="annottext">e' :: EpochNo
</span><a href="#local-6989586621679161088"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161089"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; EpochNo
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">1</span></span><span>
</span><span id="line-420"></span><span>        </span><span id="local-6989586621679161087"><span class="annot"><span class="annottext">eta' :: Natural
</span><a href="#local-6989586621679161087"><span class="hs-identifier hs-var hs-var">eta'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161091"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161090"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161088"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679161086"><span class="annot"><span class="annottext">from :: SlotNo
</span><a href="#local-6989586621679161086"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
forall c. ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-var">epochFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161091"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161088"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621679161085"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679161085"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679161082"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">3</span></span><span>
</span><span id="line-423"></span><span>        </span><span id="local-6989586621679161081"><span class="annot"><span class="annottext">to :: SlotNo
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var hs-var">to</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; Word64 -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161086"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679161085"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621679161079"><span class="annot"><span class="annottext">rhos :: [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
</span><a href="#local-6989586621679161079"><span class="hs-identifier hs-var hs-var">rhos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
-&gt; [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall c.
BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var hs-var">biRho</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161077"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679161077"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161077"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall c. SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-var">infosSlice</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161086"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161090"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; Natural
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">bytesToNatural</span></a></span><span>
</span><span id="line-426"></span><span>          </span><span class="annot"><span class="annottext">(ByteString -&gt; Natural)
-&gt; (Hash
      (PraosHash c)
      (Natural, EpochNo,
       [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
    -&gt; ByteString)
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hash
  (PraosHash c)
  (Natural, EpochNo,
   [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; ByteString
forall h a. Hash h a -&gt; ByteString
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">hashToBytes</span></a></span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><span class="annottext">(Hash
   (PraosHash c)
   (Natural, EpochNo,
    [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
 -&gt; Natural)
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Natural, EpochNo,
  [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
 -&gt; Encoding)
-&gt; (Natural, EpochNo,
    [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
forall h a. HashAlgorithm h =&gt; (a -&gt; Encoding) -&gt; a -&gt; Hash h a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">hashWithSerialiser</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161594"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, EpochNo,
 [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679161087"><span class="hs-identifier hs-var">eta'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161089"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
</span><a href="#local-6989586621679161079"><span class="hs-identifier hs-var">rhos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161073"><span id="local-6989586621679161074"><span id="local-6989586621679161075"><span id="local-6989586621679161082"><span class="annot"><span class="annottext">Double
Natural
Word64
SecurityParam
praosLifetimeKES :: Natural
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: Word64
praosLifetimeKES :: PraosParams -&gt; Natural
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679161073"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosParams
forall c. ConsensusConfig (Praos c) -&gt; PraosParams
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var hs-var">praosParams</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161091"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="local-6989586621679161575"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosStake"><span class="hs-identifier hs-type">infosStake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161575"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161575"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span></span><span>
</span><span id="line-432"></span><span id="infosStake"><span class="annot"><span class="annottext">infosStake :: ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosStake"><span class="hs-identifier hs-var hs-var">infosStake</span></a></span></span><span> </span><span id="local-6989586621679161071"><span class="annot"><span class="annottext">s :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161071"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161066"><span id="local-6989586621679161067"><span id="local-6989586621679161068"><span id="local-6989586621679161069"><span id="local-6989586621679161070"><span class="annot"><a href="#local-6989586621679161066"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161065"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161065"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679161064"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161064"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161063"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StakeDist
</span><a href="#local-6989586621679161068"><span class="hs-identifier hs-var">praosInitialStake</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161060"><span id="local-6989586621679161061"><span id="local-6989586621679161062"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
SlotNo
StakeDist
biStake :: StakeDist
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
biStake :: forall c. BlockInfo c -&gt; StakeDist
biRho :: forall c.
BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: forall c. BlockInfo c -&gt; SlotNo
</span><a href="#local-6989586621679161060"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StakeDist
</span><a href="#local-6989586621679161060"><span class="hs-identifier hs-var">biStake</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-436"></span><span>    </span><span id="local-6989586621679161059"><span class="annot"><span class="annottext">e' :: EpochNo
</span><a href="#local-6989586621679161059"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161064"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpochNo -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-var hs-var">unEpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161064"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">0</span></span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679161063"><span class="annot"><span class="annottext">ys :: [BlockInfo c]
</span><a href="#local-6989586621679161063"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockInfo c -&gt; Bool) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679161056"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161056"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; BlockInfo c -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; BlockInfo c -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#blockInfoEpoch"><span class="hs-identifier hs-var">blockInfoEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161071"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679161056"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161059"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161065"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span id="local-6989586621679161570"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161570"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-440"></span><span id="phi"><span class="annot"><span class="annottext">phi :: ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161050"><span id="local-6989586621679161051"><span id="local-6989586621679161052"><span id="local-6989586621679161053"><span id="local-6989586621679161054"><span class="annot"><a href="#local-6989586621679161050"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679161049"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679161049"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161048"><span class="hs-identifier hs-var">praosLeaderF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679161049"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679161044"><span id="local-6989586621679161045"><span id="local-6989586621679161046"><span id="local-6989586621679161048"><span class="annot"><span class="annottext">Double
Natural
Word64
SecurityParam
praosLifetimeKES :: Natural
praosSlotsPerEpoch :: Word64
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosLifetimeKES :: PraosParams -&gt; Natural
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679161044"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679161054"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-type">leaderThreshold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679161568"><span class="annot"><a href="#local-6989586621679161568"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161568"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-445"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161568"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161568"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-448"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-449"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-450"></span><span id="leaderThreshold"><span class="annot"><span class="annottext">leaderThreshold :: ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-var hs-var">leaderThreshold</span></a></span></span><span> </span><span id="local-6989586621679161042"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679161041"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679161040"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161040"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679161039"><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161039"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679161038"><span class="annot"><span class="annottext">a :: Rational
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; CoreNodeId -&gt; StakeDist -&gt; Rational
</span><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#stakeWithDefault"><span class="hs-identifier hs-var">stakeWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161039"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(StakeDist -&gt; Rational) -&gt; StakeDist -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; StakeDist
forall c.
ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosStake"><span class="hs-identifier hs-var">infosStake</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var">slotEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161040"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Period -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosHash c) -&gt; Period
forall h (proxy :: * -&gt; *). HashAlgorithm h =&gt; proxy h -&gt; Period
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">sizeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosHash c)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161568"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Period
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
forall c. ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span id="local-6989586621679161641"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-type">rhoYT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161641"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161641"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161641"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-462"></span><span>         </span><span class="hs-special">)</span></span><span>
</span><span id="line-463"></span><span id="rhoYT"><span class="annot"><span class="annottext">rhoYT :: ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var hs-var">rhoYT</span></a></span></span><span> </span><span id="local-6989586621679161035"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161035"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679161034"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679161033"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679161032"><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var">nid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679161031"><span class="annot"><span class="annottext">e :: EpochNo
</span><a href="#local-6989586621679161031"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var">slotEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161035"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679161030"><span class="annot"><span class="annottext">eta :: Natural
</span><a href="#local-6989586621679161030"><span class="hs-identifier hs-var hs-var">eta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161035"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679161031"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621679161029"><span class="annot"><span class="annottext">rho :: (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161029"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679161030"><span class="hs-identifier hs-var">eta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VRFType
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#NONCE"><span class="hs-identifier hs-var">NONCE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>        </span><span id="local-6989586621679161028"><span class="annot"><span class="annottext">y :: (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161028"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679161030"><span class="hs-identifier hs-var">eta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VRFType
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>        </span><span id="local-6989586621679161027"><span class="annot"><span class="annottext">t :: Double
</span><a href="#local-6989586621679161027"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-var">leaderThreshold</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679161035"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161029"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679161028"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679161027"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Crypto models
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">KESAlgorithm</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">VRFAlgorithm</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SigKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Cardano.Crypto.VRF.Class.Signable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">ContextKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">ContextVRF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PraosCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-var">PraosCrypto</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161565"><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span id="local-6989586621679161565"><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span id="local-6989586621679161565"><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span id="local-6989586621679161565"><span class="annot"><a href="#local-6989586621679161565"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-keyword">data</span><span> </span><span id="PraosStandardCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-var">PraosStandardCrypto</span></a></span></span><span>
</span><span id="line-490"></span><span class="hs-keyword">data</span><span> </span><span id="PraosMockCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-var">PraosMockCrypto</span></a></span></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SimpleKES</span></a></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Ed448DSIGN</span></a></span><span> </span><span class="annot"><span class="hs-number">1000</span></span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SimpleVRF</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SHA256</span></a></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">MockKES</span></a></span><span> </span><span class="annot"><span class="hs-number">1000</span></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">MockVRF</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">MD5</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Condense
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621679161004"><span id="local-6989586621679161005"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161005"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161005"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161004"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>   </span><span id="local-6989586621679161001"><span class="annot"><span class="annottext">condense :: PraosFields c toSign -&gt; String
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679160998"><span id="local-6989586621679160999"><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign
PraosExtraFields c
praosExtraFields :: PraosExtraFields c
praosSignature :: SignedKES (PraosKES c) toSign
praosExtraFields :: forall c toSign. PraosFields c toSign -&gt; PraosExtraFields c
praosSignature :: forall c toSign.
PraosFields c toSign -&gt; SignedKES (PraosKES c) toSign
</span><a href="#local-6989586621679160998"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign
</span><a href="#local-6989586621679160999"><span class="hs-identifier hs-var">praosSignature</span></a></span></span></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Serialisation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span id="local-6989586621679160997"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160991"><span id="local-6989586621679160993"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160997"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160997"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679160990"><span class="annot"><span class="annottext">encode :: BlockInfo c -&gt; Encoding
</span><a href="#local-6989586621679160990"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679160987"><span id="local-6989586621679160988"><span id="local-6989586621679160989"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
SlotNo
StakeDist
biStake :: StakeDist
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
biStake :: forall c. BlockInfo c -&gt; StakeDist
biRho :: forall c.
BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: forall c. BlockInfo c -&gt; SlotNo
</span><a href="#local-6989586621679160987"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Period -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">3</span></span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679160989"><span class="hs-identifier hs-var">biSlot</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679160988"><span class="hs-identifier hs-var">biRho</span></a></span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StakeDist -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">StakeDist
</span><a href="#local-6989586621679160987"><span class="hs-identifier hs-var">biStake</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621679160986"><span class="annot"><span class="annottext">decode :: Decoder s (BlockInfo c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">decode</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Decoder s ()
forall s. Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">decodeListLenOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621679160984"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679160984"><span class="hs-identifier hs-var">biSlot</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decode</span></span><span>
</span><span id="line-523"></span><span>    </span><span id="local-6989586621679160983"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679160983"><span class="hs-identifier hs-var">biRho</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType))
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621679160981"><span class="annot"><span class="annottext">StakeDist
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">biStake</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s StakeDist
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decode</span></span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">BlockInfo c -&gt; Decoder s (BlockInfo c)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; StakeDist
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
SlotNo
StakeDist
biStake :: StakeDist
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
biStake :: StakeDist
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
</span><a href="#local-6989586621679160981"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">SignableRepresentation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>  </span><span id="local-6989586621679160978"><span class="annot"><span class="annottext">getSignableRepresentation :: (Natural, SlotNo, VRFType) -&gt; ByteString
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSignableRepresentation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; ByteString
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">serializeEncoding'</span></a></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; ByteString)
-&gt; ((Natural, SlotNo, VRFType) -&gt; Encoding)
-&gt; (Natural, SlotNo, VRFType)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span>
</span><span id="line-529"></span></pre></body></html>