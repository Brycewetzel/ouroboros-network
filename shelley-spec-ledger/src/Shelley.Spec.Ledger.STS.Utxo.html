<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Shelley.Spec.Ledger.STS.Utxo</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier">UTXO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier">UtxoEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier">UtxoPredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">PredicateFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html"><span class="hs-identifier">Cardano.Ledger.Crypto</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CryptoClass</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html"><span class="hs-identifier">Cardano.Ledger.Era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier">Crypto</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.html"><span class="hs-identifier">Cardano.Ledger.Shelley</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier">ShelleyBased</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier">ShelleyEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Torsor.html"><span class="hs-identifier">Cardano.Ledger.Torsor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Torsor.html#Torsor"><span class="hs-identifier">Torsor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator">(&lt;-&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Val</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Control.SetAlgebra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">dom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">eval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator">(&#8746;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator">(&#8838;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator">(&#8938;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Control.State.Transition</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Assertion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">AssertionViolation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Embed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">IRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">InitialRule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">TransitionRule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">judgmentContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">liftSTS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">trans</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">wrapFailed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator">(?!)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier">StrictSeq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Records</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasField</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html"><span class="hs-identifier">Shelley.Spec.Ledger.Address</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#Addr"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#AddrBootstrap"><span class="hs-identifier">AddrBootstrap</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#bootstrapAddressAttrsSize"><span class="hs-identifier">bootstrapAddressAttrsSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#getNetwork"><span class="hs-identifier">getNetwork</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#getRwdNetwork"><span class="hs-identifier">getRwdNetwork</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html"><span class="hs-identifier">Shelley.Spec.Ledger.BaseTypes</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#Network"><span class="hs-identifier">Network</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#ShelleyBase"><span class="hs-identifier">ShelleyBase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#StrictMaybe"><span class="hs-identifier">StrictMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">invalidKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#networkId"><span class="hs-identifier">networkId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html"><span class="hs-identifier">Shelley.Spec.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html"><span class="hs-identifier">Shelley.Spec.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#GenDelegs"><span class="hs-identifier">GenDelegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#KeyHash"><span class="hs-identifier">KeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#KeyRole"><span class="hs-identifier">KeyRole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html"><span class="hs-identifier">Shelley.Spec.Ledger.LedgerState</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#consumed"><span class="hs-identifier">consumed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#emptyPPUPState"><span class="hs-identifier">emptyPPUPState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#keyRefunds"><span class="hs-identifier">keyRefunds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#minfee"><span class="hs-identifier">minfee</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#produced"><span class="hs-identifier">produced</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#txsize"><span class="hs-identifier">txsize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html"><span class="hs-identifier">Shelley.Spec.Ledger.PParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#PParams"><span class="hs-identifier">PParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#PParams%27"><span class="hs-identifier">PParams'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#Update"><span class="hs-identifier">Update</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html"><span class="hs-identifier">Shelley.Spec.Ledger.STS.Ppup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUP"><span class="hs-identifier">PPUP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUPEnv"><span class="hs-identifier">PPUPEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Serialization.html"><span class="hs-identifier">Shelley.Spec.Ledger.Serialization</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">decodeList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">decodeRecordSum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">decodeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">encodeFoldable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Slot.html"><span class="hs-identifier">Shelley.Spec.Ledger.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier">SlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Tx.html"><span class="hs-identifier">Shelley.Spec.Ledger.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Tx.html#Tx"><span class="hs-identifier">Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxIn"><span class="hs-identifier">TxIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html"><span class="hs-identifier">Shelley.Spec.Ledger.TxBody</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#DCert"><span class="hs-identifier">DCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#PoolParams"><span class="hs-identifier">PoolParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#RewardAcnt"><span class="hs-identifier">RewardAcnt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxBody"><span class="hs-identifier">TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#Wdrl"><span class="hs-identifier">Wdrl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html"><span class="hs-identifier">Shelley.Spec.Ledger.UTxO</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#UTxO"><span class="hs-identifier">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#balance"><span class="hs-identifier">balance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#totalDeposits"><span class="hs-identifier">totalDeposits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#txins"><span class="hs-identifier">txins</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#txouts"><span class="hs-identifier">txouts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#txup"><span class="hs-identifier">txup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">data</span><span> </span><span id="UTXO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-var">UTXO</span></a></span></span><span> </span><span id="local-6989586621680031199"><span class="annot"><a href="#local-6989586621680031199"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">data</span><span> </span><span id="UtxoEnv"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier hs-var">UtxoEnv</span></a></span></span><span> </span><span id="local-6989586621680031198"><span class="annot"><a href="#local-6989586621680031198"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="UtxoEnv"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier hs-var">UtxoEnv</span></a></span></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#GenDelegs"><span class="hs-identifier hs-type">GenDelegs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680031191"><span id="local-6989586621680031193"><span id="local-6989586621680031195"><span class="annot"><span class="annottext">Int -&gt; UtxoEnv era -&gt; ShowS
[UtxoEnv era] -&gt; ShowS
UtxoEnv era -&gt; String
(Int -&gt; UtxoEnv era -&gt; ShowS)
-&gt; (UtxoEnv era -&gt; String)
-&gt; ([UtxoEnv era] -&gt; ShowS)
-&gt; Show (UtxoEnv era)
forall era. Int -&gt; UtxoEnv era -&gt; ShowS
forall era. [UtxoEnv era] -&gt; ShowS
forall era. UtxoEnv era -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [UtxoEnv era] -&gt; ShowS
$cshowList :: forall era. [UtxoEnv era] -&gt; ShowS
show :: UtxoEnv era -&gt; String
$cshow :: forall era. UtxoEnv era -&gt; String
showsPrec :: Int -&gt; UtxoEnv era -&gt; ShowS
$cshowsPrec :: forall era. Int -&gt; UtxoEnv era -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621680031188"><span id="local-6989586621680031189"></span></span><span class="hs-keyword">data</span><span> </span><span id="UtxoPredicateFailure"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-var">UtxoPredicateFailure</span></a></span></span><span> </span><span id="local-6989586621680031413"><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BadInputsUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The bad transaction inputs</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExpiredUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-comment">-- transaction's time to live</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-comment">-- current slot</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MaxTxSizeUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-comment">-- the actual transaction size</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-comment">-- the max transaction size</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InputSetEmptyUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FeeTooSmallUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span></span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-comment">-- the minimum fee for this transaction</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-comment">-- the fee supplied in this transaction</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ValueNotConservedUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span></span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Torsor.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the Coin consumed by this transaction</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Torsor.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the Coin produced by this transaction</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WrongNetwork"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-comment">-- the expected network id</span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the set of addresses with incorrect network IDs</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WrongNetworkWithdrawal"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-comment">-- the expected network id</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#RewardAcnt"><span class="hs-identifier hs-type">RewardAcnt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the set of reward addresses with incorrect network IDs</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OutputTooSmallUTxO"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of supplied transaction outputs that are too small</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UpdateFailure"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUP"><span class="hs-identifier hs-type">PPUP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Subtransition Failures</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OutputBootAddrAttrsTooBig"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031413"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of supplied bad transaction outputs</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 UtxoPredicateFailure era -&gt; Rep (UtxoPredicateFailure era) x)
-&gt; (forall x.
    Rep (UtxoPredicateFailure era) x -&gt; UtxoPredicateFailure era)
-&gt; Generic (UtxoPredicateFailure era)
forall x.
Rep (UtxoPredicateFailure era) x -&gt; UtxoPredicateFailure era
forall x.
UtxoPredicateFailure era -&gt; Rep (UtxoPredicateFailure era) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall era x.
Rep (UtxoPredicateFailure era) x -&gt; UtxoPredicateFailure era
forall era x.
UtxoPredicateFailure era -&gt; Rep (UtxoPredicateFailure era) x
$cto :: forall era x.
Rep (UtxoPredicateFailure era) x -&gt; UtxoPredicateFailure era
$cfrom :: forall era x.
UtxoPredicateFailure era -&gt; Rep (UtxoPredicateFailure era) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621680031168"><span id="local-6989586621680031170"><span id="local-6989586621680031172"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680031167"><span class="annot"><a href="#local-6989586621680031167"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier hs-type">ShelleyBased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031167"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621680031163"><span id="local-6989586621680031165"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680031161"><span class="annot"><a href="#local-6989586621680031161"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier hs-type">ShelleyBased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031161"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031161"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621680031160"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680031154"><span id="local-6989586621680031156"><span id="local-6989586621680031158"><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Torsor.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031160"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031160"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621680031152"><span class="hs-keyword">instance</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621680031146"><span id="local-6989586621680031148"><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier hs-type">ShelleyBased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031152"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031152"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621680031144"><span class="annot"><span class="annottext">toCBOR :: UtxoPredicateFailure era -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-type">BadInputsUTxO</span></a></span><span> </span><span id="local-6989586621680031142"><span class="annot"><span class="annottext">Set (TxIn era)
</span><a href="#local-6989586621680031142"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; Encoding
forall a (f :: * -&gt; *). (ToCBOR a, Foldable f) =&gt; f a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">encodeFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era)
</span><a href="#local-6989586621680031142"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-type">ExpiredUTxO</span></a></span><span> </span><span id="local-6989586621680031141"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031141"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680031140"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031140"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031141"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031140"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-type">MaxTxSizeUTxO</span></a></span><span> </span><span id="local-6989586621680031139"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031139"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680031138"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031138"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031139"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031138"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-type">FeeTooSmallUTxO</span></a></span><span> </span><span id="local-6989586621680031137"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031137"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680031136"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031136"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031137"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031136"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-type">ValueNotConservedUTxO</span></a></span><span> </span><span id="local-6989586621680031135"><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031135"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680031134"><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031134"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Delta (Value era) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031135"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Delta (Value era) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031134"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-type">OutputTooSmallUTxO</span></a></span><span> </span><span id="local-6989586621680031133"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031133"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Encoding
forall a (f :: * -&gt; *). (ToCBOR a, Foldable f) =&gt; f a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">encodeFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031133"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UpdateFailure"><span class="hs-identifier hs-type">UpdateFailure</span></a></span><span> </span><span id="local-6989586621680031132"><span class="annot"><span class="annottext">PredicateFailure (PPUP era)
</span><a href="#local-6989586621680031132"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PpupPredicateFailure era -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">PredicateFailure (PPUP era)
PpupPredicateFailure era
</span><a href="#local-6989586621680031132"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetwork"><span class="hs-identifier hs-type">WrongNetwork</span></a></span><span> </span><span id="local-6989586621680031131"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031131"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span id="local-6989586621680031130"><span class="annot"><span class="annottext">Set (Addr era)
</span><a href="#local-6989586621680031130"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031131"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Addr era) -&gt; Encoding
forall a (f :: * -&gt; *). (ToCBOR a, Foldable f) =&gt; f a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">encodeFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Addr era)
</span><a href="#local-6989586621680031130"><span class="hs-identifier hs-var">wrongs</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-type">WrongNetworkWithdrawal</span></a></span><span> </span><span id="local-6989586621680031129"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031129"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span id="local-6989586621680031128"><span class="annot"><span class="annottext">Set (RewardAcnt era)
</span><a href="#local-6989586621680031128"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031129"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt era) -&gt; Encoding
forall a (f :: * -&gt; *). (ToCBOR a, Foldable f) =&gt; f a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">encodeFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt era)
</span><a href="#local-6989586621680031128"><span class="hs-identifier hs-var">wrongs</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-type">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span id="local-6989586621680031127"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031127"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Encoding
forall a (f :: * -&gt; *). (ToCBOR a, Foldable f) =&gt; f a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">encodeFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031127"><span class="hs-identifier hs-var">outs</span></a></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621680031126"><span class="hs-keyword">instance</span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621680031122"><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier hs-type">ShelleyBased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031126"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621680031120"><span class="annot"><span class="annottext">fromCBOR :: Decoder s (UtxoPredicateFailure era)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; (Word -&gt; Decoder s (Int, UtxoPredicateFailure era))
-&gt; Decoder s (UtxoPredicateFailure era)
forall s a. String -&gt; (Word -&gt; Decoder s (Int, a)) -&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeRecordSum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PredicateFailureUTXO&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Word -&gt; Decoder s (Int, UtxoPredicateFailure era))
 -&gt; Decoder s (UtxoPredicateFailure era))
-&gt; (Word -&gt; Decoder s (Int, UtxoPredicateFailure era))
-&gt; Decoder s (UtxoPredicateFailure era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>          </span><span id="local-6989586621680031118"><span class="annot"><span class="annottext">Set (TxIn era)
</span><a href="#local-6989586621680031118"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (TxIn era) -&gt; Decoder s (Set (TxIn era))
forall a s. Ord a =&gt; Decoder s a -&gt; Decoder s (Set a)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeSet</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (TxIn era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-214"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; UtxoPredicateFailure era
forall era. Set (TxIn era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era)
</span><a href="#local-6989586621680031118"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The (2,..) indicates the number of things decoded, INCLUDING the tags, which are decoded by decodeRecordSumNamed</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>          </span><span id="local-6989586621680031117"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031117"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-217"></span><span>          </span><span id="local-6989586621680031116"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031116"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; UtxoPredicateFailure era
forall era. SlotNo -&gt; SlotNo -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031117"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031116"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>          </span><span id="local-6989586621680031115"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031115"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Integer
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-221"></span><span>          </span><span id="local-6989586621680031114"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031114"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Integer
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; UtxoPredicateFailure era
forall era. Integer -&gt; Integer -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031115"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680031114"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoPredicateFailure era
forall era. UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>          </span><span id="local-6989586621680031113"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031113"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Coin
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-226"></span><span>          </span><span id="local-6989586621680031112"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031112"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Coin
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; UtxoPredicateFailure era
forall era. Coin -&gt; Coin -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031113"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031112"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>          </span><span id="local-6989586621680031111"><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031111"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Delta (Value era))
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span id="local-6989586621680031110"><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031110"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Delta (Value era))
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-231"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Delta (Value era) -&gt; Delta (Value era) -&gt; UtxoPredicateFailure era
forall era.
Delta (Value era) -&gt; Delta (Value era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031111"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Delta (Value era)
</span><a href="#local-6989586621680031110"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>          </span><span id="local-6989586621680031109"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031109"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (TxOut era) -&gt; Decoder s [TxOut era]
forall s a. Decoder s a -&gt; Decoder s [a]
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeList</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (TxOut era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; UtxoPredicateFailure era
forall era. [TxOut era] -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031109"><span class="hs-identifier hs-var">outs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>          </span><span id="local-6989586621680031108"><span class="annot"><span class="annottext">PpupPredicateFailure era
</span><a href="#local-6989586621680031108"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (PpupPredicateFailure era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-237"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PredicateFailure (PPUP era) -&gt; UtxoPredicateFailure era
forall era. PredicateFailure (PPUP era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span><span> </span><span class="annot"><span class="annottext">PredicateFailure (PPUP era)
PpupPredicateFailure era
</span><a href="#local-6989586621680031108"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>          </span><span id="local-6989586621680031107"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031107"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Network
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-240"></span><span>          </span><span id="local-6989586621680031106"><span class="annot"><span class="annottext">Set (Addr era)
</span><a href="#local-6989586621680031106"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Addr era) -&gt; Decoder s (Set (Addr era))
forall a s. Ord a =&gt; Decoder s a -&gt; Decoder s (Set a)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeSet</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (Addr era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-241"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (Addr era) -&gt; UtxoPredicateFailure era
forall era. Network -&gt; Set (Addr era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031107"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Addr era)
</span><a href="#local-6989586621680031106"><span class="hs-identifier hs-var">wrongs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>          </span><span id="local-6989586621680031105"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031105"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Network
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-244"></span><span>          </span><span id="local-6989586621680031104"><span class="annot"><span class="annottext">Set (RewardAcnt era)
</span><a href="#local-6989586621680031104"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (RewardAcnt era) -&gt; Decoder s (Set (RewardAcnt era))
forall a s. Ord a =&gt; Decoder s a -&gt; Decoder s (Set a)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeSet</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (RewardAcnt era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-245"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (RewardAcnt era) -&gt; UtxoPredicateFailure era
forall era.
Network -&gt; Set (RewardAcnt era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031105"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt era)
</span><a href="#local-6989586621680031104"><span class="hs-identifier hs-var">wrongs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>          </span><span id="local-6989586621680031103"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031103"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (TxOut era) -&gt; Decoder s [TxOut era]
forall s a. Decoder s a -&gt; Decoder s [a]
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">decodeList</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (TxOut era)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-248"></span><span>          </span><span class="annot"><span class="annottext">(Int, UtxoPredicateFailure era)
-&gt; Decoder s (Int, UtxoPredicateFailure era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; UtxoPredicateFailure era
forall era. [TxOut era] -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031103"><span class="hs-identifier hs-var">outs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>        </span><span id="local-6989586621680031102"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031102"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Decoder s (Int, UtxoPredicateFailure era)
forall s a. Word -&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">invalidKey</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031102"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span id="local-6989586621680031101"><span class="hs-keyword">instance</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CryptoClass.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Signal"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">Signal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Tx.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Environment"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">Environment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseM"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">BaseM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#ShelleyBase"><span class="hs-identifier hs-type">ShelleyBase</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PredicateFailure"><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">PredicateFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621680031091"><span class="annot"><span class="annottext">transitionRules :: [TransitionRule (UTXO (ShelleyEra c))]
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">transitionRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TransitionRule (UTXO (ShelleyEra c))
forall era.
(ShelleyBased era, STS (UTXO era), Embed (PPUP era) (UTXO era),
 BaseM (UTXO era) ~ ShelleyBase,
 Environment (UTXO era) ~ UtxoEnv era,
 State (UTXO era) ~ UTxOState era, Signal (UTXO era) ~ Tx era,
 PredicateFailure (UTXO era) ~ UtxoPredicateFailure era,
 HasField &quot;certs&quot; (TxBody era) (StrictSeq (DCert era)),
 HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)),
 HasField &quot;outputs&quot; (TxBody era) (StrictSeq (TxOut era)),
 HasField &quot;wdrls&quot; (TxBody era) (Wdrl era),
 HasField &quot;txfee&quot; (TxBody era) Coin,
 HasField &quot;ttl&quot; (TxBody era) SlotNo,
 HasField &quot;update&quot; (TxBody era) (StrictMaybe (Update era))) =&gt;
TransitionRule (UTXO era)
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#utxoInductive"><span class="hs-identifier hs-var">utxoInductive</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621680031088"><span class="annot"><span class="annottext">initialRules :: [InitialRule (UTXO (ShelleyEra c))]
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">InitialRule (UTXO (ShelleyEra c))
forall c. InitialRule (UTXO (ShelleyEra c))
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#initialLedgerState"><span class="hs-identifier hs-var">initialLedgerState</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621680031085"><span class="annot"><span class="annottext">renderAssertionViolation :: AssertionViolation (UTXO (ShelleyEra c)) -&gt; String
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">renderAssertionViolation</span></a></span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">AssertionViolation</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031082"><span class="annot"><span class="annottext">String
avSTS :: forall sts. AssertionViolation sts -&gt; String
avSTS :: String
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var">avSTS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031080"><span class="annot"><span class="annottext">String
avMsg :: forall sts. AssertionViolation sts -&gt; String
avMsg :: String
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var">avMsg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031078"><span class="annot"><span class="annottext">TRC (UTXO (ShelleyEra c))
avCtx :: forall sts. AssertionViolation sts -&gt; TRC sts
avCtx :: TRC (UTXO (ShelleyEra c))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var">avCtx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031076"><span class="annot"><span class="annottext">Maybe (State (UTXO (ShelleyEra c)))
avState :: forall sts. AssertionViolation sts -&gt; Maybe (State sts)
avState :: Maybe (State (UTXO (ShelleyEra c)))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var">avState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AssertionViolation (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680031082"><span class="hs-identifier hs-var">avSTS</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;): &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680031080"><span class="hs-identifier hs-var">avMsg</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TRC (UTXO (ShelleyEra c)) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TRC (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031078"><span class="hs-identifier hs-var">avCtx</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (UTxOState (ShelleyEra c)) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Maybe (State (UTXO (ShelleyEra c)))
Maybe (UTxOState (ShelleyEra c))
</span><a href="#local-6989586621680031076"><span class="hs-identifier hs-var">avState</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621680031073"><span class="annot"><span class="annottext">assertions :: [Assertion (UTXO (ShelleyEra c))]
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">assertions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (UTXO (ShelleyEra c)) -&gt; Bool)
-&gt; Assertion (UTXO (ShelleyEra c))
forall sts. String -&gt; (TRC sts -&gt; Bool) -&gt; Assertion sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">PreCondition</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deposit pot must not be negative (pre)&quot;</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031069"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031069"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_deposited"><span class="hs-identifier hs-var hs-var">_deposited</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031069"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; (TRC (UTXO (ShelleyEra c))
    -&gt; State (UTXO (ShelleyEra c)) -&gt; Bool)
-&gt; Assertion (UTXO (ShelleyEra c))
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">PostCondition</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UTxO must increase fee pot&quot;</span></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031066"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031066"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680031065"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031065"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_fees"><span class="hs-identifier hs-var hs-var">_fees</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031065"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_fees"><span class="hs-identifier hs-var hs-var">_fees</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031066"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; (TRC (UTXO (ShelleyEra c))
    -&gt; State (UTXO (ShelleyEra c)) -&gt; Bool)
-&gt; Assertion (UTXO (ShelleyEra c))
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">PostCondition</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deposit pot must not be negative (post)&quot;</span></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TRC (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680031063"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031063"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_deposited"><span class="hs-identifier hs-var hs-var">_deposited</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031063"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031062"><span class="annot"><span class="annottext">utxoBalance :: UTxOState era -&gt; Value era
</span><a href="#local-6989586621680031062"><span class="hs-identifier hs-var hs-var">utxoBalance</span></a></span></span><span> </span><span id="local-6989586621680031061"><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621680031061"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t. Val t =&gt; Coin -&gt; t
</span><a href="Cardano.Ledger.Val.html#inject"><span class="hs-identifier hs-var">Val.inject</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Value era) -&gt; Coin -&gt; Value era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_deposited"><span class="hs-identifier hs-var hs-var">_deposited</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621680031061"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_fees"><span class="hs-identifier hs-var hs-var">_fees</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621680031061"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Value era
forall era. ShelleyBased era =&gt; UTxO era -&gt; Value era
</span><a href="Shelley.Spec.Ledger.UTxO.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOState era -&gt; UTxO era
forall era. UTxOState era -&gt; UTxO era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_utxo"><span class="hs-identifier hs-var hs-var">_utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621680031061"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><a href="#local-6989586621680031058"><span class="hs-identifier hs-type">withdrawals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>          </span><span id="local-6989586621680031058"><span class="annot"><span class="annottext">withdrawals :: TxBody (ShelleyEra c) -&gt; Value (ShelleyEra c)
</span><a href="#local-6989586621680031058"><span class="hs-identifier hs-var hs-var">withdrawals</span></a></span></span><span> </span><span id="local-6989586621680031057"><span class="annot"><span class="annottext">TxBody (ShelleyEra c)
</span><a href="#local-6989586621680031057"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin
forall t. Val t =&gt; Coin -&gt; t
</span><a href="Cardano.Ledger.Val.html#inject"><span class="hs-identifier hs-var">Val.inject</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Coin) -&gt; Coin -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Coin -&gt; Coin)
-&gt; Coin -&gt; Map (RewardAcnt (ShelleyEra c)) Coin -&gt; Coin
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Map (RewardAcnt (ShelleyEra c)) Coin -&gt; Coin)
-&gt; Map (RewardAcnt (ShelleyEra c)) Coin -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Wdrl (ShelleyEra c) -&gt; Map (RewardAcnt (ShelleyEra c)) Coin
forall era. Wdrl era -&gt; Map (RewardAcnt era) Coin
</span><a href="Shelley.Spec.Ledger.TxBody.html#unWdrl"><span class="hs-identifier hs-var hs-var">unWdrl</span></a></span><span> </span><span class="annot"><span class="annottext">(Wdrl (ShelleyEra c) -&gt; Map (RewardAcnt (ShelleyEra c)) Coin)
-&gt; Wdrl (ShelleyEra c) -&gt; Map (RewardAcnt (ShelleyEra c)) Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBody (ShelleyEra c)
-&gt; ShelleyBased (ShelleyEra c) =&gt; Wdrl (ShelleyEra c)
forall era. TxBody era -&gt; ShelleyBased era =&gt; Wdrl era
</span><a href="Shelley.Spec.Ledger.TxBody.html#_wdrls"><span class="hs-identifier hs-var">_wdrls</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (ShelleyEra c)
</span><a href="#local-6989586621680031057"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-284"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (UTXO (ShelleyEra c))
    -&gt; State (UTXO (ShelleyEra c)) -&gt; Bool)
-&gt; Assertion (UTXO (ShelleyEra c))
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">PostCondition</span></a></span><span>
</span><span id="line-285"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should preserve value in the UTxO state&quot;</span></span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031054"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031054"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031053"><span class="annot"><span class="annottext">Signal (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031053"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680031052"><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680031052"><span class="hs-identifier hs-var">us'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>                </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Value (ShelleyEra c)
forall era.
(Torsor (Value era), Compactible (Value era), Val (Value era),
 HashAnnotated (TxBody era) era, FromCBOR (Delta (Value era)),
 FromCBOR (Value era), FromCBOR (CompactForm (Value era)),
 FromCBOR (Annotator (TxBody era)),
 FromCBOR (Annotator (Script era)), ToCBOR (Delta (Value era)),
 ToCBOR (Value era), ToCBOR (TxBody era), ToCBOR (Script era),
 ToCBOR (CompactForm (Value era)), Show (Delta (Value era)),
 Show (Value era), Show (TxBody era), Show (Script era),
 Eq (Delta (Value era)), Eq (TxBody era), Eq (Script era),
 NoThunks (Delta (Value era)), NoThunks (Value era),
 NoThunks (TxBody era), NoThunks (Script era),
 HashIndex (TxBody era) ~ EraIndependentTxBody) =&gt;
UTxOState era -&gt; Value era
</span><a href="#local-6989586621680031062"><span class="hs-identifier hs-var">utxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031054"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxBody (ShelleyEra c) -&gt; Value (ShelleyEra c)
</span><a href="#local-6989586621680031058"><span class="hs-identifier hs-var">withdrawals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx (ShelleyEra c)
-&gt; TxBodyConstraints (ShelleyEra c) =&gt; TxBody (ShelleyEra c)
forall era. Tx era -&gt; TxBodyConstraints era =&gt; TxBody era
</span><a href="Shelley.Spec.Ledger.Tx.html#_body"><span class="hs-identifier hs-var">_body</span></a></span><span> </span><span class="annot"><span class="annottext">Signal (UTXO (ShelleyEra c))
Tx (ShelleyEra c)
</span><a href="#local-6989586621680031053"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c) -&gt; Value (ShelleyEra c)
forall era.
(Torsor (Value era), Compactible (Value era), Val (Value era),
 HashAnnotated (TxBody era) era, FromCBOR (Delta (Value era)),
 FromCBOR (Value era), FromCBOR (CompactForm (Value era)),
 FromCBOR (Annotator (TxBody era)),
 FromCBOR (Annotator (Script era)), ToCBOR (Delta (Value era)),
 ToCBOR (Value era), ToCBOR (TxBody era), ToCBOR (Script era),
 ToCBOR (CompactForm (Value era)), Show (Delta (Value era)),
 Show (Value era), Show (TxBody era), Show (Script era),
 Eq (Delta (Value era)), Eq (TxBody era), Eq (Script era),
 NoThunks (Delta (Value era)), NoThunks (Value era),
 NoThunks (TxBody era), NoThunks (Script era),
 HashIndex (TxBody era) ~ EraIndependentTxBody) =&gt;
UTxOState era -&gt; Value era
</span><a href="#local-6989586621680031062"><span class="hs-identifier hs-var">utxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">State (UTXO (ShelleyEra c))
UTxOState (ShelleyEra c)
</span><a href="#local-6989586621680031052"><span class="hs-identifier hs-var">us'</span></a></span><span>
</span><span id="line-288"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">]</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span id="local-6989586621680031383"><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#initialLedgerState"><span class="hs-identifier hs-type">initialLedgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">InitialRule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031383"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-292"></span><span id="initialLedgerState"><span class="annot"><span class="annottext">initialLedgerState :: InitialRule (UTXO (ShelleyEra c))
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#initialLedgerState"><span class="hs-identifier hs-var hs-var">initialLedgerState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">IRC</span></a></span><span> </span><span class="annot"><span class="annottext">Environment (UTXO (ShelleyEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F (Clause (UTXO (ShelleyEra c)) 'Initial)
  (IRC (UTXO (ShelleyEra c)))
forall sts (rtype :: RuleType).
Rule sts rtype (RuleContext rtype sts)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">judgmentContext</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="annottext">UTxOState (ShelleyEra c)
-&gt; F (Clause (UTXO (ShelleyEra c)) 'Initial)
     (UTxOState (ShelleyEra c))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(UTxOState (ShelleyEra c)
 -&gt; F (Clause (UTXO (ShelleyEra c)) 'Initial)
      (UTxOState (ShelleyEra c)))
-&gt; UTxOState (ShelleyEra c)
-&gt; F (Clause (UTXO (ShelleyEra c)) 'Initial)
     (UTxOState (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTxO (ShelleyEra c)
-&gt; Coin
-&gt; Coin
-&gt; PPUPState (ShelleyEra c)
-&gt; UTxOState (ShelleyEra c)
forall era.
UTxO era -&gt; Coin -&gt; Coin -&gt; PPUPState era -&gt; UTxOState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-var">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
-&gt; UTxO (ShelleyEra c)
forall era. Map (TxIn era) (TxOut era) -&gt; UTxO era
</span><a href="Shelley.Spec.Ledger.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PPUPState (ShelleyEra c)
forall era. PPUPState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#emptyPPUPState"><span class="hs-identifier hs-var">emptyPPUPState</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#utxoInductive"><span class="hs-identifier hs-type">utxoInductive</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031397"><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyBased"><span class="hs-identifier hs-type">ShelleyBased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUP"><span class="hs-identifier hs-type">PPUP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">BaseM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#ShelleyBase"><span class="hs-identifier hs-type">ShelleyBase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Tx.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoPredicateFailure"><span class="hs-identifier hs-type">UtxoPredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;certs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#DCert"><span class="hs-identifier hs-type">DCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;inputs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wdrls&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#Wdrl"><span class="hs-identifier hs-type">Wdrl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;txfee&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ttl&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasField</span></span><span> </span><span class="annot"><span class="hs-string">&quot;update&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.BaseTypes.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">TransitionRule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="utxoInductive"><span class="annot"><span class="annottext">utxoInductive :: TransitionRule (UTXO era)
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#utxoInductive"><span class="hs-identifier hs-var hs-var">utxoInductive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span id="local-6989586621680031045"><span class="annot"><a href="#local-6989586621680031045"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span id="local-6989586621680031044"><span class="annot"><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621680031043"><span class="annot"><a href="#local-6989586621680031043"><span class="hs-identifier hs-var">stakepools</span></a></span></span><span> </span><span id="local-6989586621680031042"><span class="annot"><a href="#local-6989586621680031042"><span class="hs-identifier hs-var">genDelegs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031041"><span class="annot"><span class="annottext">State (UTXO era)
</span><a href="#local-6989586621680031041"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031040"><span class="annot"><span class="annottext">Signal (UTXO era)
</span><a href="#local-6989586621680031040"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F (Clause (UTXO era) 'Transition) (TRC (UTXO era))
forall sts (rtype :: RuleType).
Rule sts rtype (RuleContext rtype sts)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">judgmentContext</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span id="local-6989586621680031039"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680031039"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621680031038"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031038"><span class="hs-identifier hs-var">deposits'</span></a></span></span><span> </span><span id="local-6989586621680031037"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031037"><span class="hs-identifier hs-var">fees</span></a></span></span><span> </span><span id="local-6989586621680031036"><span class="annot"><span class="annottext">PPUPState era
</span><a href="#local-6989586621680031036"><span class="hs-identifier hs-var">ppup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (UTXO era)
UTxOState era
</span><a href="#local-6989586621680031041"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031035"><span class="annot"><span class="annottext">txb :: TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; TxBodyConstraints era =&gt; TxBody era
forall era. Tx era -&gt; TxBodyConstraints era =&gt; TxBody era
</span><a href="Shelley.Spec.Ledger.Tx.html#_body"><span class="hs-identifier hs-var">_body</span></a></span><span> </span><span class="annot"><span class="annottext">Signal (UTXO era)
Tx era
</span><a href="#local-6989586621680031040"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="annottext">TxBody era -&gt; SlotNo
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;ttl&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031045"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; UtxoPredicateFailure era
forall era. SlotNo -&gt; SlotNo -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; SlotNo
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;ttl&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031045"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">TxBody era -&gt; Set (TxIn era)
forall era.
HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)) =&gt;
TxBody era -&gt; Set (TxIn era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#txins"><span class="hs-identifier hs-var">txins</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; Set (TxIn era) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">PredicateFailure (UTXO era)
forall era. UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031031"><span class="annot"><span class="annottext">minFee :: Coin
</span><a href="#local-6989586621680031031"><span class="hs-identifier hs-var hs-var">minFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Tx era -&gt; Coin
forall era. PParams era -&gt; Tx era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#minfee"><span class="hs-identifier hs-var">minfee</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Signal (UTXO era)
Tx era
</span><a href="#local-6989586621680031040"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span id="local-6989586621680031030"><span class="annot"><span class="annottext">txFee :: Coin
</span><a href="#local-6989586621680031030"><span class="hs-identifier hs-var hs-var">txFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Coin
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;txfee&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031031"><span class="hs-identifier hs-var">minFee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031030"><span class="hs-identifier hs-var">txFee</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; UtxoPredicateFailure era
forall era. Coin -&gt; Coin -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031031"><span class="hs-identifier hs-var">minFee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031030"><span class="hs-identifier hs-var">txFee</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall s t. Embed s t =&gt; Exp t -&gt; s
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; Set (TxIn era)
forall era.
HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)) =&gt;
TxBody era -&gt; Set (TxIn era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#txins"><span class="hs-identifier hs-var">txins</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; Exp (Sett (TxIn era) ()) -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">&#8838;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Exp (Sett (TxIn era) ())
forall k s (f :: * -&gt; * -&gt; *) v.
(Ord k, HasExp s (f k v)) =&gt;
s -&gt; Exp (Sett k ())
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680031039"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; UtxoPredicateFailure era
forall era. Set (TxIn era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxIn era -&gt; Bool) -&gt; Set (TxIn era) -&gt; Set (TxIn era)
forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031027"><span class="annot"><span class="annottext">TxIn era
</span><a href="#local-6989586621680031027"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn era -&gt; Map (TxIn era) (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">TxIn era
</span><a href="#local-6989586621680031027"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era -&gt; Map (TxIn era) (TxOut era)
forall era. UTxO era -&gt; Map (TxIn era) (TxOut era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#unUTxO"><span class="hs-identifier hs-var hs-var">unUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680031039"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; Set (TxIn era)
forall era.
HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)) =&gt;
TxBody era -&gt; Set (TxIn era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#txins"><span class="hs-identifier hs-var">txins</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621680031023"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031023"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BaseM (UTXO era) Network -&gt; Rule (UTXO era) 'Transition Network
forall sts a (ctx :: RuleType).
STS sts =&gt;
BaseM sts a -&gt; Rule sts ctx a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">liftSTS</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM (UTXO era) Network -&gt; Rule (UTXO era) 'Transition Network)
-&gt; BaseM (UTXO era) Network -&gt; Rule (UTXO era) 'Transition Network
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Globals -&gt; Network) -&gt; ReaderT Globals Identity Network
forall (m :: * -&gt; *) r a. Monad m =&gt; (r -&gt; a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Globals -&gt; Network
</span><a href="Shelley.Spec.Ledger.BaseTypes.html#networkId"><span class="hs-identifier hs-var hs-var">networkId</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031022"><span class="annot"><span class="annottext">addrsWrongNetwork :: [Addr era]
</span><a href="#local-6989586621680031022"><span class="hs-identifier hs-var hs-var">addrsWrongNetwork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">(Addr era -&gt; Bool) -&gt; [Addr era] -&gt; [Addr era]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031021"><span class="annot"><span class="annottext">Addr era
</span><a href="#local-6989586621680031021"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Addr era -&gt; Network
forall era. Addr era -&gt; Network
</span><a href="Shelley.Spec.Ledger.Address.html#getNetwork"><span class="hs-identifier hs-var">getNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Addr era
</span><a href="#local-6989586621680031021"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Network -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031023"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut era -&gt; Addr era) -&gt; [TxOut era] -&gt; [Addr era]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span id="local-6989586621680031019"><span class="annot"><span class="annottext">Addr era
</span><a href="#local-6989586621680031019"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Addr era
</span><a href="#local-6989586621680031019"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TxOut era] -&gt; [Addr era]) -&gt; [TxOut era] -&gt; [Addr era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (TxOut era) -&gt; [TxOut era]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (TxOut era) -&gt; [TxOut era])
-&gt; StrictSeq (TxOut era) -&gt; [TxOut era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; StrictSeq (TxOut era)
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><span class="annottext">[Addr era] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Addr era]
</span><a href="#local-6989586621680031022"><span class="hs-identifier hs-var">addrsWrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (Addr era) -&gt; UtxoPredicateFailure era
forall era. Network -&gt; Set (Addr era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031023"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Addr era] -&gt; Set (Addr era)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Addr era]
</span><a href="#local-6989586621680031022"><span class="hs-identifier hs-var">addrsWrongNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031016"><span class="annot"><span class="annottext">wdrlsWrongNetwork :: [RewardAcnt era]
</span><a href="#local-6989586621680031016"><span class="hs-identifier hs-var hs-var">wdrlsWrongNetwork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><span class="annottext">(RewardAcnt era -&gt; Bool) -&gt; [RewardAcnt era] -&gt; [RewardAcnt era]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span>
</span><span id="line-339"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031015"><span class="annot"><span class="annottext">RewardAcnt era
</span><a href="#local-6989586621680031015"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RewardAcnt era -&gt; Network
forall era. RewardAcnt era -&gt; Network
</span><a href="Shelley.Spec.Ledger.Address.html#getRwdNetwork"><span class="hs-identifier hs-var hs-var">getRwdNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAcnt era
</span><a href="#local-6989586621680031015"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Network -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031023"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (RewardAcnt era) Coin -&gt; [RewardAcnt era]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map (RewardAcnt era) Coin -&gt; [RewardAcnt era])
-&gt; (TxBody era -&gt; Map (RewardAcnt era) Coin)
-&gt; TxBody era
-&gt; [RewardAcnt era]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Wdrl era -&gt; Map (RewardAcnt era) Coin
forall era. Wdrl era -&gt; Map (RewardAcnt era) Coin
</span><a href="Shelley.Spec.Ledger.TxBody.html#unWdrl"><span class="hs-identifier hs-var hs-var">unWdrl</span></a></span><span> </span><span class="annot"><span class="annottext">(Wdrl era -&gt; Map (RewardAcnt era) Coin)
-&gt; (TxBody era -&gt; Wdrl era)
-&gt; TxBody era
-&gt; Map (RewardAcnt era) Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
forall r a. HasField &quot;wdrls&quot; r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;wdrls&quot;</span></span><span> </span><span class="annot"><span class="annottext">(TxBody era -&gt; [RewardAcnt era]) -&gt; TxBody era -&gt; [RewardAcnt era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><span class="annottext">[RewardAcnt era] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[RewardAcnt era]
</span><a href="#local-6989586621680031016"><span class="hs-identifier hs-var">wdrlsWrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (RewardAcnt era) -&gt; UtxoPredicateFailure era
forall era.
Network -&gt; Set (RewardAcnt era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621680031023"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RewardAcnt era] -&gt; Set (RewardAcnt era)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[RewardAcnt era]
</span><a href="#local-6989586621680031016"><span class="hs-identifier hs-var">wdrlsWrongNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031012"><span class="annot"><span class="annottext">consumed_ :: Value era
</span><a href="#local-6989586621680031012"><span class="hs-identifier hs-var hs-var">consumed_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; UTxO era -&gt; TxBody era -&gt; Value era
forall era.
(ShelleyBased era,
 HasField &quot;certs&quot; (TxBody era) (StrictSeq (DCert era)),
 HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)),
 HasField &quot;wdrls&quot; (TxBody era) (Wdrl era)) =&gt;
PParams era -&gt; UTxO era -&gt; TxBody era -&gt; Value era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#consumed"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680031039"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-344"></span><span>      </span><span id="local-6989586621680031011"><span class="annot"><span class="annottext">produced_ :: Value era
</span><a href="#local-6989586621680031011"><span class="hs-identifier hs-var hs-var">produced_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
-&gt; TxBody era
-&gt; Value era
forall era.
(ShelleyBased era,
 HasField &quot;certs&quot; (TxBody era) (StrictSeq (DCert era)),
 HasField &quot;outputs&quot; (TxBody era) (StrictSeq (TxOut era)),
 HasField &quot;txfee&quot; (TxBody era) Coin) =&gt;
PParams era
-&gt; Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
-&gt; TxBody era
-&gt; Value era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#produced"><span class="hs-identifier hs-var">produced</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
</span><a href="#local-6989586621680031043"><span class="hs-identifier hs-var">stakepools</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031012"><span class="hs-identifier hs-var">consumed_</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031011"><span class="hs-identifier hs-var">produced_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Delta (Value era) -&gt; Delta (Value era) -&gt; UtxoPredicateFailure era
forall era.
Delta (Value era) -&gt; Delta (Value era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Delta (Value era)
forall a. Torsor a =&gt; a -&gt; Delta a
</span><a href="Cardano.Ledger.Torsor.html#toDelta"><span class="hs-identifier hs-var">toDelta</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031012"><span class="hs-identifier hs-var">consumed_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Delta (Value era)
forall a. Torsor a =&gt; a -&gt; Delta a
</span><a href="Cardano.Ledger.Torsor.html#toDelta"><span class="hs-identifier hs-var">toDelta</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031011"><span class="hs-identifier hs-var">produced_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-comment">-- process Protocol Parameter Update Proposals</span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621680031009"><span class="annot"><span class="annottext">PPUPState era
</span><a href="#local-6989586621680031009"><span class="hs-identifier hs-var">ppup'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall sub super (rtype :: RuleType).
Embed sub super =&gt;
RuleContext rtype sub -&gt; Rule super rtype (State sub)
forall super (rtype :: RuleType).
Embed (PPUP era) super =&gt;
RuleContext rtype (PPUP era) -&gt; Rule super rtype (State (PPUP era))
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUP"><span class="hs-identifier hs-type">PPUP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RuleContext 'Transition (PPUP era)
 -&gt; Rule (UTXO era) 'Transition (State (PPUP era)))
-&gt; RuleContext 'Transition (PPUP era)
-&gt; Rule (UTXO era) 'Transition (State (PPUP era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Environment (PPUP era), State (PPUP era), Signal (PPUP era))
-&gt; TRC (PPUP era)
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; PParams era -&gt; GenDelegs (Crypto era) -&gt; PPUPEnv era
forall era.
SlotNo -&gt; PParams era -&gt; GenDelegs (Crypto era) -&gt; PPUPEnv era
</span><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUPEnv"><span class="hs-identifier hs-var">PPUPEnv</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680031045"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">GenDelegs (Crypto era)
</span><a href="#local-6989586621680031042"><span class="hs-identifier hs-var">genDelegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State (PPUP era)
PPUPState era
</span><a href="#local-6989586621680031036"><span class="hs-identifier hs-var">ppup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Maybe (Update era)
forall era.
(ShelleyBased era,
 HasField &quot;update&quot; (TxBody era) (StrictMaybe (Update era))) =&gt;
Tx era -&gt; Maybe (Update era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#txup"><span class="hs-identifier hs-var">txup</span></a></span><span> </span><span class="annot"><span class="annottext">Signal (UTXO era)
Tx era
</span><a href="#local-6989586621680031040"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680031007"><span class="annot"><span class="annottext">outputs :: [TxOut era]
</span><a href="#local-6989586621680031007"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn era) (TxOut era) -&gt; [TxOut era]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">(Map (TxIn era) (TxOut era) -&gt; [TxOut era])
-&gt; Map (TxIn era) (TxOut era) -&gt; [TxOut era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Map (TxIn era) (TxOut era)
forall era. UTxO era -&gt; Map (TxIn era) (TxOut era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#unUTxO"><span class="hs-identifier hs-var hs-var">unUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; UTxO era
forall era.
(ShelleyBased era,
 HasField &quot;outputs&quot; (TxBody era) (StrictSeq (TxOut era))) =&gt;
TxBody era -&gt; UTxO era
</span><a href="Shelley.Spec.Ledger.UTxO.html#txouts"><span class="hs-identifier hs-var">txouts</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621680031005"><span class="annot"><span class="annottext">minUTxOValue :: HKD Identity Coin
</span><a href="#local-6989586621680031005"><span class="hs-identifier hs-var hs-var">minUTxOValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; HKD Identity Coin
forall (f :: * -&gt; *) era. PParams' f era -&gt; HKD f Coin
</span><a href="Shelley.Spec.Ledger.PParams.html#_minUTxOValue"><span class="hs-identifier hs-var hs-var">_minUTxOValue</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-comment">-- minUTxOValue deposit comparison done as Coin because this rule</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-comment">-- is correct strictly in the Shelley era (in shelleyMA we would need to</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-comment">-- additionally check that all amounts are non-negative)</span><span>
</span><span id="line-355"></span><span>      </span><span id="local-6989586621680031003"><span class="annot"><span class="annottext">outputsTooSmall :: [TxOut era]
</span><a href="#local-6989586621680031003"><span class="hs-identifier hs-var hs-var">outputsTooSmall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680031002"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680031002"><span class="annot"><span class="annottext">out :: TxOut era
</span><a href="#local-6989586621680031002"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680031001"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031001"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031007"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Coin
forall t. Val t =&gt; t -&gt; Coin
</span><a href="Cardano.Ledger.Val.html#coin"><span class="hs-identifier hs-var">Val.coin</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031001"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Coin -&gt; Coin
forall v. Val v =&gt; v -&gt; Coin -&gt; Coin
</span><a href="Cardano.Ledger.Val.html#scaledMinDeposit"><span class="hs-identifier hs-var">Val.scaledMinDeposit</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621680031001"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
HKD Identity Coin
</span><a href="#local-6989586621680031005"><span class="hs-identifier hs-var">minUTxOValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031003"><span class="hs-identifier hs-var">outputsTooSmall</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; UtxoPredicateFailure era
forall era. [TxOut era] -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031003"><span class="hs-identifier hs-var">outputsTooSmall</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-comment">-- Bootstrap (i.e. Byron) addresses have variable sized attributes in them.</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-comment">-- It is important to limit their overall size.</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680030997"><span class="annot"><span class="annottext">outputsAttrsTooBig :: [TxOut era]
</span><a href="#local-6989586621680030997"><span class="hs-identifier hs-var hs-var">outputsAttrsTooBig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680030996"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680030996"><span class="annot"><span class="annottext">out :: TxOut era
</span><a href="#local-6989586621680030996"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Address.html#AddrBootstrap"><span class="hs-identifier hs-type">AddrBootstrap</span></a></span><span> </span><span id="local-6989586621680030995"><span class="annot"><span class="annottext">BootstrapAddress era
</span><a href="#local-6989586621680030995"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680031007"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BootstrapAddress era -&gt; Int
forall era. BootstrapAddress era -&gt; Int
</span><a href="Shelley.Spec.Ledger.Address.html#bootstrapAddressAttrsSize"><span class="hs-identifier hs-var">bootstrapAddressAttrsSize</span></a></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress era
</span><a href="#local-6989586621680030995"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680030997"><span class="hs-identifier hs-var">outputsAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; UtxoPredicateFailure era
forall era. [TxOut era] -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621680030997"><span class="hs-identifier hs-var">outputsAttrsTooBig</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680030993"><span class="annot"><span class="annottext">maxTxSize_ :: Integer
</span><a href="#local-6989586621680030993"><span class="hs-identifier hs-var hs-var">maxTxSize_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era -&gt; HKD Identity Natural
forall (f :: * -&gt; *) era. PParams' f era -&gt; HKD f Natural
</span><a href="Shelley.Spec.Ledger.PParams.html#_maxTxSize"><span class="hs-identifier hs-var hs-var">_maxTxSize</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621680030991"><span class="annot"><span class="annottext">txSize_ :: Integer
</span><a href="#local-6989586621680030991"><span class="hs-identifier hs-var hs-var">txSize_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Integer
forall era. Tx era -&gt; Integer
</span><a href="Shelley.Spec.Ledger.LedgerState.html#txsize"><span class="hs-identifier hs-var">txsize</span></a></span><span> </span><span class="annot"><span class="annottext">Signal (UTXO era)
Tx era
</span><a href="#local-6989586621680031040"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680030991"><span class="hs-identifier hs-var">txSize_</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680030993"><span class="hs-identifier hs-var">maxTxSize_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PredicateFailure (UTXO era) -&gt; Rule (UTXO era) 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; UtxoPredicateFailure era
forall era. Integer -&gt; Integer -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680030991"><span class="hs-identifier hs-var">txSize_</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680030993"><span class="hs-identifier hs-var">maxTxSize_</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680030990"><span class="annot"><span class="annottext">refunded :: Coin
</span><a href="#local-6989586621680030990"><span class="hs-identifier hs-var hs-var">refunded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; TxBody era -&gt; Coin
forall era.
HasField &quot;certs&quot; (TxBody era) (StrictSeq (DCert era)) =&gt;
PParams era -&gt; TxBody era -&gt; Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#keyRefunds"><span class="hs-identifier hs-var">keyRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680030989"><span class="annot"><span class="annottext">txCerts :: [DCert era]
</span><a href="#local-6989586621680030989"><span class="hs-identifier hs-var hs-var">txCerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictSeq (DCert era) -&gt; [DCert era]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (DCert era) -&gt; [DCert era])
-&gt; StrictSeq (DCert era) -&gt; [DCert era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; StrictSeq (DCert era)
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;certs&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680030988"><span class="annot"><span class="annottext">depositChange :: Coin
</span><a href="#local-6989586621680030988"><span class="hs-identifier hs-var hs-var">depositChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
-&gt; [DCert era]
-&gt; Coin
forall era.
PParams era
-&gt; Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
-&gt; [DCert era]
-&gt; Coin
</span><a href="Shelley.Spec.Ledger.UTxO.html#totalDeposits"><span class="hs-identifier hs-var">totalDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621680031044"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto era)) (PoolParams era)
</span><a href="#local-6989586621680031043"><span class="hs-identifier hs-var">stakepools</span></a></span><span> </span><span class="annot"><span class="annottext">[DCert era]
</span><a href="#local-6989586621680030989"><span class="hs-identifier hs-var">txCerts</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680030990"><span class="hs-identifier hs-var">refunded</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">UTxOState era -&gt; F (Clause (UTXO era) 'Transition) (UTxOState era)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">UTxOState :: forall era.
UTxO era -&gt; Coin -&gt; Coin -&gt; PPUPState era -&gt; UTxOState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_utxo :: UTxO era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_utxo"><span class="hs-identifier hs-var">_utxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Map (TxIn era) (TxOut era)) -&gt; UTxO era
forall s t. Embed s t =&gt; Exp t -&gt; s
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; Set (TxIn era)
forall era.
HasField &quot;inputs&quot; (TxBody era) (Set (TxIn era)) =&gt;
TxBody era -&gt; Set (TxIn era)
</span><a href="Shelley.Spec.Ledger.UTxO.html#txins"><span class="hs-identifier hs-var">txins</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn era) -&gt; UTxO era -&gt; Exp (Map (TxIn era) (TxOut era))
forall k (g :: * -&gt; * -&gt; *) s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g, HasExp s1 (g k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">&#8938;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680031039"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (Map (TxIn era) (TxOut era))
-&gt; UTxO era -&gt; Exp (Map (TxIn era) (TxOut era))
forall k v s1 (f :: * -&gt; * -&gt; *) s2 (g :: * -&gt; * -&gt; *).
(Show k, Show v, Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-operator hs-var">&#8746;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; UTxO era
forall era.
(ShelleyBased era,
 HasField &quot;outputs&quot; (TxBody era) (StrictSeq (TxOut era))) =&gt;
TxBody era -&gt; UTxO era
</span><a href="Shelley.Spec.Ledger.UTxO.html#txouts"><span class="hs-identifier hs-var">txouts</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">_deposited :: Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_deposited"><span class="hs-identifier hs-var">_deposited</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031038"><span class="hs-identifier hs-var">deposits'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680030988"><span class="hs-identifier hs-var">depositChange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">_fees :: Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_fees"><span class="hs-identifier hs-var">_fees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680031037"><span class="hs-identifier hs-var">fees</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; Coin
forall k (x :: k) r a. HasField x r a =&gt; r -&gt; a
</span><span class="hs-identifier hs-var">getField</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;txfee&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680031035"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">_ppups :: PPUPState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_ppups"><span class="hs-identifier hs-var">_ppups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PPUPState era
</span><a href="#local-6989586621680031009"><span class="hs-identifier hs-var">ppup'</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span id="local-6989586621680030986"><span class="hs-keyword">instance</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CryptoClass.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680030986"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Ppup.html#PPUP"><span class="hs-identifier hs-type">PPUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680030986"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Utxo.html#UTXO"><span class="hs-identifier hs-type">UTXO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680030986"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621680030981"><span class="annot"><span class="annottext">wrapFailed :: PredicateFailure (PPUP (ShelleyEra c))
-&gt; PredicateFailure (UTXO (ShelleyEra c))
</span><a href="#local-6989586621680030981"><span class="hs-identifier hs-var hs-var hs-var hs-var">wrapFailed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PredicateFailure (PPUP (ShelleyEra c))
-&gt; PredicateFailure (UTXO (ShelleyEra c))
forall era. PredicateFailure (PPUP era) -&gt; UtxoPredicateFailure era
</span><a href="Shelley.Spec.Ledger.STS.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span></span><span>
</span><span id="line-385"></span></pre></body></html>