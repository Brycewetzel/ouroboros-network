<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Shelley.Spec.Ledger.API.ByronTranslation</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#mkInitialShelleyLedgerView"><span class="hs-identifier">mkInitialShelleyLedgerView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateToShelleyLedgerState"><span class="hs-identifier">translateToShelleyLedgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Exported for testing purposes</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxOutByronToShelley"><span class="hs-identifier">translateCompactTxOutByronToShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateTxIdByronToShelley"><span class="hs-identifier">translateTxIdByronToShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Block</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Byron</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Common</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Byron</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.UTxO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Byron</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier">Cardano.Crypto.Hash</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Crypto</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-wrapper-1.3.0/noopt/doc/html/cardano-crypto-wrapper/src"><span class="hs-identifier">Cardano.Crypto.Hashing</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Hashing</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html"><span class="hs-identifier">Cardano.Ledger.Crypto</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CC</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.html"><span class="hs-identifier">Cardano.Ledger.Shelley</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier">ShelleyEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator">(&lt;-&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Short</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SBS</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.API.Protocol.html"><span class="hs-identifier">Shelley.Spec.Ledger.API.Protocol</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.API.Types.html"><span class="hs-identifier">Shelley.Spec.Ledger.API.Types</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html"><span class="hs-identifier">Shelley.Spec.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Compactible.html#CompactForm"><span class="hs-identifier">CompactForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#CompactCoin"><span class="hs-identifier">CompactCoin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.CompactAddr.html"><span class="hs-identifier">Shelley.Spec.Ledger.CompactAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.CompactAddr.html#CompactAddr"><span class="hs-identifier">CompactAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.CompactAddr.html#UnsafeCompactAddr"><span class="hs-identifier">UnsafeCompactAddr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.EpochBoundary.html"><span class="hs-identifier">Shelley.Spec.Ledger.EpochBoundary</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html"><span class="hs-identifier">Shelley.Spec.Ledger.LedgerState</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Rewards.html"><span class="hs-identifier">Shelley.Spec.Ledger.Rewards</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Chain.html"><span class="hs-identifier">Shelley.Spec.Ledger.STS.Chain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Shelley.Spec.Ledger.STS.Chain.html#pparamsToChainChecksData"><span class="hs-identifier">pparamsToChainChecksData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Slot.html"><span class="hs-identifier">Shelley.Spec.Ledger.Slot</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | We use the same hashing algorithm so we can unwrap and rewrap the bytes.</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- We don't care about the type that is hashed, which will differ going from</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- Byron to Shelley, we just use the hashes as IDs.</span><span>
</span><span id="line-41"></span><span id="local-6989586621680034400"><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateTxIdByronToShelley"><span class="hs-identifier hs-type">translateTxIdByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CC.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034400"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html#ADDRHASH"><span class="hs-identifier hs-type">CC.ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034400"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.Blake2b_224</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.TxId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxId"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034400"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-45"></span><span id="translateTxIdByronToShelley"><span class="annot"><span class="annottext">translateTxIdByronToShelley :: TxId -&gt; TxId (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateTxIdByronToShelley"><span class="hs-identifier hs-var hs-var">translateTxIdByronToShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="annottext">Hash (HASH c) EraIndependentTxBody -&gt; TxId (ShelleyEra c)
forall era. Hash (Crypto era) EraIndependentTxBody -&gt; TxId era
</span><a href="Shelley.Spec.Ledger.TxBody.html#TxId"><span class="hs-identifier hs-var">TxId</span></a></span><span> </span><span class="annot"><span class="annottext">(Hash (HASH c) EraIndependentTxBody -&gt; TxId (ShelleyEra c))
-&gt; (TxId -&gt; Hash (HASH c) EraIndependentTxBody)
-&gt; TxId
-&gt; TxId (ShelleyEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Hash (HASH c) EraIndependentTxBody
forall h a.
(HashAlgorithm h, HasCallStack) =&gt;
ShortByteString -&gt; Hash h a
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#hashFromShortBytesE"><span class="hs-identifier hs-var">hashFromShortBytesE</span></a></span><span> </span><span class="annot"><span class="annottext">(ShortByteString -&gt; Hash (HASH c) EraIndependentTxBody)
-&gt; (TxId -&gt; ShortByteString)
-&gt; TxId
-&gt; Hash (HASH c) EraIndependentTxBody
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; ShortByteString
forall algo a. AbstractHash algo a -&gt; ShortByteString
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-wrapper-1.3.0/noopt/doc/html/cardano-crypto-wrapper/src"><span class="hs-identifier hs-var">Hashing.abstractHashToShort</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#hashFromShortBytesE"><span class="hs-identifier hs-type">hashFromShortBytesE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680034435"><span class="annot"><a href="#local-6989586621680034435"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621680034432"><span class="annot"><a href="#local-6989586621680034432"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034435"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SBS.ShortByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.Hash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034435"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034432"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-53"></span><span id="hashFromShortBytesE"><span class="annot"><span class="annottext">hashFromShortBytesE :: ShortByteString -&gt; Hash h a
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#hashFromShortBytesE"><span class="hs-identifier hs-var hs-var">hashFromShortBytesE</span></a></span></span><span> </span><span id="local-6989586621680034310"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680034310"><span class="hs-identifier hs-var">sbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash h a -&gt; Maybe (Hash h a) -&gt; Hash h a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Hash h a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680034308"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Hash h a) -&gt; Hash h a) -&gt; Maybe (Hash h a) -&gt; Hash h a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Maybe (Hash h a)
forall h a. HashAlgorithm h =&gt; ShortByteString -&gt; Maybe (Hash h a)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-var">Crypto.hashFromBytesShort</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680034310"><span class="hs-identifier hs-var">sbs</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621680034308"><span class="annot"><span class="annottext">msg :: [Char]
</span><a href="#local-6989586621680034308"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;hashFromBytesShort called with ShortByteString of the wrong length: &quot;</span></span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680034310"><span class="hs-identifier hs-var">sbs</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621680034384"><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxOutByronToShelley"><span class="hs-identifier hs-type">translateCompactTxOutByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.CompactTxOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034384"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-60"></span><span id="translateCompactTxOutByronToShelley"><span class="annot"><span class="annottext">translateCompactTxOutByronToShelley :: CompactTxOut -&gt; TxOut (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxOutByronToShelley"><span class="hs-identifier hs-var hs-var">translateCompactTxOutByronToShelley</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.CompactTxOut</span></a></span><span> </span><span id="local-6989586621680034304"><span class="annot"><span class="annottext">CompactAddress
</span><a href="#local-6989586621680034304"><span class="hs-identifier hs-var">compactAddr</span></a></span></span><span> </span><span id="local-6989586621680034303"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680034303"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="annottext">CompactAddr (ShelleyEra c)
-&gt; CompactForm (Value (ShelleyEra c)) -&gt; TxOut (ShelleyEra c)
forall era. CompactAddr era -&gt; CompactForm (Value era) -&gt; TxOut era
</span><a href="Shelley.Spec.Ledger.TxBody.html#TxOutCompact"><span class="hs-identifier hs-var">TxOutCompact</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortByteString -&gt; CompactAddr (ShelleyEra c)
forall era. ShortByteString -&gt; CompactAddr era
</span><a href="Shelley.Spec.Ledger.CompactAddr.html#UnsafeCompactAddr"><span class="hs-identifier hs-var">UnsafeCompactAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactAddress -&gt; ShortByteString
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">Byron.unsafeGetCompactAddress</span></a></span><span> </span><span class="annot"><span class="annottext">CompactAddress
</span><a href="#local-6989586621680034304"><span class="hs-identifier hs-var">compactAddr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#CompactCoin"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; Word64
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">Byron.unsafeGetLovelace</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680034303"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621680034385"><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxInByronToShelley"><span class="hs-identifier hs-type">translateCompactTxInByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CC.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034385"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html#ADDRHASH"><span class="hs-identifier hs-type">CC.ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034385"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.Blake2b_224</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.CompactTxIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.TxBody.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034385"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-69"></span><span id="translateCompactTxInByronToShelley"><span class="annot"><span class="annottext">translateCompactTxInByronToShelley :: CompactTxIn -&gt; TxIn (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxInByronToShelley"><span class="hs-identifier hs-var hs-var">translateCompactTxInByronToShelley</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.CompactTxInUtxo</span></a></span><span> </span><span id="local-6989586621680034297"><span class="annot"><span class="annottext">CompactTxId
</span><a href="#local-6989586621680034297"><span class="hs-identifier hs-var">compactTxId</span></a></span></span><span> </span><span id="local-6989586621680034296"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680034296"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">TxId (ShelleyEra c) -&gt; Word64 -&gt; TxIn (ShelleyEra c)
forall era. TxId era -&gt; Word64 -&gt; TxIn era
</span><a href="Shelley.Spec.Ledger.TxBody.html#TxInCompact"><span class="hs-identifier hs-var">TxInCompact</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; TxId (ShelleyEra c)
forall c.
(Crypto c, ADDRHASH c ~ Blake2b_224) =&gt;
TxId -&gt; TxId (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateTxIdByronToShelley"><span class="hs-identifier hs-var">translateTxIdByronToShelley</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactTxId -&gt; TxId
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">Byron.fromCompactTxId</span></a></span><span> </span><span class="annot"><span class="annottext">CompactTxId
</span><a href="#local-6989586621680034297"><span class="hs-identifier hs-var">compactTxId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680034296"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateUTxOByronToShelley"><span class="hs-identifier hs-type">translateUTxOByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680034347"><span class="annot"><a href="#local-6989586621680034347"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CC.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034347"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html#ADDRHASH"><span class="hs-identifier hs-type">CC.ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034347"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.Blake2b_224</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.UTxO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034347"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span id="translateUTxOByronToShelley"><span class="annot"><span class="annottext">translateUTxOByronToShelley :: UTxO -&gt; UTxO (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateUTxOByronToShelley"><span class="hs-identifier hs-var hs-var">translateUTxOByronToShelley</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.UTxO</span></a></span><span> </span><span id="local-6989586621680034291"><span class="annot"><span class="annottext">Map CompactTxIn CompactTxOut
</span><a href="#local-6989586621680034291"><span class="hs-identifier hs-var">utxoByron</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
-&gt; UTxO (ShelleyEra c)
forall era. Map (TxIn era) (TxOut era) -&gt; UTxO era
</span><a href="Shelley.Spec.Ledger.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
 -&gt; UTxO (ShelleyEra c))
-&gt; Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
-&gt; UTxO (ShelleyEra c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">[(TxIn (ShelleyEra c), TxOut (ShelleyEra c))]
-&gt; Map (TxIn (ShelleyEra c)) (TxOut (ShelleyEra c))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn (ShelleyEra c)
</span><a href="#local-6989586621680034288"><span class="hs-identifier hs-var">txInShelley</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut (ShelleyEra c)
</span><a href="#local-6989586621680034287"><span class="hs-identifier hs-var">txOutShelley</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680034286"><span class="annot"><span class="annottext">CompactTxIn
</span><a href="#local-6989586621680034286"><span class="hs-identifier hs-var">txInByron</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680034285"><span class="annot"><span class="annottext">CompactTxOut
</span><a href="#local-6989586621680034285"><span class="hs-identifier hs-var">txOutByron</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map CompactTxIn CompactTxOut -&gt; [(CompactTxIn, CompactTxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map CompactTxIn CompactTxOut
</span><a href="#local-6989586621680034291"><span class="hs-identifier hs-var">utxoByron</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680034288"><span class="annot"><span class="annottext">txInShelley :: TxIn (ShelleyEra c)
</span><a href="#local-6989586621680034288"><span class="hs-identifier hs-var hs-var">txInShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompactTxIn -&gt; TxIn (ShelleyEra c)
forall c.
(Crypto c, ADDRHASH c ~ Blake2b_224) =&gt;
CompactTxIn -&gt; TxIn (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxInByronToShelley"><span class="hs-identifier hs-var">translateCompactTxInByronToShelley</span></a></span><span> </span><span class="annot"><span class="annottext">CompactTxIn
</span><a href="#local-6989586621680034286"><span class="hs-identifier hs-var">txInByron</span></a></span><span>
</span><span id="line-85"></span><span>              </span><span id="local-6989586621680034287"><span class="annot"><span class="annottext">txOutShelley :: TxOut (ShelleyEra c)
</span><a href="#local-6989586621680034287"><span class="hs-identifier hs-var hs-var">txOutShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompactTxOut -&gt; TxOut (ShelleyEra c)
forall c. CompactTxOut -&gt; TxOut (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateCompactTxOutByronToShelley"><span class="hs-identifier hs-var">translateCompactTxOutByronToShelley</span></a></span><span> </span><span class="annot"><span class="annottext">CompactTxOut
</span><a href="#local-6989586621680034285"><span class="hs-identifier hs-var">txOutByron</span></a></span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateToShelleyLedgerState"><span class="hs-identifier hs-type">translateToShelleyLedgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680034283"><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CC.Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html#ADDRHASH"><span class="hs-identifier hs-type">CC.ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-crypto-class-2.0.0/noopt/doc/html/cardano-crypto-class/src"><span class="hs-identifier hs-type">Crypto.Blake2b_224</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.ChainValidationState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span id="translateToShelleyLedgerState"><span class="annot"><span class="annottext">translateToShelleyLedgerState :: ShelleyGenesis (ShelleyEra c)
-&gt; EpochNo -&gt; ChainValidationState -&gt; NewEpochState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateToShelleyLedgerState"><span class="hs-identifier hs-var hs-var">translateToShelleyLedgerState</span></a></span></span><span> </span><span id="local-6989586621680034282"><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034282"><span class="hs-identifier hs-var">genesisShelley</span></a></span></span><span> </span><span id="local-6989586621680034281"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680034281"><span class="hs-identifier hs-var">epochNo</span></a></span></span><span> </span><span id="local-6989586621680034280"><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621680034280"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState :: forall era.
EpochNo
-&gt; BlocksMade era
-&gt; BlocksMade era
-&gt; EpochState era
-&gt; StrictMaybe (RewardUpdate era)
-&gt; PoolDistr (Crypto era)
-&gt; NewEpochState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nesEL :: EpochNo
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680034281"><span class="hs-identifier hs-var">epochNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">nesBprev :: BlocksMade (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesBprev"><span class="hs-identifier hs-var">nesBprev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto (ShelleyEra c))) Natural
-&gt; BlocksMade (ShelleyEra c)
forall era.
Map (KeyHash 'StakePool (Crypto era)) Natural -&gt; BlocksMade era
</span><a href="Shelley.Spec.Ledger.EpochBoundary.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto (ShelleyEra c))) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><span class="annottext">nesBcur :: BlocksMade (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesBcur"><span class="hs-identifier hs-var">nesBcur</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto (ShelleyEra c))) Natural
-&gt; BlocksMade (ShelleyEra c)
forall era.
Map (KeyHash 'StakePool (Crypto era)) Natural -&gt; BlocksMade era
</span><a href="Shelley.Spec.Ledger.EpochBoundary.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool (Crypto (ShelleyEra c))) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">nesEs :: EpochState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesEs"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochState (ShelleyEra c)
</span><a href="#local-6989586621680034272"><span class="hs-identifier hs-var">epochState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">nesRu :: StrictMaybe (RewardUpdate (ShelleyEra c))
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesRu"><span class="hs-identifier hs-var">nesRu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (RewardUpdate (ShelleyEra c))
forall a. StrictMaybe a
</span><a href="Shelley.Spec.Ledger.BaseTypes.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">nesPd :: PoolDistr (Crypto (ShelleyEra c))
</span><a href="Shelley.Spec.Ledger.LedgerState.html#nesPd"><span class="hs-identifier hs-var">nesPd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c) -&gt; PoolDistr c
forall crypto.
Map (KeyHash 'StakePool crypto) (IndividualPoolStake crypto)
-&gt; PoolDistr crypto
</span><a href="Shelley.Spec.Ledger.Delegation.Certificates.html#PoolDistr"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621680034267"><span class="hs-identifier hs-type">pparams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621680034267"><span class="annot"><span class="annottext">pparams :: PParams (ShelleyEra c)
</span><a href="#local-6989586621680034267"><span class="hs-identifier hs-var hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c) -&gt; PParams (ShelleyEra c)
forall era. ShelleyGenesis era -&gt; PParams era
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var hs-var">sgProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034282"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- NOTE: we ignore the Byron delegation map because the genesis and</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- delegation verification keys are hashed using a different hashing</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- scheme. This means we can't simply convert them, as Byron nowhere stores</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- the original verification keys.</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- Fortunately, no Byron genesis delegations have happened yet, and if</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- they did, we would be aware of them before the hard fork, as we</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- instigate the hard fork. We just have to make sure that the hard-coded</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- Shelley genesis contains the same genesis and delegation verification</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- keys, but hashed with the right algorithm.</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="#local-6989586621680034265"><span class="hs-identifier hs-type">genDelegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Keys.html#GenDelegs"><span class="hs-identifier hs-type">GenDelegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621680034265"><span class="annot"><span class="annottext">genDelegs :: GenDelegs c
</span><a href="#local-6989586621680034265"><span class="hs-identifier hs-var hs-var">genDelegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c
forall crypto.
Map (KeyHash 'Genesis crypto) (GenDelegPair crypto)
-&gt; GenDelegs crypto
</span><a href="Shelley.Spec.Ledger.Keys.html#GenDelegs"><span class="hs-identifier hs-var">GenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c)
-&gt; Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
-&gt; Map
     (KeyHash 'Genesis (Crypto (ShelleyEra c)))
     (GenDelegPair (Crypto (ShelleyEra c)))
forall era.
ShelleyGenesis era
-&gt; Map (KeyHash 'Genesis (Crypto era)) (GenDelegPair (Crypto era))
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgGenDelegs"><span class="hs-identifier hs-var hs-var">sgGenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034282"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621680034262"><span class="hs-identifier hs-type">reserves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621680034262"><span class="annot"><span class="annottext">reserves :: Coin
</span><a href="#local-6989586621680034262"><span class="hs-identifier hs-var hs-var">reserves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><span class="annottext">Word64 -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#word64ToCoin"><span class="hs-identifier hs-var">word64ToCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c) -&gt; Word64
forall era. ShelleyGenesis era -&gt; Word64
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgMaxLovelaceSupply"><span class="hs-identifier hs-var hs-var">sgMaxLovelaceSupply</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034282"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO (ShelleyEra c) -&gt; Value (ShelleyEra c)
forall era. ShelleyBased era =&gt; UTxO era -&gt; Value era
</span><a href="Shelley.Spec.Ledger.UTxO.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO (ShelleyEra c)
</span><a href="#local-6989586621680034258"><span class="hs-identifier hs-var">utxoShelley</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621680034272"><span class="hs-identifier hs-type">epochState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621680034272"><span class="annot"><span class="annottext">epochState :: EpochState (ShelleyEra c)
</span><a href="#local-6989586621680034272"><span class="hs-identifier hs-var hs-var">epochState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="annottext">EpochState :: forall era.
AccountState
-&gt; SnapShots era
-&gt; LedgerState era
-&gt; PParams era
-&gt; PParams era
-&gt; NonMyopic era
-&gt; EpochState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">esAccountState :: AccountState
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esAccountState"><span class="hs-identifier hs-var">esAccountState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; AccountState
</span><a href="Shelley.Spec.Ledger.LedgerState.html#AccountState"><span class="hs-identifier hs-var">AccountState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680034262"><span class="hs-identifier hs-var">reserves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">esSnapshots :: SnapShots (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esSnapshots"><span class="hs-identifier hs-var">esSnapshots</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapShots (ShelleyEra c)
forall era. SnapShots era
</span><a href="Shelley.Spec.Ledger.EpochBoundary.html#emptySnapShots"><span class="hs-identifier hs-var">emptySnapShots</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>          </span><span class="annot"><span class="annottext">esLState :: LedgerState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esLState"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyEra c)
</span><a href="#local-6989586621680034250"><span class="hs-identifier hs-var">ledgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>          </span><span class="annot"><span class="annottext">esPrevPp :: PParams (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esPrevPp"><span class="hs-identifier hs-var">esPrevPp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyEra c)
</span><a href="#local-6989586621680034267"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">esPp :: PParams (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esPp"><span class="hs-identifier hs-var">esPp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyEra c)
</span><a href="#local-6989586621680034267"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">esNonMyopic :: NonMyopic (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#esNonMyopic"><span class="hs-identifier hs-var">esNonMyopic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonMyopic (ShelleyEra c)
forall era. NonMyopic era
</span><a href="Shelley.Spec.Ledger.Rewards.html#emptyNonMyopic"><span class="hs-identifier hs-var">emptyNonMyopic</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="#local-6989586621680034245"><span class="hs-identifier hs-type">utxoByron</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Byron.UTxO</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621680034245"><span class="annot"><span class="annottext">utxoByron :: UTxO
</span><a href="#local-6989586621680034245"><span class="hs-identifier hs-var hs-var">utxoByron</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainValidationState -&gt; UTxO
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var hs-var">Byron.cvsUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621680034280"><span class="hs-identifier hs-var">cvs</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621680034258"><span class="hs-identifier hs-type">utxoShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621680034258"><span class="annot"><span class="annottext">utxoShelley :: UTxO (ShelleyEra c)
</span><a href="#local-6989586621680034258"><span class="hs-identifier hs-var hs-var">utxoShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; UTxO (ShelleyEra c)
forall c.
(Crypto c, ADDRHASH c ~ Blake2b_224) =&gt;
UTxO -&gt; UTxO (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#translateUTxOByronToShelley"><span class="hs-identifier hs-var">translateUTxOByronToShelley</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621680034245"><span class="hs-identifier hs-var">utxoByron</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="#local-6989586621680034250"><span class="hs-identifier hs-type">ledgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Shelley.Spec.Ledger.LedgerState.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621680034250"><span class="annot"><span class="annottext">ledgerState :: LedgerState (ShelleyEra c)
</span><a href="#local-6989586621680034250"><span class="hs-identifier hs-var hs-var">ledgerState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">LedgerState :: forall era. UTxOState era -&gt; DPState era -&gt; LedgerState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_utxoState :: UTxOState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_utxoState"><span class="hs-identifier hs-var">_utxoState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="annottext">UTxOState :: forall era.
UTxO era -&gt; Coin -&gt; Coin -&gt; PPUPState era -&gt; UTxOState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_utxo :: UTxO (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_utxo"><span class="hs-identifier hs-var">_utxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO (ShelleyEra c)
</span><a href="#local-6989586621680034258"><span class="hs-identifier hs-var">utxoShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>                </span><span class="annot"><span class="annottext">_deposited :: Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_deposited"><span class="hs-identifier hs-var">_deposited</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>                </span><span class="annot"><span class="annottext">_fees :: Coin
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_fees"><span class="hs-identifier hs-var">_fees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="Shelley.Spec.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>                </span><span class="annot"><span class="annottext">_ppups :: PPUPState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_ppups"><span class="hs-identifier hs-var">_ppups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PPUPState (ShelleyEra c)
forall era. PPUPState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#emptyPPUPState"><span class="hs-identifier hs-var">emptyPPUPState</span></a></span><span>
</span><span id="line-151"></span><span>              </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>          </span><span class="annot"><span class="annottext">_delegationState :: DPState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_delegationState"><span class="hs-identifier hs-var">_delegationState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>            </span><span class="annot"><span class="annottext">DPState :: forall era. DState era -&gt; PState era -&gt; DPState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#DPState"><span class="hs-identifier hs-type">DPState</span></a></span><span>
</span><span id="line-154"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_dstate :: DState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_dstate"><span class="hs-identifier hs-var">_dstate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DState (ShelleyEra c)
forall era. DState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#emptyDState"><span class="hs-identifier hs-var">emptyDState</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_genDelegs :: GenDelegs (Crypto (ShelleyEra c))
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_genDelegs"><span class="hs-identifier hs-var">_genDelegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenDelegs c
GenDelegs (Crypto (ShelleyEra c))
</span><a href="#local-6989586621680034265"><span class="hs-identifier hs-var">genDelegs</span></a></span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>                </span><span class="annot"><span class="annottext">_pstate :: PState (ShelleyEra c)
</span><a href="Shelley.Spec.Ledger.LedgerState.html#_pstate"><span class="hs-identifier hs-var">_pstate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PState (ShelleyEra c)
forall era. PState era
</span><a href="Shelley.Spec.Ledger.LedgerState.html#emptyPState"><span class="hs-identifier hs-var">emptyPState</span></a></span><span>
</span><span id="line-156"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | We construct a 'LedgerView' using the Shelley genesis config in the same</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- way as 'translateToShelleyLedgerState'.</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#mkInitialShelleyLedgerView"><span class="hs-identifier hs-type">mkInitialShelleyLedgerView</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680034228"><span class="annot"><a href="#local-6989586621680034228"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034228"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Shelley.Spec.Ledger.API.Protocol.html#LedgerView"><span class="hs-identifier hs-type">LedgerView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680034228"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-165"></span><span id="mkInitialShelleyLedgerView"><span class="annot"><span class="annottext">mkInitialShelleyLedgerView :: ShelleyGenesis (ShelleyEra c) -&gt; LedgerView c
</span><a href="Shelley.Spec.Ledger.API.ByronTranslation.html#mkInitialShelleyLedgerView"><span class="hs-identifier hs-var hs-var">mkInitialShelleyLedgerView</span></a></span></span><span> </span><span id="local-6989586621680034227"><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034227"><span class="hs-identifier hs-var">genesisShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="annottext">LedgerView :: forall crypto.
UnitInterval
-&gt; Nonce
-&gt; PoolDistr crypto
-&gt; GenDelegs crypto
-&gt; ChainChecksData
-&gt; LedgerView crypto
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#LedgerView"><span class="hs-identifier hs-type">LedgerView</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lvD :: UnitInterval
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#lvD"><span class="hs-identifier hs-var">lvD</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams' Identity (ShelleyEra c) -&gt; UnitInterval
forall (f :: * -&gt; *) era. PParams' f era -&gt; HKD f UnitInterval
</span><a href="Shelley.Spec.Ledger.PParams.html#_d"><span class="hs-identifier hs-var hs-var">_d</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams' Identity (ShelleyEra c) -&gt; UnitInterval)
-&gt; (ShelleyGenesis (ShelleyEra c)
    -&gt; PParams' Identity (ShelleyEra c))
-&gt; ShelleyGenesis (ShelleyEra c)
-&gt; UnitInterval
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c) -&gt; PParams' Identity (ShelleyEra c)
forall era. ShelleyGenesis era -&gt; PParams era
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var hs-var">sgProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis (ShelleyEra c) -&gt; UnitInterval)
-&gt; ShelleyGenesis (ShelleyEra c) -&gt; UnitInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034227"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">lvExtraEntropy :: Nonce
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#lvExtraEntropy"><span class="hs-identifier hs-var">lvExtraEntropy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams' Identity (ShelleyEra c) -&gt; Nonce
forall (f :: * -&gt; *) era. PParams' f era -&gt; HKD f Nonce
</span><a href="Shelley.Spec.Ledger.PParams.html#_extraEntropy"><span class="hs-identifier hs-var hs-var">_extraEntropy</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams' Identity (ShelleyEra c) -&gt; Nonce)
-&gt; (ShelleyGenesis (ShelleyEra c)
    -&gt; PParams' Identity (ShelleyEra c))
-&gt; ShelleyGenesis (ShelleyEra c)
-&gt; Nonce
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c) -&gt; PParams' Identity (ShelleyEra c)
forall era. ShelleyGenesis era -&gt; PParams era
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var hs-var">sgProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis (ShelleyEra c) -&gt; Nonce)
-&gt; ShelleyGenesis (ShelleyEra c) -&gt; Nonce
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034227"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">lvPoolDistr :: PoolDistr c
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#lvPoolDistr"><span class="hs-identifier hs-var">lvPoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c) -&gt; PoolDistr c
forall crypto.
Map (KeyHash 'StakePool crypto) (IndividualPoolStake crypto)
-&gt; PoolDistr crypto
</span><a href="Shelley.Spec.Ledger.Delegation.Certificates.html#PoolDistr"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">lvGenDelegs :: GenDelegs c
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#lvGenDelegs"><span class="hs-identifier hs-var">lvGenDelegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c
forall crypto.
Map (KeyHash 'Genesis crypto) (GenDelegPair crypto)
-&gt; GenDelegs crypto
</span><a href="Shelley.Spec.Ledger.Keys.html#GenDelegs"><span class="hs-identifier hs-var">GenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c)
-&gt; Map (KeyHash 'Genesis c) (GenDelegPair c) -&gt; GenDelegs c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
-&gt; Map
     (KeyHash 'Genesis (Crypto (ShelleyEra c)))
     (GenDelegPair (Crypto (ShelleyEra c)))
forall era.
ShelleyGenesis era
-&gt; Map (KeyHash 'Genesis (Crypto era)) (GenDelegPair (Crypto era))
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgGenDelegs"><span class="hs-identifier hs-var hs-var">sgGenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034227"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">lvChainChecks :: ChainChecksData
</span><a href="Shelley.Spec.Ledger.API.Protocol.html#lvChainChecks"><span class="hs-identifier hs-var">lvChainChecks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams' Identity (ShelleyEra c) -&gt; ChainChecksData
forall era. PParams era -&gt; ChainChecksData
</span><a href="Shelley.Spec.Ledger.STS.Chain.html#pparamsToChainChecksData"><span class="hs-identifier hs-var">pparamsToChainChecksData</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams' Identity (ShelleyEra c) -&gt; ChainChecksData)
-&gt; (ShelleyGenesis (ShelleyEra c)
    -&gt; PParams' Identity (ShelleyEra c))
-&gt; ShelleyGenesis (ShelleyEra c)
-&gt; ChainChecksData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c) -&gt; PParams' Identity (ShelleyEra c)
forall era. ShelleyGenesis era -&gt; PParams era
</span><a href="Shelley.Spec.Ledger.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var hs-var">sgProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis (ShelleyEra c) -&gt; ChainChecksData)
-&gt; ShelleyGenesis (ShelleyEra c) -&gt; ChainChecksData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis (ShelleyEra c)
</span><a href="#local-6989586621680034227"><span class="hs-identifier hs-var">genesisShelley</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span></pre></body></html>