<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, FlexibleInstances, FunctionalDependencies  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric           #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Iterate.SetAlgebra</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeListLenOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rnf</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html"><span class="hs-identifier">Control.Iterate.Collect</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">link</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">link2</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.ANSI.Leijen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">align</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vsep</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- ==================================================================================================</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | In order to build typed Exp (which are a typed deep embedding) of Set operations, we need to know</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- what kind of basic types of Maps and Sets can be embedded. Every Basic type has a few operations</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- for creating one from a list, for adding and removing key-value pairs, looking up a value given a key.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Instances of this algebra are functional in that every key has exactly one value associated with it.</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- ===================================================================================================</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Basic"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-var">Basic</span></a></span></span><span> </span><span id="local-6989586621679130238"><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- | in addpair the new value always prevails, to make a choice use 'addkv' which has a combining function that allows choice.</span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679130226"><span id="local-6989586621679130227"><span id="addpair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-type">addpair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130227"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130227"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130227"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130227"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130226"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621679127764"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-var hs-var">addpair</span></a></span><span> </span><span id="local-6989586621679127763"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127763"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127762"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127762"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679127761"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127761"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127763"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127762"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127761"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127759"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127759"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679127758"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127758"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127758"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- | use (\ old new -&gt; old) if you want the v in (f k v) to prevail, and use (\ old new -&gt; new) if you want the v in (k,v) to prevail</span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679130235"><span id="local-6989586621679130236"><span id="addkv"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-type">addkv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130236"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130236"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130236"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130236"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130235"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679130224"><span id="local-6989586621679130225"><span id="removekey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-type">removekey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130225"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130224"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130224"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679130222"><span id="local-6989586621679130223"><span id="domain"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-type">domain</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130223"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130223"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130222"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130223"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679130219"><span id="local-6989586621679130220"><span id="range"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-type">range</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130220"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130219"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130220"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130220"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679130217"><span id="local-6989586621679130218"><span id="emptyc"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#emptyc"><span class="hs-identifier hs-type">emptyc</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130218"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130238"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130218"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130217"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679127753"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#emptyc"><span class="hs-identifier hs-var hs-var">emptyc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;emptyc only works on some types.&quot;</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- ========== Basic List ==============</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | The constructor for List is hidden, since it requires some invariants. Use fromPairs to build an initial List.</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127749"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>   </span><span id="local-6989586621679127742"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; List k v -&gt; (v -&gt; v -&gt; v) -&gt; List k v
</span><a href="#local-6989586621679127742"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127741"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127740"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127738"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127738"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127737"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127737"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127736"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127738"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>       </span><span id="local-6989586621679127736"><span class="annot"><span class="annottext">insert :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127736"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>       </span><span class="annot"><a href="#local-6989586621679127736"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127735"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127734"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127733"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-59"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127736"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-60"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-61"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127737"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-62"></span><span>   </span><span id="local-6989586621679127731"><span class="annot"><span class="annottext">removekey :: k -&gt; List k v -&gt; List k v
</span><a href="#local-6989586621679127731"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679127730"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127730"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127729"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127729"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127728"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127729"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>       </span><span id="local-6989586621679127728"><span class="annot"><span class="annottext">remove :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127728"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>       </span><span class="annot"><a href="#local-6989586621679127728"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127727"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127727"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127726"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127726"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127725"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127725"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127727"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127730"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127725"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127730"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127726"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679127728"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127725"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>   </span><span id="local-6989586621679127724"><span class="annot"><span class="annottext">domain :: List k v -&gt; Set k
</span><a href="#local-6989586621679127724"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127723"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127723"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k -&gt; [(k, v)] -&gt; Set k
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127721"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127720"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127720"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127719"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127719"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127719"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127723"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-66"></span><span>   </span><span id="local-6989586621679127716"><span class="annot"><span class="annottext">range :: List k v -&gt; Set v
</span><a href="#local-6989586621679127716"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127715"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127715"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; [(k, v)] -&gt; Set v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127714"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127714"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127713"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127713"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127712"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679127712"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127713"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679127712"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127715"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-67"></span><span>   </span><span id="local-6989586621679127711"><span class="annot"><span class="annottext">emptyc :: List k v
</span><a href="#local-6989586621679127711"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621679129324"><span id="local-6989586621679129325"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-type">fromPairs</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129325"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129324"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129325"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129324"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129325"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129324"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-71"></span><span id="fromPairs"><span class="annot"><span class="annottext">fromPairs :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679127709"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127709"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679127708"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127708"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127709"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127706"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127706"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679127705"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127705"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127706"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127705"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127708"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621679130191"><span id="local-6989586621679130192"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130192"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130191"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130191"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130191"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130192"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130191"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130192"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130191"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-74"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679127704"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127704"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679127703"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127703"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679127702"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127702"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127701"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127701"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127702"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127701"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679127700"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127700"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127699"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127699"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127698"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127698"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679127697"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127697"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127696"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127696"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127695"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127699"><span class="hs-identifier hs-var">k1</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127697"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127700"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127699"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127700"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127698"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127696"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679127694"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127694"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127693"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127692"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127692"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127694"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127692"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- ================ Basic Single ===============</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- The Single type encode 0 or 1 pairs. Iteration is trivial. Succeeds only once.</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">data</span><span> </span><span id="Single"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span id="local-6989586621679127691"><span class="annot"><a href="#local-6989586621679127691"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127690"><span class="annot"><a href="#local-6989586621679127690"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679130177"><span id="local-6989586621679130178"><span id="Single"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130178"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130177"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130178"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130177"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679130172"><span id="local-6989586621679130173"><span id="Fail"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130173"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130172"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679130176"><span id="SetSingle"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130176"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130176"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679127681"><span id="local-6989586621679127683"><span id="local-6989586621679127685"><span id="local-6989586621679127686"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127686"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127685"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127686"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127685"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- Since we can only store one key, we have to choose who wins</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- We use the combine function to decide. (\ old new -&gt; old) keeps</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- the orginal value. (\ old new -&gt; new) overwrites the stored value.</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- Something else like (\ old new -&gt; old+new) overwrites with a combination</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127677"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679127671"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Single k v -&gt; (v -&gt; v -&gt; v) -&gt; Single k v
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127670"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127669"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127669"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127668"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127668"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679127667"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127667"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127668"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127666"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127666"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127665"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127665"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127666"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127667"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127665"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127669"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127664"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127664"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127664"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-100"></span><span>       </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127669"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679127663"><span class="annot"><span class="annottext">removekey :: k -&gt; Single k v -&gt; Single k v
</span><a href="#local-6989586621679127663"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679127662"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127661"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127660"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127660"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127660"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679127659"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127658"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679127657"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127657"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679127656"><span class="annot"><span class="annottext">domain :: Single k v -&gt; Set k
</span><a href="#local-6989586621679127656"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127655"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127655"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127654"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127654"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127655"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127652"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127652"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127652"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679127651"><span class="annot"><span class="annottext">range :: Single k v -&gt; Set v
</span><a href="#local-6989586621679127651"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127650"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127650"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679127649"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127648"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127648"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679127647"><span class="annot"><span class="annottext">emptyc :: Single k v
</span><a href="#local-6989586621679127647"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- ============== Basic Map =========================</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127644"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679127638"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
</span><a href="#local-6989586621679127638"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127637"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127636"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127635"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127635"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679127634"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127635"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679127631"><span class="annot"><span class="annottext">removekey :: k -&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679127630"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127629"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679127627"><span class="annot"><span class="annottext">domain :: Map k v -&gt; Set k
</span><a href="#local-6989586621679127627"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span id="local-6989586621679127626"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127626"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127626"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679127624"><span class="annot"><span class="annottext">range :: Map k v -&gt; Set v
</span><a href="#local-6989586621679127624"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679127623"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127623"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; Map k v -&gt; Set v
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127621"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679127620"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127620"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span id="local-6989586621679127619"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679127619"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127620"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679127619"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127623"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679127618"><span class="annot"><span class="annottext">emptyc :: Map k v
</span><a href="#local-6989586621679127618"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- Data.Map uses(\ new old -&gt; ...) while our convention is (\ old new -&gt; ...)</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- We also use this in the Basic instance for BiMap, which uses Data.Map</span><span>
</span><span id="line-124"></span><span id="local-6989586621679130157"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-type">mapflip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130157"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-125"></span><span id="mapflip"><span class="annot"><span class="annottext">mapflip :: (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var hs-var">mapflip</span></a></span></span><span> </span><span id="local-6989586621679127616"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127616"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679127615"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127615"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679127614"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127616"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127615"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- =================== Basic BiMap =====================</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- For Bijections we define (BiMap v k v).  Reasons we can't use (Data.Bimap k v)</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- 1) We need to enforce that the second argument `v` is in the Ord class, when making it an Iter instance.</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- 2) The constructor for Data.BiMap is not exported, and it implements a Bijection</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- 3) Missing operation 'restrictkeys' and 'withoutkeys' make performant versions of operations  &#9665; &#8938; &#9655; &#8939; hard.</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- 4) Missing operation 'union', make performant versions of &#8746; and &#10755; hard.</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- 5) So we roll our own which is really a (Data.Map k v) with an index that maps v to Set{k}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">data</span><span> </span><span id="BiMap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-var">BiMap</span></a></span></span><span> </span><span id="local-6989586621679127613"><span class="annot"><a href="#local-6989586621679127613"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679127612"><span class="annot"><a href="#local-6989586621679127612"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679127611"><span class="annot"><a href="#local-6989586621679127611"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679130117"><span id="local-6989586621679130118"><span id="local-6989586621679130119"><span id="MkBiMap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679130118"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130117"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130118"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130118"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130117"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130117"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130118"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-137"></span><span>                                </span><span class="hs-comment">--  ^   the 1st and 3rd parameter must be the same:             ^   ^</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- ============== begin necessary Cardano.Binary instances ===============</span><span>
</span><span id="line-140"></span><span id="local-6989586621679127608"><span id="local-6989586621679127609"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127602"><span id="local-6989586621679127604"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679127600"><span class="annot"><span class="annottext">toCBOR :: BiMap b a b -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127598"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127597"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">r</span></a></span></span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679127595"><span id="local-6989586621679127596"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127591"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127595"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127595"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127595"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127595"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679127589"><span class="annot"><span class="annottext">fromCBOR :: Decoder s (BiMap b a b)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Decoder s ()
forall s. Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">decodeListLenOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127587"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map a b)
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127586"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map b (Set a))
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">BiMap b a b -&gt; Decoder s (BiMap b a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map a b -&gt; Map b (Set a) -&gt; BiMap b a b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621679127583"><span id="local-6989586621679127584"><span id="local-6989586621679127585"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127581"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127583"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679127577"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BiMap v a b) -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy (BiMap v a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BiMap&quot;</span></span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679127575"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; BiMap v a b -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></span></span><span> </span><span id="local-6989586621679127573"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679127573"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127572"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127572"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127571"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127571"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; (Map a b, Map b (Set a)) -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">wNoThunks</span></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679127573"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127572"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127571"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621679127568"><span id="local-6989586621679127569"><span id="local-6989586621679127570"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>   </span><span id="local-6989586621679127565"><span class="annot"><span class="annottext">rnf :: BiMap v a b -&gt; ()
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127564"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127563"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; () -&gt; ()
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map b (Set a) -&gt; () -&gt; ()
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- ============== end Necessary Cardano.Binary instances ===================</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621679127560"><span id="local-6989586621679127561"><span id="local-6989586621679127562"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127557"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127562"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127561"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127560"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127562"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127561"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127556"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127556"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127555"><span class="annot"><span class="annottext">== :: BiMap u k v -&gt; BiMap u k v -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127554"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127554"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127556"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127554"><span class="hs-identifier hs-var">x</span></a></span></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679127551"><span id="local-6989586621679127552"><span id="local-6989586621679127553"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127546"><span id="local-6989586621679127549"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127553"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127552"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127551"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127553"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127552"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679127544"><span class="annot"><span class="annottext">show :: BiMap u k v -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127542"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127542"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127541"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127541"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127542"><span class="hs-identifier hs-var">l</span></a></span></span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679130084"><span id="local-6989586621679130085"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-type">addBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130085"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130084"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130085"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130084"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130085"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130084"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130085"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130084"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-165"></span><span id="addBack"><span class="annot"><span class="annottext">addBack :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var hs-var">addBack</span></a></span></span><span> </span><span id="local-6989586621679127539"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127539"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679127538"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127538"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127537"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127537"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k -&gt; Set k)
-&gt; v -&gt; Set k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127539"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127538"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127537"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="local-6989586621679127534"><span id="local-6989586621679127535"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-type">retract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127535"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127534"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679127535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679127534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679127535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679127534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-168"></span><span id="retract"><span class="annot"><span class="annottext">retract :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var hs-var">retract</span></a></span></span><span> </span><span id="local-6989586621679127532"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127532"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679127531"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127531"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127530"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127530"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k) -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127531"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127532"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127530"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679130077"><span id="local-6989586621679130078"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-type">insertBackwards</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130078"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130078"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130078"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130078"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-171"></span><span id="insertBackwards"><span class="annot"><span class="annottext">insertBackwards :: v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var hs-var">insertBackwards</span></a></span></span><span> </span><span id="local-6989586621679127526"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127526"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679127525"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127525"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679127524"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127524"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127523"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127523"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127525"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127524"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127526"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127524"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127523"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span id="local-6989586621679127522"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127519"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127522"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127522"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679127513"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; BiMap v k v -&gt; (v -&gt; v -&gt; v) -&gt; BiMap v k v
</span><a href="#local-6989586621679127513"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127512"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127512"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127511"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127511"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127510"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127510"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679127509"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127509"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127508"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127508"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127508"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127511"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127510"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127507"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127506"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127509"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127507"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127507"><span class="hs-identifier hs-var">oldv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127506"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127506"><span class="hs-identifier hs-var">newv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127510"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127511"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127511"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127504"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127504"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127504"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127508"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127504"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127511"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679127503"><span class="annot"><span class="annottext">removekey :: k -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127503"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679127502"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127502"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127501"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679127501"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127500"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127500"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679127499"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127499"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- equality constraint (a ~ v) from (BiMap a k v) into scope.</span><span>
</span><span id="line-177"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127502"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127500"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127498"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127498"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127502"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127500"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127498"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127502"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127499"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127501"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679127497"><span class="annot"><span class="annottext">domain :: BiMap v k v -&gt; Set k
</span><a href="#local-6989586621679127497"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127496"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127496"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679127495"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127495"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127496"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679127494"><span class="annot"><span class="annottext">range :: BiMap v k v -&gt; Set v
</span><a href="#local-6989586621679127494"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127493"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127493"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span id="local-6989586621679127492"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127492"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map v (Set k) -&gt; Set v
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127492"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679127491"><span class="annot"><span class="annottext">emptyc :: BiMap v k v
</span><a href="#local-6989586621679127491"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BiMap v k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;emptyc cannot be defined for BiMap, use the variable: biMapEmpty :: BiMap v k v&quot;</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621679130061"><span id="local-6989586621679130062"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-type">biMapEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130062"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130061"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130062"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-185"></span><span id="biMapEmpty"><span class="annot"><span class="annottext">biMapEmpty :: BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var hs-var">biMapEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Make a BiMap from a list of pairs.</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- The combine function comb=(\ earlier later -&gt; later) will let elements</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- later in the list override ones earlier in the list, and comb =</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- (\ earlier later -&gt; earlier) will keep the vaue that appears first in the list</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span id="local-6989586621679129311"><span id="local-6989586621679129312"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-type">biMapFromList</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129312"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129312"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129312"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129311"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-193"></span><span id="biMapFromList"><span class="annot"><span class="annottext">biMapFromList :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-var hs-var">biMapFromList</span></a></span></span><span> </span><span id="local-6989586621679127488"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127488"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span id="local-6989586621679127487"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127487"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; BiMap v k v -&gt; BiMap v k v)
-&gt; BiMap v k v -&gt; [(k, v)] -&gt; BiMap v k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127486"><span class="hs-identifier hs-var">addEntry</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
forall v k. BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var">biMapEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127487"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127486"><span class="annot"><span class="annottext">addEntry :: (k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127486"><span class="hs-identifier hs-var hs-var">addEntry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127485"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127484"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127484"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127483"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127483"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679127482"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127482"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127483"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127484"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127483"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127488"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127484"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127482"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127481"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127481"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127484"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127483"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127488"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127481"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127480"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127485"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127482"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>               </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127480"><span class="annot"><span class="annottext">newv :: v
</span><a href="#local-6989586621679127480"><span class="hs-identifier hs-var hs-var">newv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127488"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127481"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127484"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- This synonym makes (BiMap v k v) appear as an ordinary Binary type contructor: (Bimap k v)</span><span>
</span><span id="line-202"></span><span class="hs-keyword">type</span><span> </span><span id="Bimap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span></span><span> </span><span id="local-6989586621679127479"><span class="annot"><a href="#local-6989586621679127479"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127478"><span class="annot"><a href="#local-6989586621679127478"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127478"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127479"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127478"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- This operation is very fast (Log n) on BiMap, but extremely slow on other collections.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679128631"><span id="local-6989586621679128632"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-type">removeval</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679128632"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128632"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128632"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128631"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-206"></span><span id="removeval"><span class="annot"><span class="annottext">removeval :: v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var hs-var">removeval</span></a></span></span><span> </span><span id="local-6989586621679127476"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127476"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127475"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679127475"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127474"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127474"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679127473"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127473"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Maybe (Set k)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127476"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127473"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127472"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127472"><span class="hs-identifier hs-var">kset</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; Set k -&gt; Map k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679127471"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127471"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127470"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127470"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127471"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127470"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127474"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127472"><span class="hs-identifier hs-var">kset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127476"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127473"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set k)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127475"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- ================= Basic Set =====================</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-keyword">data</span><span> </span><span id="Sett"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span id="local-6989586621679127469"><span class="annot"><a href="#local-6989586621679127469"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127468"><span class="annot"><a href="#local-6989586621679127468"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679130055"><span id="Sett"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130055"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130055"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679127459"><span class="annot"><span class="annottext">addpair :: k -&gt; v -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679127459"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span id="local-6989586621679127458"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127458"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679127457"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127457"><span class="hs-identifier hs-var">_unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127456"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127456"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127458"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127456"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679127455"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Sett k v -&gt; (v -&gt; v -&gt; v) -&gt; Sett k v
</span><a href="#local-6989586621679127455"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127454"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127454"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127453"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127453"><span class="hs-identifier hs-var">_unit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127452"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127452"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127451"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127451"><span class="hs-identifier hs-var">_comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127454"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127452"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- We can ignore comb since there is only one function at type: () -&gt; () -&gt; ()</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679127450"><span class="annot"><span class="annottext">removekey :: k -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679127450"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679127449"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127449"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127448"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127448"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127449"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127448"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679127447"><span class="annot"><span class="annottext">domain :: Sett k v -&gt; Set k
</span><a href="#local-6989586621679127447"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127446"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127446"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127446"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679127445"><span class="annot"><span class="annottext">range :: Sett k v -&gt; Set v
</span><a href="#local-6989586621679127445"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127444"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127444"><span class="hs-identifier hs-var">_xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679127443"><span class="annot"><span class="annottext">emptyc :: Sett k v
</span><a href="#local-6989586621679127443"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Sett k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Sett Set.empty has type (Sett k ()) and it needs type (Sett k v)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621679127442"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127437"><span id="local-6989586621679127440"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127442"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127442"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>   </span><span id="local-6989586621679127436"><span class="annot"><span class="annottext">show :: Sett key () -&gt; [Char]
</span><a href="#local-6989586621679127436"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127435"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127435"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set key -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127435"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span id="local-6989586621679127430"><span id="local-6989586621679127432"><span id="local-6989586621679127434"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127434"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127434"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- Every iterable type type forms an isomorphism with some Base type. For most</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Base types the isomorphism is the identity in both directions, but for some,</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- like List and Sett, the embeddings are not the trivial identities because the</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- concrete types are not binary type constructors. The Embed class also allows</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- us to add 'newtypes' which encode some Base type to the system.</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-keyword">class</span><span> </span><span id="Embed"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679130039"><span class="annot"><a href="#local-6989586621679130039"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679130038"><span class="annot"><a href="#local-6989586621679130038"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679130039"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130038"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>  </span><span id="toBase"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#toBase"><span class="hs-identifier hs-type">toBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130039"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130038"><span class="hs-identifier hs-type">base</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="fromBase"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromBase"><span class="hs-identifier hs-type">fromBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130038"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130039"><span class="hs-identifier hs-type">concrete</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="local-6989586621679127426"><span id="local-6989586621679127427"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127427"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679127426"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127426"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>   </span><span id="local-6989586621679127422"><span class="annot"><span class="annottext">toBase :: [(k, v)] -&gt; List k v
</span><a href="#local-6989586621679127422"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127421"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127421"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127420"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127420"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679127419"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127419"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127420"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679127419"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127421"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>   </span><span id="local-6989586621679127418"><span class="annot"><span class="annottext">fromBase :: List k v -&gt; [(k, v)]
</span><a href="#local-6989586621679127418"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127417"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127417"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127417"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621679127416"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679127416"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127416"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>   </span><span id="local-6989586621679127413"><span class="annot"><span class="annottext">toBase :: Set k -&gt; Sett k ()
</span><a href="#local-6989586621679127413"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127412"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127412"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127412"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-246"></span><span>   </span><span id="local-6989586621679127411"><span class="annot"><span class="annottext">fromBase :: Sett k () -&gt; Set k
</span><a href="#local-6989586621679127411"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127410"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127410"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127410"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621679127408"><span id="local-6989586621679127409"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679127409"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127408"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679127409"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127408"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>   </span><span id="local-6989586621679127405"><span class="annot"><span class="annottext">toBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679127405"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127404"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127404"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127404"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-250"></span><span>   </span><span id="local-6989586621679127403"><span class="annot"><span class="annottext">fromBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679127403"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679127402"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127402"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127402"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621679127400"><span id="local-6989586621679127401"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127400"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127401"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127400"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127401"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>   </span><span id="local-6989586621679127397"><span class="annot"><span class="annottext">toBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127397"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127396"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127396"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127396"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-254"></span><span>   </span><span id="local-6989586621679127395"><span class="annot"><span class="annottext">fromBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127395"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679127394"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127394"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127394"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679127392"><span id="local-6989586621679127393"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127393"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127392"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127393"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127392"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>   </span><span id="local-6989586621679127389"><span class="annot"><span class="annottext">toBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679127389"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127388"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127388"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127388"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-258"></span><span>   </span><span id="local-6989586621679127387"><span class="annot"><span class="annottext">fromBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679127387"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679127386"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127386"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679127386"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Necessary when asking Boolean queries like: (&#8838;),(&#8712;),(&#8713;)</span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>   </span><span id="local-6989586621679127383"><span class="annot"><span class="annottext">toBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679127383"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679127382"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127382"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127382"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-263"></span><span>   </span><span id="local-6989586621679127381"><span class="annot"><span class="annottext">fromBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679127381"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679127380"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127380"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127380"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- ================= The Iter class =================================================</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- The Set algebra include types that encode finite maps of some type. They</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- have a finite domain, and for each domain element they pair a single range</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- element. We are interested in those finite maps that can iterate their</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- pairs in ascending domain order. The operations are: `nxt` and `lub` .</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- lub can skip over many items in sub-linear time, it can make things really fast.</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- Many finite maps can support a support lub operation in sub-linear time. Some examples:</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- Balanced binary trees, Arrays (using binary search), Tries, etc. There are basic and compound</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- Iter instances. Compound types include components with types that have Iter instances.</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">class</span><span> </span><span id="Iter"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-var">Iter</span></a></span></span><span> </span><span id="local-6989586621679130030"><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679130024"><span id="local-6989586621679130025"><span id="nxt"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-type">nxt</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130025"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130024"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130025"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130024"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130025"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130024"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679130020"><span id="local-6989586621679130021"><span id="lub"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-type">lub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130020"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130020"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130020"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- The next few methods can all be defined via nxt and lub, but for base types there often exist</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">-- much more efficent means, so the default definitions should be overwritten for such basic types.</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">-- For compound types with Guards, these are often the only way to define them.</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679130001"><span id="local-6989586621679130002"><span id="hasNxt"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-type">hasNxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130001"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130001"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130001"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679127376"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var hs-var">hasNxt</span></a></span><span> </span><span id="local-6989586621679127375"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127375"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, f a b) -&gt; Maybe (a, b, f a b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127375"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679130016"><span id="local-6989586621679130017"><span id="hasLub"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-type">hasLub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130017"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130017"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130017"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130016"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130017"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130016"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130017"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130016"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679127372"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var hs-var">hasLub</span></a></span><span> </span><span id="local-6989586621679127371"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127371"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127370"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679127370"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, f k b) -&gt; Maybe (k, b, f k b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127371"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679127370"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679130007"><span id="local-6989586621679130008"><span id="haskey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-type">haskey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130008"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130008"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130008"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130007"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679127368"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679127367"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127367"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127366"><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679127366"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key b -&gt; Maybe (key, b, f key b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127367"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679127366"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe (key, b, f key b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127365"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127365"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f key b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127367"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127365"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">}</span></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679129999"><span id="local-6989586621679130000"><span id="isnull"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-type">isnull</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130000"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679127363"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var hs-var">isnull</span></a></span><span> </span><span id="local-6989586621679127362"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127362"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v, f k v) -&gt; Bool
forall t. Collect t -&gt; Bool
</span><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier hs-var">isempty</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127362"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679129997"><span id="local-6989586621679129998"><span id="lookup"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129998"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129998"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129998"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129997"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679129997"><span class="hs-identifier hs-type">rng</span></a></span></span></span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679127359"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679127358"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127358"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127357"><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679127357"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key rng -&gt; Maybe (key, rng, f key rng)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127358"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679127357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe (key, rng, f key rng)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127356"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127356"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127355"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679127355"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f key rng
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127358"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127356"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679127355"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">}</span></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679129995"><span id="local-6989586621679129996"><span id="element"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-identifier hs-type">element</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129996"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129996"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130030"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129996"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129995"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679127353"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-identifier hs-var hs-var">element</span></a></span><span> </span><span id="local-6989586621679127352"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127352"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127351"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127351"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127352"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679127351"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- ============== Iter List ==============</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679127349"><span class="annot"><a href="#local-6989586621679127349"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127348"><span class="annot"><a href="#local-6989586621679127348"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679130211"><span id="local-6989586621679130212"><span id="UnSafeList"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130212"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130211"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130211"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-300"></span><span id="local-6989586621679127858"><span id="local-6989586621679127859"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-type">unList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127859"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127858"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127859"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127858"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-301"></span><span id="unList"><span class="annot"><span class="annottext">unList :: List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-var hs-var">unList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127346"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127346"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127346"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-302"></span><span id="local-6989586621679127340"><span id="local-6989586621679127342"><span id="local-6989586621679127344"><span id="local-6989586621679127345"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127345"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679127344"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127345"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127344"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127329"><span id="local-6989586621679127333"><span id="local-6989586621679127335"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>                      </span><span class="hs-comment">-- List is the only basic instance with non-linear nxt and lub. It also depends on</span><span>
</span><span id="line-305"></span><span>   </span><span id="local-6989586621679127327"><span class="annot"><span class="annottext">nxt :: List a b -&gt; Collect (a, b, List a b)
</span><a href="#local-6989586621679127327"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, List a b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>                 </span><span class="hs-comment">-- key-value pairs being stored in ascending order. For small Lists (10 or so elements) this is OK.</span><span>
</span><span id="line-306"></span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127325"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127325"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127324"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127324"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127323"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679127323"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Collect (a, b, List a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127325"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127324"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679127323"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>   </span><span id="local-6989586621679127321"><span class="annot"><span class="annottext">lub :: k -&gt; List k b -&gt; Collect (k, b, List k b)
</span><a href="#local-6989586621679127321"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679127320"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127320"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127319"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679127319"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((k, b) -&gt; Bool) -&gt; [(k, b)] -&gt; [(k, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127317"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127317"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127316"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127316"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127317"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127320"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679127319"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, List k b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-309"></span><span>                       </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127314"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127314"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127313"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127313"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127312"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679127312"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, List k b) -&gt; Collect (k, b, List k b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127314"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127313"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(k, b)] -&gt; List k b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679127312"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>   </span><span id="local-6989586621679127311"><span class="annot"><span class="annottext">isnull :: List k v -&gt; Bool
</span><a href="#local-6989586621679127311"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127310"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127310"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127310"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-311"></span><span>   </span><span id="local-6989586621679127308"><span class="annot"><span class="annottext">lookup :: key -&gt; List key rng -&gt; Maybe rng
</span><a href="#local-6989586621679127308"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679127307"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127307"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127306"><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679127306"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; [(key, rng)] -&gt; Maybe rng
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">List.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127307"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679127306"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-312"></span><span>   </span><span id="local-6989586621679127305"><span class="annot"><span class="annottext">hasNxt :: List a b -&gt; Maybe (a, b, List a b)
</span><a href="#local-6989586621679127305"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasNxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, List a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-313"></span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127304"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127304"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127303"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127303"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679127302"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679127302"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Maybe (a, b, List a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127304"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127303"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679127302"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span id="local-6989586621679127300"><span id="local-6989586621679127301"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127295"><span id="local-6989586621679127298"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127301"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127300"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127301"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127300"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>   </span><span id="local-6989586621679127294"><span class="annot"><span class="annottext">show :: List k v -&gt; [Char]
</span><a href="#local-6989586621679127294"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679127293"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127293"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127293"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- =============== Iter Single ==================</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127282"><span id="local-6989586621679127287"><span id="local-6989586621679127289"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679127281"><span class="annot"><span class="annottext">nxt :: Single a b -&gt; Collect (a, b, Single a b)
</span><a href="#local-6989586621679127281"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127280"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127280"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127279"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127279"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127277"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127277"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127276"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127276"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127276"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127280"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127279"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single a b
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127277"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127275"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127275"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127274"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127274"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127273"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127273"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127273"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127275"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single a ()
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127274"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Single a b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127272"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127272"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127271"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127271"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127272"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621679127270"><span class="annot"><span class="annottext">lub :: k -&gt; Single k b -&gt; Collect (k, b, Single k b)
</span><a href="#local-6989586621679127270"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679127269"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127269"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127268"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127268"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127267"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127267"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127266"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127266"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127265"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127265"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127268"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127269"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127265"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127268"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single k b
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127266"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127266"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679127263"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127263"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127262"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127262"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127261"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127261"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127260"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127262"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127263"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127260"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127262"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single k ()
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127261"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127261"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679127259"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127259"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127258"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127258"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127257"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127257"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127258"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679127256"><span class="annot"><span class="annottext">haskey :: key -&gt; Single key b -&gt; Bool
</span><a href="#local-6989586621679127256"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679127255"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127255"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127254"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127254"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127255"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127254"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679127253"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127253"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127252"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127252"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127251"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127251"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127253"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127252"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679127250"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127250"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679127249"><span class="annot"><span class="annottext">isnull :: Single k v -&gt; Bool
</span><a href="#local-6989586621679127249"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679127248"><span class="annot"><span class="annottext">lookup :: key -&gt; Single key rng -&gt; Maybe rng
</span><a href="#local-6989586621679127248"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679127247"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127247"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127246"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127246"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127247"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127246"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679127245"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127245"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127244"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127244"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679127243"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679127243"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127245"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127244"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679127243"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679127242"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127242"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key rng
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679127240"><span id="local-6989586621679127241"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127235"><span id="local-6989586621679127238"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127241"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679127240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127241"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679127234"><span class="annot"><span class="annottext">show :: Single k v -&gt; [Char]
</span><a href="#local-6989586621679127234"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679127233"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127233"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127232"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127232"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(Single &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127233"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127232"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679127231"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127231"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(SetSingle &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127231"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Fail&quot;</span></span></span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- ============= Iter Sett ===============</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127220"><span id="local-6989586621679127225"><span id="local-6989586621679127227"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679127219"><span class="annot"><span class="annottext">nxt :: Sett a b -&gt; Collect (a, b, Sett a b)
</span><a href="#local-6989586621679127219"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127218"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679127218"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Sett a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Sett a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127217"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127217"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127216"><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127216"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679127218"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127217"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127214"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127214"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127213"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679127213"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; (a, Set a)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679127218"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127216"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127214"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set a -&gt; Sett a ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679127213"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127217"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679127211"><span class="annot"><span class="annottext">lub :: k -&gt; Sett k b -&gt; Collect (k, b, Sett k b)
</span><a href="#local-6989586621679127211"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679127210"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127210"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127209"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127209"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Sett k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Sett k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127208"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127208"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127207"><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127207"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127209"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-347"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127208"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-348"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127210"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127209"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-349"></span><span>                                     </span><span class="hs-special">(</span><span id="local-6989586621679127205"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127205"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span id="local-6989586621679127204"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127204"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127207"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127210"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127204"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127208"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-350"></span><span>                                     </span><span class="hs-special">(</span><span id="local-6989586621679127203"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127203"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span id="local-6989586621679127202"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127202"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127202"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-351"></span><span>                                                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127208"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-352"></span><span>                                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127201"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127201"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127200"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127200"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; (k, Set k)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127202"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127207"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127201"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span>  </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127200"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127208"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679127199"><span class="annot"><span class="annottext">haskey :: key -&gt; Sett key b -&gt; Bool
</span><a href="#local-6989586621679127199"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679127198"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127198"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127197"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127197"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127198"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127197"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621679127195"><span class="annot"><span class="annottext">isnull :: Sett k v -&gt; Bool
</span><a href="#local-6989586621679127195"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127194"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127194"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127194"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679127193"><span class="annot"><span class="annottext">lookup :: key -&gt; Sett key rng -&gt; Maybe rng
</span><a href="#local-6989586621679127193"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679127192"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127192"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679127191"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127191"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127192"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679127191"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- ================== Iter Map ===============</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127180"><span id="local-6989586621679127185"><span id="local-6989586621679127187"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621679127179"><span class="annot"><span class="annottext">nxt :: Map a b -&gt; Collect (a, b, Map a b)
</span><a href="#local-6989586621679127179"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679127178"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127178"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Map a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Map a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127177"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127177"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127176"><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-362"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127178"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127177"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127174"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127174"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127173"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127173"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679127172"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127172"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127174"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127173"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127172"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127177"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679127171"><span class="annot"><span class="annottext">lub :: k -&gt; Map k b -&gt; Collect (k, b, Map k b)
</span><a href="#local-6989586621679127171"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679127170"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127170"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679127169"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127169"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Map k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Map k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127168"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127168"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127167"><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127167"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-366"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127170"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127169"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>                  </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-367"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679127165"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127165"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127164"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127164"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127163"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127163"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127167"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127170"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127164"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127163"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127168"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-368"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679127162"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127162"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127168"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-369"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679127160"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127160"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span id="local-6989586621679127159"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127159"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127167"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127158"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127157"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127156"><span class="hs-identifier hs-var">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127168"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-370"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127158"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127158"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127157"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127157"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679127156"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127156"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127159"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679127154"><span class="annot"><span class="annottext">haskey :: key -&gt; Map key b -&gt; Bool
</span><a href="#local-6989586621679127154"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679127153"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679127152"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679127152"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Maybe b
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679127153"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679127152"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621679127151"><span class="annot"><span class="annottext">isnull :: Map k v -&gt; Bool
</span><a href="#local-6989586621679127151"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679127149"><span class="annot"><span class="annottext">lookup :: key -&gt; Map key rng -&gt; Maybe rng
</span><a href="#local-6989586621679127149"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- ===========================================================</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- Some times we need to write our own version of functions</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- over  Map.Map that do not appear in the library</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- For example</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- 1) version of Map.withoutKeys where both parts are Map.Map</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- 2) Comparing that two maps have exactly the same set of keys</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- 3) The intersection of two maps guarded by a predicate.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--    ((dom stkcred) &#9665; deleg) &#9655; (dom stpool))   ==&gt;</span><span>
</span><span id="line-384"></span><span class="hs-comment">--    intersectDomP (\ k v -&gt; Map.member v stpool) stkcred deleg</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- ============================================================</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621679129888"><span id="local-6989586621679129889"><span id="local-6989586621679129890"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-type">noKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129889"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129888"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129889"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-388"></span><span id="noKeys"><span class="annot"><span class="annottext">noKeys :: Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var hs-var">noKeys</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span id="local-6989586621679127147"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127147"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127147"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span id="local-6989586621679127146"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127146"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127144"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127144"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127143"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127143"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679127142"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127142"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; (Map k a, Map k a)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Map k a)
</span><span class="hs-identifier hs-var">Map.split</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127144"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127146"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679127140"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127140"><span class="hs-identifier hs-var">lm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127139"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127139"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k a -&gt; Map k a
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127138"><span class="hs-identifier hs-var">lm'</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127137"><span class="hs-identifier hs-var">rm'</span></a></span><span>     </span><span class="hs-comment">-- We know `k` is not in either `lm` or `rm`</span><span>
</span><span id="line-392"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127138"><span class="annot"><span class="annottext">lm' :: Map k a
</span><a href="#local-6989586621679127138"><span class="hs-identifier hs-var hs-var">lm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k b -&gt; Map k a
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127140"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127143"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-393"></span><span>           </span><span class="hs-glyph">!</span><span id="local-6989586621679127137"><span class="annot"><span class="annottext">rm' :: Map k a
</span><a href="#local-6989586621679127137"><span class="hs-identifier hs-var hs-var">rm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k b -&gt; Map k a
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127139"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127142"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-394"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-pragma hs-type">noKeys</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- This version benchmarks better than the following three versions, by almost a factor of 4, at Trees with 100 to 100,000 pairs</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- keysEqual2 x y = Map.foldrWithKey' (\ k v ans -&gt; k:ans) [] x == Map.foldrWithKey' (\ k v ans -&gt; k:ans) [] y</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- keysEqual3 x y = Map.keysSet x == Map.keysSet y</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- keysEqual4 x y = Map.keys x == Map.keys y</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- This is a type specific version of sameDomain</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621679129880"><span id="local-6989586621679129881"><span id="local-6989586621679129882"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-type">keysEqual</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129882"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129882"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129881"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129882"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129880"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-404"></span><span id="keysEqual"><span class="annot"><span class="annottext">keysEqual :: Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var hs-var">keysEqual</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span id="local-6989586621679127135"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127135"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127134"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127134"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127133"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127133"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679127132"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127132"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-408"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v1 -&gt; (Map k v1, Bool, Map k v1)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var">splitMember</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127134"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127135"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679127130"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127130"><span class="hs-identifier hs-var">lm</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span id="local-6989586621679127129"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127129"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v1 -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127133"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127130"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v1 -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127132"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127129"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><span class="annottext">(Map k v1, Bool, Map k v1)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- cost O(min (size m) (size n) * log(max (size m) (size n))), BUT the constants are high, too slow except for small maps.</span><span>
</span><span id="line-413"></span><span id="local-6989586621679129065"><span id="local-6989586621679129066"><span id="local-6989586621679129067"><span id="local-6989586621679129068"><span id="local-6989586621679129069"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-type">sameDomain</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129069"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129068"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129067"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679129068"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129069"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129066"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129067"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129069"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129065"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-414"></span><span id="sameDomain"><span class="annot"><span class="annottext">sameDomain :: f k b -&gt; g k c -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-var hs-var">sameDomain</span></a></span></span><span> </span><span id="local-6989586621679127126"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679127126"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679127125"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679127125"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (k, b, f k b) -&gt; Maybe (k, c, g k c) -&gt; Bool
forall a (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord a, Iter f, Iter f) =&gt;
Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679127124"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k b -&gt; Maybe (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679127126"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g k c -&gt; Maybe (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679127125"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127124"><span class="annot"><span class="annottext">loop :: Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679127124"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679127123"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127123"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679127122"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127122"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679127121"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127121"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679127120"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127120"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127123"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127121"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-417"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679127124"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Maybe (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127122"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Maybe (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679127120"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-419"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><a href="#local-6989586621679127124"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><a href="#local-6989586621679127124"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | A variant of 'splitLookup' that indicates only whether the</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- key was present, rather than producing its value. This is used to</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- implement 'keysEqual' to avoid allocating unnecessary 'Just'</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-427"></span><span id="local-6989586621679129883"><span id="local-6989586621679129884"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-type">splitMember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-428"></span><span id="splitMember"><span class="annot"><span class="annottext">splitMember :: k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var hs-var">splitMember</span></a></span></span><span> </span><span id="local-6989586621679127119"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127119"><span class="hs-identifier hs-var">k0</span></a></span></span><span> </span><span id="local-6989586621679127118"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127118"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679127117"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127119"><span class="hs-identifier hs-var">k0</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127118"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>     </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679127115"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127115"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127114"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127114"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679127113"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127113"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127115"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127114"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127113"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679129865"><span id="local-6989586621679129866"><span class="annot"><a href="#local-6989586621679127117"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129865"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129865"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129865"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621679127117"><span class="annot"><span class="annottext">go :: k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679127117"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127112"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127112"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127111"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127111"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127111"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><span class="annottext">Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127110"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127110"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679127109"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127109"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679127108"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127108"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127107"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127107"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127112"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127110"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-436"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679127106"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127106"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span id="local-6989586621679127105"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127105"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679127104"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127104"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679127117"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127112"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127108"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-437"></span><span>                    </span><span class="hs-glyph">!</span><span id="local-6989586621679127103"><span class="annot"><span class="annottext">gt' :: Map k a
</span><a href="#local-6989586621679127103"><span class="hs-identifier hs-var hs-var">gt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127110"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127109"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127104"><span class="hs-identifier hs-var">gt</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127107"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-438"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127106"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127105"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127103"><span class="hs-identifier hs-var">gt'</span></a></span><span>
</span><span id="line-439"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679127102"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127102"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span id="local-6989586621679127101"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127101"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679127100"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127100"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679127117"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127112"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127107"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-440"></span><span>                    </span><span class="hs-glyph">!</span><span id="local-6989586621679127099"><span class="annot"><span class="annottext">lt' :: Map k a
</span><a href="#local-6989586621679127099"><span class="hs-identifier hs-var hs-var">lt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127110"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127109"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127108"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127102"><span class="hs-identifier hs-var">lt</span></a></span><span>
</span><span id="line-441"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127099"><span class="hs-identifier hs-var">lt'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127101"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127100"><span class="hs-identifier hs-var">gt</span></a></span><span>
</span><span id="line-442"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127108"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679127107"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-pragma hs-type">splitMember</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-keyword">data</span><span> </span><span id="StrictTriple"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span></span><span> </span><span id="local-6989586621679129862"><span class="annot"><a href="#local-6989586621679129862"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679129861"><span class="annot"><a href="#local-6989586621679129861"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679129860"><span class="annot"><a href="#local-6989586621679129860"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StrictTriple"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679129862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679129861"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679129860"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | intersetDomP p m1 m2 == Keep the key and value from m2, iff (the key is in the dom of m1) &amp;&amp; ((p key value) is true)</span><span>
</span><span id="line-449"></span><span id="local-6989586621679129852"><span id="local-6989586621679129853"><span id="local-6989586621679129854"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-type">intersectDomP</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129854"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129854"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129853"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129854"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129852"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129854"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129853"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129854"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129853"><span class="hs-identifier hs-type">v2</span></a></span></span></span></span><span>
</span><span id="line-450"></span><span id="intersectDomP"><span class="annot"><span class="annottext">intersectDomP :: (k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var hs-var">intersectDomP</span></a></span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v2
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-451"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v2
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span id="local-6989586621679127097"><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679127096"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127096"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127095"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127095"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127094"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679127094"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679127093"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127093"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679127092"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127092"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-453"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127091"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127095"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679127094"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Map k v2 -&gt; Map k v2 -&gt; Map k v2
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127095"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679127094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127090"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127089"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v2 -&gt; Map k v2
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127090"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127089"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679127088"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127088"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127091"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127091"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127087"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v1 -&gt; (Map k v1, Bool, Map k v1)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var">splitMember</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127095"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127096"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127090"><span class="annot"><span class="annottext">l1l2 :: Map k v2
</span><a href="#local-6989586621679127090"><span class="hs-identifier hs-var hs-var">l1l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127088"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127093"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127089"><span class="annot"><span class="annottext">r1r2 :: Map k v2
</span><a href="#local-6989586621679127089"><span class="hs-identifier hs-var hs-var">r1r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127087"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127092"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-460"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-pragma hs-type">intersectDomP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- |- Similar to intersectDomP, except the Map returned has the same key as the first input map, rather than the second input map.</span><span>
</span><span id="line-466"></span><span id="local-6989586621679129846"><span id="local-6989586621679129847"><span id="local-6989586621679129848"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-type">intersectDomPLeft</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129847"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129846"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129847"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129846"><span class="hs-identifier hs-type">v1</span></a></span></span></span></span><span>
</span><span id="line-467"></span><span id="intersectDomPLeft"><span class="annot"><span class="annottext">intersectDomPLeft :: (k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var hs-var">intersectDomPLeft</span></a></span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v1
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v1
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-469"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span id="local-6989586621679127085"><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127084"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127083"><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679127083"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679127082"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127082"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679127081"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127081"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127080"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127080"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679127079"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-471"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679127078"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679127078"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679127078"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v1 -&gt; Map k v1 -&gt; Map k v1 -&gt; Map k v1
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679127083"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127077"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127076"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-472"></span><span>      </span><span id="local-6989586621679127075"><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679127075"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v1 -&gt; Map k v1 -&gt; Map k v1
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127077"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127076"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679127074"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127074"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127079"><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679127079"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127073"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127073"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v2 -&gt; (Map k v2, Maybe v2, Map k v2)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127084"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127080"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127077"><span class="annot"><span class="annottext">l1l2 :: Map k v1
</span><a href="#local-6989586621679127077"><span class="hs-identifier hs-var hs-var">l1l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127082"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127074"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679127076"><span class="annot"><span class="annottext">r1r2 :: Map k v1
</span><a href="#local-6989586621679127076"><span class="hs-identifier hs-var hs-var">r1r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679127085"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679127081"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679127073"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-477"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-pragma hs-type">intersectDomPLeft</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- |- fold over the intersection of a Map and a Set</span><span>
</span><span id="line-480"></span><span id="local-6989586621679129840"><span id="local-6989586621679129841"><span id="local-6989586621679129842"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-type">intersectMapSetFold</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129842"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129842"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129841"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129842"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129841"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679129842"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">ans</span></a></span></span></span></span><span>
</span><span id="line-481"></span><span id="intersectMapSetFold"><span class="annot"><span class="annottext">intersectMapSetFold :: (k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var hs-var">intersectMapSetFold</span></a></span></span><span> </span><span id="local-6989586621679127071"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127071"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127070"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127070"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127070"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span id="local-6989586621679127069"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127069"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127068"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127068"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127067"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127067"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127068"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127067"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span id="local-6989586621679127066"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127065"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127065"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127064"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127064"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679127063"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127063"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679127062"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127062"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127061"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127061"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127060"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127060"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127063"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127059"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127058"><span class="hs-identifier hs-var">addKV</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127065"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127064"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127062"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127057"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127060"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127059"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127059"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127056"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127056"><span class="hs-identifier hs-var">found</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127057"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127057"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127065"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127061"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-486"></span><span>        </span><span id="local-6989586621679127058"><span class="annot"><span class="annottext">addKV :: k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127058"><span class="hs-identifier hs-var hs-var">addKV</span></a></span></span><span> </span><span id="local-6989586621679127055"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127055"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679127054"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127054"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127053"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127053"><span class="hs-identifier hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127056"><span class="hs-identifier hs-var">found</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127066"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127055"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127054"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127053"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127053"><span class="hs-identifier hs-var">ans1</span></a></span><span>
</span><span id="line-487"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-pragma hs-type">intersectMapSetFold</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | Fold with 'accum' all those pairs in the map, not appearing in the set.</span><span>
</span><span id="line-490"></span><span id="local-6989586621679127050"><span id="local-6989586621679127051"><span id="local-6989586621679127052"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-type">disjointMapSetFold</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127052"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127052"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127051"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127050"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127050"><span class="hs-identifier hs-type">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679127052"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127051"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679127052"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127050"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127050"><span class="hs-identifier hs-type">ans</span></a></span></span></span></span><span>
</span><span id="line-491"></span><span id="disjointMapSetFold"><span class="annot"><span class="annottext">disjointMapSetFold :: (k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var hs-var">disjointMapSetFold</span></a></span></span><span> </span><span id="local-6989586621679127048"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127048"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127047"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127047"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127047"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span id="local-6989586621679127046"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127046"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679127045"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127045"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679127044"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127044"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127043"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127043"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127044"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; ans -&gt; Map k v -&gt; ans
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey'</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127046"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127043"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127045"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span id="local-6989586621679127041"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127041"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679127040"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127040"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127039"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127039"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679127038"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127038"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679127037"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127037"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127036"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127036"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127035"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127035"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127041"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127038"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127034"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127033"><span class="hs-identifier hs-var">addKV</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127040"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127039"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127041"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127037"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127032"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127035"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127034"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127034"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127031"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127031"><span class="hs-identifier hs-var">found</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127032"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127032"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127040"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127036"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span id="local-6989586621679127033"><span class="annot"><span class="annottext">addKV :: k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127033"><span class="hs-identifier hs-var hs-var">addKV</span></a></span></span><span> </span><span id="local-6989586621679127030"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127030"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679127029"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127029"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679127028"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127028"><span class="hs-identifier hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127031"><span class="hs-identifier hs-var">found</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127041"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127030"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127029"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127028"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127028"><span class="hs-identifier hs-var">ans1</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- ============== Iter BiMap ====================</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621679127026"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127015"><span id="local-6989586621679127020"><span id="local-6989586621679127022"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127026"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127026"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679127014"><span class="annot"><span class="annottext">nxt :: BiMap v a b -&gt; Collect (a, b, BiMap v a b)
</span><a href="#local-6989586621679127014"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127013"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127013"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679127012"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127012"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, BiMap v a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, BiMap v a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127011"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127011"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127010"><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127010"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-502"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127013"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127011"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-504"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127009"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127009"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127008"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127008"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679127007"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127007"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127010"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679127009"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679127008"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127007"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127012"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127011"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621679127006"><span class="annot"><span class="annottext">lub :: k -&gt; BiMap v k b -&gt; Collect (k, b, BiMap v k b)
</span><a href="#local-6989586621679127006"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679127005"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127005"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127004"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127004"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679127003"><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679127003"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, BiMap v k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, BiMap v k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679127002"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127002"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679127001"><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127001"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-506"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127005"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127004"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span>           </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-507"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679127000"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679127000"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679126999"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126999"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126998"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126998"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127005"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126999"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126998"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679127003"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127002"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-508"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679126997"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126997"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127002"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-509"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679126996"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126996"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span id="local-6989586621679126995"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126995"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679127001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126994"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126993"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126992"><span class="hs-identifier hs-var">m3</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679127003"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679127002"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-510"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679126994"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126994"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126993"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126993"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679126992"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126992"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679126995"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679126991"><span class="annot"><span class="annottext">isnull :: BiMap v k v -&gt; Bool
</span><a href="#local-6989586621679126991"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679126990"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126990"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126989"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679126989"><span class="hs-identifier hs-var">_g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126990"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621679126988"><span class="annot"><span class="annottext">lookup :: key -&gt; BiMap v key rng -&gt; Maybe rng
</span><a href="#local-6989586621679126988"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679126987"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679126987"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679126986"><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679126986"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679126985"><span class="annot"><span class="annottext">Map rng (Set key)
</span><a href="#local-6989586621679126985"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679126987"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679126986"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span id="local-6989586621679126984"><span class="annot"><span class="annottext">haskey :: key -&gt; BiMap v key b -&gt; Bool
</span><a href="#local-6989586621679126984"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679126983"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679126983"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679126982"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679126982"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679126981"><span class="annot"><span class="annottext">Map b (Set key)
</span><a href="#local-6989586621679126981"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679126983"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679126982"><span class="hs-identifier hs-var">left</span></a></span></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- BaseRep witnesses Basic types. I.e. those types that are instances of both Basic and Iter.</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- It is used in constructors 'Base' and 'BaseD' and functions 'materialize' and 'fromList'</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-keyword">data</span><span> </span><span id="BaseRep"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-var">BaseRep</span></a></span></span><span> </span><span id="local-6989586621679126980"><span class="annot"><a href="#local-6989586621679126980"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679126979"><span class="annot"><a href="#local-6989586621679126979"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679126978"><span class="annot"><a href="#local-6989586621679126978"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-522"></span><span>   </span><span id="local-6989586621679129755"><span id="local-6989586621679129756"><span id="MapR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span></span><span class="hs-glyph">::</span><span>    </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129756"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129755"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-523"></span><span>   </span><span id="local-6989586621679129753"><span id="SetR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span></span><span class="hs-glyph">::</span><span>    </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129753"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-524"></span><span>   </span><span id="local-6989586621679129749"><span id="local-6989586621679129750"><span id="ListR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span></span><span class="hs-glyph">::</span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129750"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129749"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-525"></span><span>   </span><span id="local-6989586621679129745"><span id="local-6989586621679129746"><span id="SingleR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129746"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129745"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-526"></span><span>   </span><span id="local-6989586621679129740"><span id="local-6989586621679129741"><span id="BiMapR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129741"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129741"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129741"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129740"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129741"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-comment">-- ==========================================================================</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- The most basic operation of iteration, where (Iter f) is to use the 'nxt'</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- operator on (f k v) to create a (Collect k v). The two possible</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- ways to produce their elements are in LIFO or FIFO order.</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span id="local-6989586621679129811"><span id="local-6989586621679129812"><span id="local-6989586621679129813"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-type">lifo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129813"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129813"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129812"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129811"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129812"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129811"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-536"></span><span id="lifo"><span class="annot"><span class="annottext">lifo :: f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var hs-var">lifo</span></a></span></span><span> </span><span id="local-6989586621679126971"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126971"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126970"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126970"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126969"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126969"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126968"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126968"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126971"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126970"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126969"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126968"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span id="local-6989586621679126964"><span id="local-6989586621679126965"><span id="local-6989586621679126966"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-type">fifo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126966"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126966"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126965"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126964"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126965"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126964"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-539"></span><span id="fifo"><span class="annot"><span class="annottext">fifo :: f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var hs-var">fifo</span></a></span></span><span> </span><span id="local-6989586621679126962"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126962"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126961"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126961"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126960"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126960"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126959"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126959"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126962"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Collect (k, v) -&gt; (k, v) -&gt; Collect (k, v)
forall t. Collect t -&gt; t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#rear"><span class="hs-identifier hs-var">rear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126959"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126961"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126960"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">-- ================================================================================================</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- | The self typed GADT: Exp, that encodes the shape of Set expressions. A deep embedding.</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- Exp is a typed Symbolic representation of queries we may ask. It allows us to introspect a query</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- The strategy is to</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- 1) Define Exp so all queries can be represented.</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- 2) Define smart constructors that &quot;parse&quot; the surface syntax, and build a typed Exp</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- 3) Write an evaluate function:  eval:: Exp t -&gt; t</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- 4) &quot;eval&quot; can introspect the code and apply efficient domain and type specific translations</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- 5) Use the (Iter f) class to evaluate some Exp that can benefit from its efficient nature.</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-keyword">data</span><span> </span><span id="Exp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span></span><span> </span><span id="local-6989586621679126957"><span class="annot"><a href="#local-6989586621679126957"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>   </span><span id="local-6989586621679126954"><span id="local-6989586621679126955"><span id="local-6989586621679126956"><span id="Base"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126956"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126955"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126955"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126956"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126954"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126955"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126956"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126954"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126955"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126956"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126954"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- Note the use of BaseRep to witness what Base type.</span><span>
</span><span id="line-555"></span><span>   </span><span id="local-6989586621679126950"><span id="local-6989586621679126951"><span id="local-6989586621679126952"><span id="Dom"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126952"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126951"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126952"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126950"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126952"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-556"></span><span>   </span><span id="local-6989586621679126946"><span id="local-6989586621679126947"><span id="local-6989586621679126948"><span id="Rng"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-var">Rng</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126948"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126947"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126946"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126948"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126947"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-557"></span><span>   </span><span id="local-6989586621679126941"><span id="local-6989586621679126942"><span id="local-6989586621679126943"><span id="local-6989586621679126944"><span id="DRestrict"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126944"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126943"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126943"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126944"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126942"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126944"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126941"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126942"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126944"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126941"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-558"></span><span>   </span><span id="local-6989586621679126936"><span id="local-6989586621679126937"><span id="local-6989586621679126938"><span id="local-6989586621679126939"><span id="DExclude"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126939"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126938"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126938"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126939"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126937"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126939"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126936"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126937"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126939"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126936"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-559"></span><span>   </span><span id="local-6989586621679126931"><span id="local-6989586621679126932"><span id="local-6989586621679126933"><span id="local-6989586621679126934"><span id="RRestrict"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126934"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126933"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126932"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126931"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126934"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126932"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126933"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126932"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126931"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126934"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126932"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-560"></span><span>   </span><span id="local-6989586621679126926"><span id="local-6989586621679126927"><span id="local-6989586621679126928"><span id="local-6989586621679126929"><span id="RExclude"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126929"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126928"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126927"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126926"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126929"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126927"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126928"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126927"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126926"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126929"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126927"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-561"></span><span>   </span><span id="local-6989586621679126923"><span id="local-6989586621679126924"><span id="Elem"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126924"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126923"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679126924"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126924"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126923"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126924"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-562"></span><span>   </span><span id="local-6989586621679126920"><span id="local-6989586621679126921"><span id="NotElem"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-var">NotElem</span></a></span></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126921"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126920"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679126921"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126921"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126920"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126921"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-563"></span><span>   </span><span id="local-6989586621679126914"><span id="local-6989586621679126915"><span id="local-6989586621679126916"><span id="local-6989586621679126917"><span id="local-6989586621679126918"><span id="Intersect"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-var">Intersect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126918"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126917"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126916"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126917"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126918"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126915"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126916"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126918"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126914"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126918"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-564"></span><span>   </span><span id="local-6989586621679126908"><span id="local-6989586621679126909"><span id="local-6989586621679126910"><span id="local-6989586621679126911"><span id="local-6989586621679126912"><span id="Subset"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-var">Subset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126912"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126911"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126910"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126911"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126912"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126909"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126910"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126912"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126908"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-565"></span><span>   </span><span id="local-6989586621679126903"><span id="local-6989586621679126904"><span id="local-6989586621679126905"><span id="local-6989586621679126906"><span id="UnionOverrideLeft"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-var">UnionOverrideLeft</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679126906"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679126905"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126906"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126904"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126905"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126903"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126905"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126904"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126905"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-comment">-- The (Show k, Show v) supports logging errors if there are duplicate keys.</span><span>
</span><span id="line-567"></span><span>   </span><span id="local-6989586621679126899"><span id="local-6989586621679126900"><span id="local-6989586621679126901"><span id="UnionPlus"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-var">UnionPlus</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126901"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679126900"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126899"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126901"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126900"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126899"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126901"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126900"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126899"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126901"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126900"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-568"></span><span>   </span><span id="local-6989586621679126894"><span id="local-6989586621679126895"><span id="local-6989586621679126896"><span id="local-6989586621679126897"><span id="UnionOverrideRight"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-var">UnionOverrideRight</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126897"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126896"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126897"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126895"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126894"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126897"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126895"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126896"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126897"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126895"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-569"></span><span>   </span><span id="local-6989586621679126891"><span id="local-6989586621679126892"><span id="Singleton"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126892"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126892"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126891"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126892"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126891"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-570"></span><span>   </span><span id="local-6989586621679126889"><span id="SetSingleton"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126889"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126889"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126889"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-571"></span><span>   </span><span id="local-6989586621679126883"><span id="local-6989586621679126884"><span id="local-6989586621679126885"><span id="local-6989586621679126886"><span id="local-6989586621679126887"><span id="KeyEqual"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-var">KeyEqual</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126887"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126886"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126885"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126886"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126887"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126884"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126885"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126887"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126883"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- deriving instance NFData t =&gt; NFData(Exp t)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- =======================================================================================================</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- When we build an Exp, we want to make sure all Sets with one element become (SetSingleton x)</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- so we use these 'smart' constructors.</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span id="local-6989586621679126878"><span id="local-6989586621679126879"><span id="local-6989586621679126880"><span id="local-6989586621679126881"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-type">dRestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126881"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126880"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126880"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126881"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126879"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126881"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126878"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126879"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126881"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126878"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-581"></span><span id="dRestrict"><span class="annot"><span class="annottext">dRestrict :: Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var hs-var">dRestrict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126876"><span class="annot"><a href="#local-6989586621679126876"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126875"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126875"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126876"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Single k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126876"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
Exp (f k v)
</span><a href="#local-6989586621679126875"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-582"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var">dRestrict</span></a></span><span> </span><span id="local-6989586621679126872"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126872"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126871"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126871"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126872"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126871"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span id="local-6989586621679126867"><span id="local-6989586621679126868"><span id="local-6989586621679126869"><span id="local-6989586621679126870"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-type">rRestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126870"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126869"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126868"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126870"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126868"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126869"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126868"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126870"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126868"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-585"></span><span id="rRestrict"><span class="annot"><span class="annottext">rRestrict :: Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var hs-var">rRestrict</span></a></span></span><span> </span><span id="local-6989586621679126865"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126865"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126864"><span class="annot"><a href="#local-6989586621679126864"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126864"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Single v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126865"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126864"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var">rRestrict</span></a></span><span> </span><span id="local-6989586621679126863"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126863"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679126862"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126863"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126862"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span id="local-6989586621679126858"><span id="local-6989586621679126859"><span id="local-6989586621679126860"><span id="local-6989586621679126861"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-type">dExclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126861"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126860"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126860"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126859"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126858"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126859"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126858"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-589"></span><span id="dExclude"><span class="annot"><span class="annottext">dExclude :: Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var hs-var">dExclude</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126856"><span class="annot"><a href="#local-6989586621679126856"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126855"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126855"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Single k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126856"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
Exp (f k v)
</span><a href="#local-6989586621679126855"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-590"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var">dExclude</span></a></span><span> </span><span id="local-6989586621679126854"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126854"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126853"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126853"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126854"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126853"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span id="local-6989586621679126849"><span id="local-6989586621679126850"><span id="local-6989586621679126851"><span id="local-6989586621679126852"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-type">rExclude</span></a></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126852"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126851"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126850"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126849"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126852"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126850"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126851"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126850"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126849"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126852"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126850"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-593"></span><span id="rExclude"><span class="annot"><span class="annottext">rExclude :: Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var hs-var">rExclude</span></a></span></span><span> </span><span id="local-6989586621679126847"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126847"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126846"><span class="annot"><a href="#local-6989586621679126846"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126846"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Single v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126847"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126846"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var">rExclude</span></a></span><span> </span><span id="local-6989586621679126845"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126845"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679126844"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126844"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126845"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126844"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- =================================================================</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- | Basic types are those that can be embedded into Exp.</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- The HasExp class, encodes how to lift a Basic type into an Exp.</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- The function 'toExp' will build a typed Exp for that Basic type.</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- This will be really usefull in the smart constructors.</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-keyword">class</span><span> </span><span id="HasExp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-var">HasExp</span></a></span></span><span> </span><span id="local-6989586621679129763"><span class="annot"><a href="#local-6989586621679129763"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679129762"><span class="annot"><a href="#local-6989586621679129762"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679129763"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129762"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>  </span><span id="toExp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-type">toExp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679129763"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129762"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- | The simplest Base type is one that is already an Exp</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span id="local-6989586621679126842"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126842"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126842"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621679126839"><span class="annot"><span class="annottext">toExp :: Exp t -&gt; Exp t
</span><a href="#local-6989586621679126839"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126838"><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679126838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679126838"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span id="local-6989586621679126836"><span id="local-6989586621679126837"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126837"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679126837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126836"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679126837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126836"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>  </span><span id="local-6989586621679126834"><span class="annot"><span class="annottext">toExp :: Map k v -&gt; Exp (Map k v)
</span><a href="#local-6989586621679126834"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126833"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126833"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v -&gt; Map k v -&gt; Exp (Map k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v
forall k v. Basic Map =&gt; BaseRep Map k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126833"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="local-6989586621679126832"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126832"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679126832"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126832"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-615"></span><span>  </span><span id="local-6989586621679126830"><span class="annot"><span class="annottext">toExp :: Set k -&gt; Exp (Sett k ())
</span><a href="#local-6989586621679126830"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126829"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126829"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126829"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span id="local-6989586621679126827"><span id="local-6989586621679126828"><span class="hs-keyword">instance</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126828"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126828"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126828"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-619"></span><span>  </span><span id="local-6989586621679126825"><span class="annot"><span class="annottext">toExp :: [(k, v)] -&gt; Exp (List k v)
</span><a href="#local-6989586621679126825"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126824"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126824"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; List k v -&gt; Exp (List k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126823"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679126823"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126822"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679126822"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679126823"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679126822"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126824"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span id="local-6989586621679126820"><span id="local-6989586621679126821"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126820"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126820"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-622"></span><span>  </span><span id="local-6989586621679126818"><span class="annot"><span class="annottext">toExp :: Single k v -&gt; Exp (Single k v)
</span><a href="#local-6989586621679126818"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126817"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679126817"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Exp (Single k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679126817"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span id="local-6989586621679126815"><span id="local-6989586621679126816"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126816"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126815"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126816"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126815"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126816"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126815"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-625"></span><span>  </span><span id="local-6989586621679126813"><span class="annot"><span class="annottext">toExp :: Bimap k v -&gt; Exp (Bimap k v)
</span><a href="#local-6989586621679126813"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679126812"><span class="annot"><span class="annottext">Bimap k v
</span><a href="#local-6989586621679126812"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v -&gt; Bimap k v -&gt; Exp (Bimap k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v
forall v k. (Basic (BiMap v), Ord v) =&gt; BaseRep (BiMap v) k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap k v
</span><a href="#local-6989586621679126812"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- ==========================================================================================</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- Smart constructors build typed Exp with real values at the leaves (the Base constuctor)</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="hs-comment">-- (&#8838;),</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- (&#8745;),</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span id="local-6989586621679126808"><span id="local-6989586621679126809"><span id="local-6989586621679126810"><span id="local-6989586621679126811"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dom"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126811"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126810"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126809"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126811"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126808"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126810"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126811"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-635"></span><span id="dom"><span class="annot"><span class="annottext">dom :: s -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#dom"><span class="hs-identifier hs-var hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621679126806"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126806"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
Exp (f k v) -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126806"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span id="local-6989586621679126802"><span id="local-6989586621679126803"><span id="local-6989586621679126804"><span id="local-6989586621679126805"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rng"><span class="hs-identifier hs-type">rng</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126805"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126804"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126803"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126802"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126805"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126804"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126803"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126804"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-638"></span><span id="rng"><span class="annot"><span class="annottext">rng :: s -&gt; Exp (Sett v ())
</span><a href="Control.Iterate.SetAlgebra.html#rng"><span class="hs-identifier hs-var hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621679126800"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126800"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Sett v ())
forall k v (f :: * -&gt; * -&gt; *).
(Ord k, Ord v) =&gt;
Exp (f k v) -&gt; Exp (Sett v ())
</span><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-var">Rng</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126800"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span id="local-6989586621679129711"><span id="local-6989586621679129712"><span id="local-6989586621679129713"><span id="local-6989586621679129714"><span id="local-6989586621679129715"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-type">(&#9665;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%3C%7C"><span class="hs-operator hs-type">(&lt;|)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-type">drestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129715"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129714"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129715"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129713"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129715"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129711"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129714"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129713"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129712"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129715"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129711"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-641"></span><span id="%25C1"><span class="annot"><span class="annottext">&#9665; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-var hs-var">(&#9665;)</span></a></span></span><span> </span><span id="local-6989586621679126796"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126796"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126795"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126795"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var">dRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (Sett k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126796"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126795"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span id="drestrict"><span class="annot"><span class="annottext">drestrict :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-var hs-var">drestrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, HasExp s1 (Sett k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-var">(&#9665;)</span></a></span><span>
</span><span id="line-643"></span><span id="%3C%7C"><span class="annot"><span class="annottext">&lt;| :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%3C%7C"><span class="hs-operator hs-var hs-var">(&lt;|)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, HasExp s1 (Sett k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-var">drestrict</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span id="local-6989586621679129689"><span id="local-6989586621679129690"><span id="local-6989586621679129691"><span id="local-6989586621679129692"><span id="local-6989586621679129693"><span id="local-6989586621679129694"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-type">(&#8938;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dexclude"><span class="hs-identifier hs-type">dexclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129694"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129693"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129692"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129693"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129694"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129691"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129690"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129694"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129689"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129692"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129691"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129690"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129694"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129689"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-646"></span><span id="%22EA"><span class="annot"><span class="annottext">&#8938; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-var hs-var">(&#8938;)</span></a></span></span><span> </span><span id="local-6989586621679126792"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126791"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var">dExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span id="dexclude"><span class="annot"><span class="annottext">dexclude :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dexclude"><span class="hs-identifier hs-var hs-var">dexclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g, HasExp s1 (g k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-var">(&#8938;)</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span id="local-6989586621679129672"><span id="local-6989586621679129673"><span id="local-6989586621679129674"><span id="local-6989586621679129675"><span id="local-6989586621679129676"><span id="local-6989586621679129677"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-type">(&#9655;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%7C%3E"><span class="hs-operator hs-type">(|&gt;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rrestrict"><span class="hs-identifier hs-type">rrestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129677"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129676"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129675"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129674"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129673"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129677"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129675"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129672"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129676"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129675"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129674"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129672"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129673"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129677"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129675"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-650"></span><span id="%25B7"><span class="annot"><span class="annottext">&#9655; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var hs-var">(&#9655;)</span></a></span></span><span> </span><span id="local-6989586621679126787"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126787"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126786"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126786"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var">rRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g v ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126786"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span id="rrestrict"><span class="annot"><span class="annottext">rrestrict :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rrestrict"><span class="hs-identifier hs-var hs-var">rrestrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var">(&#9655;)</span></a></span><span>
</span><span id="line-652"></span><span id="%7C%3E"><span class="annot"><span class="annottext">|&gt; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%7C%3E"><span class="hs-operator hs-var hs-var">(|&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var">(&#9655;)</span></a></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span id="local-6989586621679126780"><span id="local-6989586621679126781"><span id="local-6989586621679126782"><span id="local-6989586621679126783"><span id="local-6989586621679126784"><span id="local-6989586621679126785"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-type">(&#8939;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rexclude"><span class="hs-identifier hs-type">rexclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126785"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126784"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126783"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126782"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126781"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126785"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126783"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126780"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126784"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126783"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126782"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126780"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126781"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126785"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126783"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-655"></span><span id="%22EB"><span class="annot"><span class="annottext">&#8939; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-var hs-var">(&#8939;)</span></a></span></span><span> </span><span id="local-6989586621679126777"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126777"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126776"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126776"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var">rExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126777"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g v ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126776"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span id="rexclude"><span class="annot"><span class="annottext">rexclude :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rexclude"><span class="hs-identifier hs-var hs-var">rexclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-var">(&#8939;)</span></a></span><span>
</span><span id="line-657"></span><span id="local-6989586621679126773"><span id="local-6989586621679126774"><span id="local-6989586621679126775"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2208"><span class="hs-operator hs-type">(&#8712;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679126775"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126775"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126774"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126773"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126774"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126775"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126775"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126773"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-658"></span><span id="%2208"><span class="annot"><span class="annottext">&#8712; :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2208"><span class="hs-operator hs-var hs-var">(&#8712;)</span></a></span></span><span> </span><span id="local-6989586621679126771"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126771"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126770"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126770"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126771"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126770"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span id="local-6989586621679129643"><span id="local-6989586621679129644"><span id="local-6989586621679129645"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-type">(&#8713;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#notelem"><span class="hs-identifier hs-type">notelem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679129645"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129645"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129644"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129644"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129645"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129645"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-661"></span><span id="%2209"><span class="annot"><span class="annottext">&#8713; :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-var hs-var">(&#8713;)</span></a></span></span><span> </span><span id="local-6989586621679126767"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126767"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126766"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126766"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-var">NotElem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126767"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126766"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span id="notelem"><span class="annot"><span class="annottext">notelem :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#notelem"><span class="hs-identifier hs-var hs-var">notelem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; s -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *) s.
(Show k, Ord k, Iter g, HasExp s (g k ())) =&gt;
k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-var">(&#8713;)</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span id="local-6989586621679129622"><span id="local-6989586621679129623"><span id="local-6989586621679129624"><span id="local-6989586621679129625"><span id="local-6989586621679129626"><span id="local-6989586621679129627"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-type">(&#8746;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionleft"><span class="hs-identifier hs-type">unionleft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679129627"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679129626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129627"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129625"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129624"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129623"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129622"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129625"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129623"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129624"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-665"></span><span id="%222A"><span class="annot"><span class="annottext">&#8746; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-var hs-var">(&#8746;)</span></a></span></span><span> </span><span id="local-6989586621679126763"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126763"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126762"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126762"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k v) -&gt; Exp (f k v)
forall k v (k :: * -&gt; * -&gt; *) (n :: * -&gt; * -&gt; *).
(Show k, Show v, Ord k) =&gt;
Exp (k k v) -&gt; Exp (n k v) -&gt; Exp (k k v)
</span><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-var">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126763"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126762"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span id="unionleft"><span class="annot"><span class="annottext">unionleft :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#unionleft"><span class="hs-identifier hs-var hs-var">unionleft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k v s1 (f :: * -&gt; * -&gt; *) s2 (g :: * -&gt; * -&gt; *).
(Show k, Show v, Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-var">(&#8746;)</span></a></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span id="local-6989586621679129602"><span id="local-6989586621679129603"><span id="local-6989586621679129604"><span id="local-6989586621679129605"><span id="local-6989586621679129606"><span id="local-6989586621679129607"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-type">(&#10755;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionright"><span class="hs-identifier hs-type">unionright</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129607"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129606"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129605"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129607"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129604"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129603"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129602"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129607"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129604"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129606"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129603"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129605"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129607"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129604"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-669"></span><span id="%2A03"><span class="annot"><span class="annottext">&#10755; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-var hs-var">(&#10755;)</span></a></span></span><span> </span><span id="local-6989586621679126759"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126759"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126758"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126758"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k v) -&gt; Exp (f k v)
forall k (f :: * -&gt; * -&gt; *) k (v :: * -&gt; * -&gt; *).
Ord k =&gt;
Exp (f k k) -&gt; Exp (v k k) -&gt; Exp (f k k)
</span><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-var">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126759"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126758"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span id="unionright"><span class="annot"><span class="annottext">unionright :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#unionright"><span class="hs-identifier hs-var hs-var">unionright</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 (f :: * -&gt; * -&gt; *) v s2 (g :: * -&gt; * -&gt; *).
(Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-var">(&#10755;)</span></a></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span id="local-6989586621679129586"><span id="local-6989586621679129587"><span id="local-6989586621679129588"><span id="local-6989586621679129589"><span id="local-6989586621679129590"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-type">(&#8746;+)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionplus"><span class="hs-identifier hs-type">unionplus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129590"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679129589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129588"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129587"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129590"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129586"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129587"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129590"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129588"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129586"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129587"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129590"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-673"></span><span id="%222A%2B"><span class="annot"><span class="annottext">&#8746;+ :: s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-var hs-var">(&#8746;+)</span></a></span></span><span> </span><span id="local-6989586621679126755"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126755"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126754"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126754"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; Exp (f k n) -&gt; Exp (f k n)
forall k n (f :: * -&gt; * -&gt; *).
(Ord k, Monoid n) =&gt;
Exp (f k n) -&gt; Exp (f k n) -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-var">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k n)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126755"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k n)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126754"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span id="unionplus"><span class="annot"><span class="annottext">unionplus :: s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#unionplus"><span class="hs-identifier hs-var hs-var">unionplus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k n)
forall k n s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Monoid n, HasExp s1 (f k n), HasExp s2 (f k n)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-var">(&#8746;+)</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span id="local-6989586621679126752"><span id="local-6989586621679126753"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126753"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126753"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126752"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126753"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126752"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-677"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: k -&gt; v -&gt; Exp (Single k v)
</span><a href="Control.Iterate.SetAlgebra.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679126750"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126750"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126749"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126749"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Exp (Single k v)
forall k v. Ord k =&gt; k -&gt; v -&gt; Exp (Single k v)
</span><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126750"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126749"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span id="local-6989586621679126748"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#setSingleton"><span class="hs-identifier hs-type">setSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126748"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126748"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126748"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-680"></span><span id="setSingleton"><span class="annot"><span class="annottext">setSingleton :: k -&gt; Exp (Single k ())
</span><a href="Control.Iterate.SetAlgebra.html#setSingleton"><span class="hs-identifier hs-var hs-var">setSingleton</span></a></span></span><span> </span><span id="local-6989586621679126746"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126746"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126746"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span id="local-6989586621679129561"><span id="local-6989586621679129562"><span id="local-6989586621679129563"><span id="local-6989586621679129564"><span id="local-6989586621679129565"><span id="local-6989586621679129566"><span id="local-6989586621679129567"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-type">(&#8745;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersect"><span class="hs-identifier hs-type">intersect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129567"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129566"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129565"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129564"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129566"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129567"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129563"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129562"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129565"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129567"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129561"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129564"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129562"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129567"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-683"></span><span id="%2229"><span class="annot"><span class="annottext">&#8745; :: s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-var hs-var">(&#8745;)</span></a></span></span><span> </span><span id="local-6989586621679126743"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126743"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126742"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126742"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-var">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126743"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126742"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span id="intersect"><span class="annot"><span class="annottext">intersect :: s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#intersect"><span class="hs-identifier hs-var hs-var">intersect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-var">(&#8745;)</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span id="local-6989586621679129540"><span id="local-6989586621679129541"><span id="local-6989586621679129542"><span id="local-6989586621679129543"><span id="local-6989586621679129544"><span id="local-6989586621679129545"><span id="local-6989586621679129546"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-type">(&#8838;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#subset"><span class="hs-identifier hs-type">subset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129546"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129545"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129544"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129543"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129545"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129546"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129542"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129541"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129544"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129546"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129540"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129543"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129541"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-687"></span><span id="%2286"><span class="annot"><span class="annottext">&#8838; :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-var hs-var">(&#8838;)</span></a></span></span><span> </span><span id="local-6989586621679126739"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126738"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126738"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-var">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126738"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span id="subset"><span class="annot"><span class="annottext">subset :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#subset"><span class="hs-identifier hs-var hs-var">subset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-var">(&#8838;)</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span id="local-6989586621679126731"><span id="local-6989586621679126732"><span id="local-6989586621679126733"><span id="local-6989586621679126734"><span id="local-6989586621679126735"><span id="local-6989586621679126736"><span id="local-6989586621679126737"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-type">(&#8781;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keyeq"><span class="hs-identifier hs-type">keyeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126737"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126736"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126735"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126734"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126736"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126737"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126733"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126732"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126735"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126737"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126731"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126734"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126732"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-691"></span><span id="%224D"><span class="annot"><span class="annottext">&#8781; :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-var hs-var">(&#8781;)</span></a></span></span><span> </span><span id="local-6989586621679126728"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126728"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126727"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126727"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-var">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679126728"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679126727"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span id="keyeq"><span class="annot"><span class="annottext">keyeq :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#keyeq"><span class="hs-identifier hs-var hs-var">keyeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-var">(&#8781;)</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">--</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- =================================================================================================</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- | Symbolc functions (Fun) are data, that can be pattern matched over. They</span><span>
</span><span id="line-698"></span><span class="hs-comment">-- 1) Represent a wide class of binary functions that are used in translating the SetAlgebra</span><span>
</span><span id="line-699"></span><span class="hs-comment">-- 2) Turned into a String so they can be printed</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- 3) Turned into the function they represent.</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- 4) Composed into bigger functions</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- 5) Symbolically symplified</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- Here  we implement Symbolic Binary functions with upto 4 variables, which is enough for this use</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- =================================================================================================</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-keyword">data</span><span> </span><span id="Pat"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-var">Pat</span></a></span></span><span> </span><span id="local-6989586621679126726"><span class="annot"><a href="#local-6989586621679126726"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621679126725"><span class="annot"><a href="#local-6989586621679126725"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>  </span><span id="local-6989586621679126722"><span id="local-6989586621679126723"><span id="local-6989586621679126724"><span id="local-6989586621679129425"><span id="P1"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129425"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126724"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126723"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126722"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129425"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span><span>
</span><span id="line-708"></span><span>  </span><span id="local-6989586621679126718"><span id="local-6989586621679126719"><span id="local-6989586621679126720"><span id="local-6989586621679129420"><span id="P2"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126720"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129420"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126719"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129420"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-709"></span><span>  </span><span id="local-6989586621679126714"><span id="local-6989586621679126715"><span id="local-6989586621679126716"><span id="local-6989586621679129378"><span id="P3"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126716"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126715"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129378"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129378"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-710"></span><span>  </span><span id="local-6989586621679126709"><span id="local-6989586621679126710"><span id="local-6989586621679126711"><span id="local-6989586621679126712"><span id="P4"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126712"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126711"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126710"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126709"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-711"></span><span>  </span><span id="local-6989586621679126704"><span id="local-6989586621679126705"><span id="local-6989586621679126706"><span id="local-6989586621679126707"><span id="PPair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126707"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126706"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126704"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126707"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126706"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126705"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126707"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126706"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-keyword">data</span><span> </span><span id="Expr"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span></span><span> </span><span id="local-6989586621679126702"><span class="annot"><a href="#local-6989586621679126702"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621679126701"><span class="annot"><a href="#local-6989586621679126701"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-714"></span><span>  </span><span id="local-6989586621679126698"><span id="local-6989586621679126699"><span id="local-6989586621679126700"><span id="local-6989586621679129417"><span id="X1"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129417"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126700"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126699"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129417"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span><span>
</span><span id="line-715"></span><span>  </span><span id="local-6989586621679126694"><span id="local-6989586621679126695"><span id="local-6989586621679126696"><span id="local-6989586621679129410"><span id="X2"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126696"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129410"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126695"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129410"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-716"></span><span>  </span><span id="local-6989586621679126690"><span id="local-6989586621679126691"><span id="local-6989586621679126692"><span id="local-6989586621679129371"><span id="X3"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126692"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126691"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129371"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129371"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-717"></span><span>  </span><span id="local-6989586621679126685"><span id="local-6989586621679126686"><span id="local-6989586621679126687"><span id="local-6989586621679126688"><span id="X4"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X4"><span class="hs-identifier hs-var">X4</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126688"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126687"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126686"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126685"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-718"></span><span>  </span><span id="local-6989586621679126681"><span id="local-6989586621679126682"><span id="local-6989586621679126683"><span id="local-6989586621679129393"><span id="HasKey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126683"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126682"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129393"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126682"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126683"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126682"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126681"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129393"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-719"></span><span>  </span><span id="local-6989586621679129340"><span id="Neg"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129340"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129340"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-720"></span><span>  </span><span id="local-6989586621679126677"><span id="local-6989586621679126678"><span id="local-6989586621679129361"><span id="local-6989586621679129362"><span id="Ap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126678"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126677"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129362"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129361"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126678"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129361"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126677"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129361"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129362"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-721"></span><span>  </span><span id="local-6989586621679126674"><span id="local-6989586621679126675"><span id="local-6989586621679129355"><span id="EPair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129355"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129355"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129355"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-722"></span><span>  </span><span id="local-6989586621679126672"><span id="local-6989586621679129490"><span id="local-6989586621679129491"><span id="FST"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-var">FST</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129491"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129490"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126672"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129491"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129490"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-723"></span><span>  </span><span id="local-6989586621679126670"><span id="local-6989586621679129492"><span id="local-6989586621679129494"><span id="SND"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-var">SND</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129494"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126670"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129492"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129494"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129492"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-724"></span><span>  </span><span id="local-6989586621679129400"><span id="local-6989586621679129401"><span id="Lit"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679129401"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129401"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129400"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129401"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">-- Carefull no pattern P1, P2, P3, P4 should appear MORE THAN ONCE in a Lam.</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="hs-keyword">data</span><span> </span><span id="Lam"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span></span><span> </span><span id="local-6989586621679126667"><span class="annot"><a href="#local-6989586621679126667"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-729"></span><span>  </span><span id="local-6989586621679126660"><span id="local-6989586621679126661"><span id="local-6989586621679126662"><span id="local-6989586621679126663"><span id="local-6989586621679126664"><span id="local-6989586621679126665"><span id="local-6989586621679126666"><span id="Lam"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126665"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126662"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126665"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126665"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126660"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126662"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126660"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-730"></span><span>  </span><span id="local-6989586621679126658"><span id="Add"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-731"></span><span>  </span><span id="local-6989586621679126656"><span id="Cat"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-732"></span><span>  </span><span id="local-6989586621679126654"><span id="Eql"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679126654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-733"></span><span>  </span><span id="Both"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>  </span><span id="local-6989586621679126649"><span id="local-6989586621679126650"><span id="local-6989586621679126651"><span id="Lift"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-var">Lift</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126650"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126649"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126650"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126649"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- For use n the tests only!</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="hs-comment">-- ============= Printing in &#120631;-Normal Form =========================</span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-keyword">type</span><span> </span><span id="StringEnv"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-var">StringEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span id="local-6989586621679129499"><span id="local-6989586621679129500"><span id="local-6989586621679129501"><span id="local-6989586621679129502"><span id="local-6989586621679129503"><span id="local-6989586621679129504"><span id="local-6989586621679129505"><span id="local-6989586621679129506"><span id="local-6989586621679129507"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-type">bindE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129506"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129505"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129504"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129503"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129502"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129501"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129500"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129499"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129503"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-741"></span><span id="bindE"><span class="annot"><span class="annottext">bindE :: Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var hs-var">bindE</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span id="local-6989586621679126645"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126645"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126644"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679126644"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126643"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126643"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126642"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126642"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126641"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126641"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126644"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126645"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126643"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126642"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126641"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span id="local-6989586621679126639"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126639"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126638"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679126638"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126637"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126637"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126636"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126636"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126635"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126635"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126637"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126638"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126639"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126636"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126635"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span> </span><span id="local-6989586621679126634"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126634"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126633"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679126633"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126632"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126632"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126631"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126631"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126630"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126630"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126632"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126631"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126633"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126634"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126630"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span><span> </span><span id="local-6989586621679126629"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126629"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126628"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679126628"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126627"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126627"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126626"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126626"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126625"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126625"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126627"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126626"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126625"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126628"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126629"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679126624"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126624"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679126623"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126623"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-type">EPair</span></a></span><span> </span><span id="local-6989586621679126622"><span class="annot"><span class="annottext">Expr (w, x, y, z) a
</span><a href="#local-6989586621679126622"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679126621"><span class="annot"><span class="annottext">Expr (w, x, y, z) b
</span><a href="#local-6989586621679126621"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126620"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126620"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a -&gt; Expr (w, x, y, z) a -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126624"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) a
Expr (w, x, y, z) a
</span><a href="#local-6989586621679126622"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) b -&gt; Expr (w, x, y, z) b -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126623"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) b
Expr (w, x, y, z) b
</span><a href="#local-6989586621679126621"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126620"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679126619"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126619"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679126618"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126618"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126617"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679126617"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679126616"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126616"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b -&gt; Expr (w, x, y, z) b -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126618"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (w, x, y, z) (d, b) -&gt; Expr (w, x, y, z) b
forall e a b. Expr e (a, b) -&gt; Expr e b
</span><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-var">SND</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
Expr (w, x, y, z) (d, b)
</span><a href="#local-6989586621679126617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) a -&gt; Expr (w, x, y, z) a -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126619"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (w, x, y, z) (a, c) -&gt; Expr (w, x, y, z) a
forall e a b. Expr e (a, b) -&gt; Expr e a
</span><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-var">FST</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
Expr (w, x, y, z) (a, c)
</span><a href="#local-6989586621679126617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126616"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span id="local-6989586621679129514"><span id="local-6989586621679129515"><span id="local-6989586621679129516"><span id="local-6989586621679129517"><span id="local-6989586621679129518"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-type">showE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129518"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129517"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129516"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129515"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129514"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span></span></span></span><span>
</span><span id="line-749"></span><span id="showE"><span class="annot"><span class="annottext">showE :: StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var hs-var">showE</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126615"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126615"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126615"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-750"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126614"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126614"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126614"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-751"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126613"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126613"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126613"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-752"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126612"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126612"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X4"><span class="hs-identifier hs-var">X4</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126612"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-753"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126611"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126611"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-type">EPair</span></a></span><span> </span><span id="local-6989586621679126610"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679126610"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679126609"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679126609"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) a -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126611"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679126610"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) b -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126611"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679126609"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-754"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126608"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126608"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621679126607"><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679126607"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679126606"><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679126606"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679126605"><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679126605"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126604"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679126604"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126603"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679126603"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (d, c, b, a) v -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) s -&gt; Expr (a, b, c, d) s -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679126606"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
Expr (a, b, c, d) s
</span><a href="#local-6989586621679126603"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) t -&gt; Expr (a, b, c, d) t -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679126607"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
Expr (a, b, c, d) t
</span><a href="#local-6989586621679126604"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126608"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679126605"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-755"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126602"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126602"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-type">FST</span></a></span><span> </span><span id="local-6989586621679126601"><span class="annot"><span class="annottext">Expr (a, b, c, d) (t, b)
</span><a href="#local-6989586621679126601"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(fst &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) (t, b) -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126602"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) (t, b)
</span><a href="#local-6989586621679126601"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-756"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126600"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126600"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-type">SND</span></a></span><span> </span><span id="local-6989586621679126599"><span class="annot"><span class="annottext">Expr (a, b, c, d) (a, t)
</span><a href="#local-6989586621679126599"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(snd &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) (a, t) -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126600"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) (a, t)
</span><a href="#local-6989586621679126599"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-757"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126598"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126598"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span id="local-6989586621679126597"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; t)
</span><a href="#local-6989586621679126597"><span class="hs-identifier hs-var">oper</span></a></span></span><span> </span><span id="local-6989586621679126596"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679126596"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679126595"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679126595"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) a -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126598"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679126596"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Lam (a -&gt; b -&gt; t) -&gt; [Char]
forall t. StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126598"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; t)
</span><a href="#local-6989586621679126597"><span class="hs-identifier hs-var">oper</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) b -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126598"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679126595"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-758"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126593"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126593"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-type">HasKey</span></a></span><span> </span><span id="local-6989586621679126592"><span class="annot"><span class="annottext">Expr (a, b, c, d) k
</span><a href="#local-6989586621679126592"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126591"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126591"><span class="hs-identifier hs-var">_datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(haskey &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) k -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126593"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) k
</span><a href="#local-6989586621679126592"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; ?)&quot;</span></span><span>
</span><span id="line-759"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679126590"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126590"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621679126589"><span class="annot"><span class="annottext">Expr (a, b, c, d) Bool
</span><a href="#local-6989586621679126589"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(not &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) Bool -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126590"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) Bool
</span><a href="#local-6989586621679126589"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-760"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679126588"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126588"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126588"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span id="local-6989586621679129467"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-type">showL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129467"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-763"></span><span id="showL"><span class="annot"><span class="annottext">showL :: StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var hs-var">showL</span></a></span></span><span> </span><span id="local-6989586621679126587"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126587"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621679126586"><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679126586"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679126585"><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679126585"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679126584"><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679126584"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\ &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) t -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126587"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679126586"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) s -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126587"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679126585"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (d, c, b, a) v -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126587"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679126584"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-764"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679126582"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126582"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; + &quot;</span></span><span>
</span><span id="line-765"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679126581"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126581"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &lt;&gt; &quot;</span></span><span>
</span><span id="line-766"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679126580"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126580"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; == &quot;</span></span><span>
</span><span id="line-767"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679126579"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126579"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &amp;&amp; &quot;</span></span><span>
</span><span id="line-768"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679126578"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126578"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-type">Lift</span></a></span><span> </span><span id="local-6989586621679126577"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679126577"><span class="hs-identifier hs-var">_f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;lifted function&gt;&quot;</span></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span id="local-6989586621679129454"><span id="local-6989586621679129455"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-type">showP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129455"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129454"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-771"></span><span id="showP"><span class="annot"><span class="annottext">showP :: StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var hs-var">showP</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126576"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126576"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126576"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-772"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126575"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126575"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126575"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-773"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126574"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126574"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126574"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-774"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126573"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126573"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679126573"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-775"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span id="local-6989586621679126572"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126572"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679126571"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126571"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679126570"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126570"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) a -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126572"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679126571"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) b -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679126572"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679126570"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span id="local-6989586621679126565"><span id="local-6989586621679126566"><span id="local-6989586621679126567"><span id="local-6989586621679126568"><span id="local-6989586621679126569"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126560"><span id="local-6989586621679126563"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126569"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126567"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126566"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679126565"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-778"></span><span>   </span><span id="local-6989586621679126559"><span class="annot"><span class="annottext">show :: Expr (a, b, c, d) t -&gt; [Char]
</span><a href="#local-6989586621679126559"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679126558"><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="#local-6989586621679126558"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X1&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X2&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X3&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X4&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="#local-6989586621679126558"><span class="hs-identifier hs-var">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-779"></span><span id="local-6989586621679126557"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126552"><span id="local-6989586621679126555"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126557"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>   </span><span id="local-6989586621679126551"><span class="annot"><span class="annottext">show :: Lam t -&gt; [Char]
</span><a href="#local-6989586621679126551"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679126550"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679126550"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Lam t -&gt; [Char]
forall t. StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X1&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X2&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X3&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X4&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679126550"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-comment">-- ===============================================================================================================</span><span>
</span><span id="line-783"></span><span class="hs-comment">-- An symbolic function Fun has two parts, a Lam that can be analyzed, and real function that can be applied</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- ===============================================================================================================</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-keyword">data</span><span> </span><span id="Fun"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span></span><span> </span><span id="local-6989586621679129433"><span class="annot"><a href="#local-6989586621679129433"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fun"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129433"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129433"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- | We can observe a Fun by showing the Lam part.</span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span id="local-6989586621679126548"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126543"><span id="local-6989586621679126546"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126548"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-791"></span><span>  </span><span id="local-6989586621679126542"><span class="annot"><span class="annottext">show :: Fun t -&gt; [Char]
</span><a href="#local-6989586621679126542"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126541"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679126541"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679126540"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126540"><span class="hs-identifier hs-var">_fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam t -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679126541"><span class="hs-identifier hs-var">lam</span></a></span></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- Operations we use to manipulate Fun. Some simple ones, and some ways to compose them.</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- The great thing is the types completely decide what the operations do.</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">-- Used in projectStep, chainStep, andPStep, orStep and guardStep</span><span>
</span><span id="line-800"></span><span id="local-6989586621679128008"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128008"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128008"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-801"></span><span id="apply"><span class="annot"><span class="annottext">apply :: Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126538"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679126538"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span id="local-6989586621679126537"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126537"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126537"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="hs-comment">-- Used in compile (UnionOverrideLeft case)</span><span>
</span><span id="line-804"></span><span id="local-6989586621679129117"><span id="local-6989586621679129118"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-type">first</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129118"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129117"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129118"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-805"></span><span id="first"><span class="annot"><span class="annottext">first :: Fun (v -&gt; s -&gt; v)
</span><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-var hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (v -&gt; s -&gt; v) -&gt; (v -&gt; s -&gt; v) -&gt; Fun (v -&gt; s -&gt; v)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
-&gt; Pat (v, s, Any, Any) s
-&gt; Expr (v, s, Any, Any) v
-&gt; Lam (v -&gt; s -&gt; v)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) s
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (v, s, Any, Any) v
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126535"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126535"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126534"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126534"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126535"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-comment">-- Used in compile (UnionOverrideRight case)</span><span>
</span><span id="line-808"></span><span id="local-6989586621679129261"><span id="local-6989586621679129262"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-type">second</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129262"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129261"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129261"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-809"></span><span id="second"><span class="annot"><span class="annottext">second :: Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (v -&gt; s -&gt; s) -&gt; (v -&gt; s -&gt; s) -&gt; Fun (v -&gt; s -&gt; s)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
-&gt; Pat (v, s, Any, Any) s
-&gt; Expr (v, s, Any, Any) s
-&gt; Lam (v -&gt; s -&gt; s)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) s
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (v, s, Any, Any) s
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126532"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126532"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679126531"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126531"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679126531"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- Used in compile (UnionPlus case)</span><span>
</span><span id="line-812"></span><span id="local-6989586621679129109"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-type">plus</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679129109"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129109"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129109"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129109"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-813"></span><span id="plus"><span class="annot"><span class="annottext">plus :: Fun (t -&gt; t -&gt; t)
</span><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-var hs-var">plus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; t) -&gt; (t -&gt; t -&gt; t) -&gt; Fun (t -&gt; t -&gt; t)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; t)
forall m. Monoid m =&gt; Lam (m -&gt; m -&gt; m)
</span><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span id="local-6989586621679126529"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#eql"><span class="hs-identifier hs-type">eql</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679126529"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126529"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126529"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-816"></span><span id="eql"><span class="annot"><span class="annottext">eql :: Fun (t -&gt; t -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#eql"><span class="hs-identifier hs-var hs-var">eql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; Bool) -&gt; (t -&gt; t -&gt; Bool) -&gt; Fun (t -&gt; t -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; Bool)
forall t. Eq t =&gt; Lam (t -&gt; t -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span class="hs-special">)</span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span id="local-6989586621679129335"><span id="local-6989586621679129336"><span id="local-6989586621679129337"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-type">constant</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679129337"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129337"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129336"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129335"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129337"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-819"></span><span id="constant"><span class="annot"><span class="annottext">constant :: c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var hs-var">constant</span></a></span></span><span> </span><span id="local-6989586621679126526"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679126526"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; c) -&gt; (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
-&gt; Pat (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) c
-&gt; Lam (a -&gt; b -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) b
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Expr (a, b, Any, Any) c
forall t env. Show t =&gt; t -&gt; Expr env t
</span><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679126526"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126525"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126525"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679126524"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126524"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679126526"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">-- Used in compile (RExclude RRestrict cases)</span><span>
</span><span id="line-822"></span><span id="local-6989586621679129136"><span id="local-6989586621679129137"><span id="local-6989586621679129138"><span id="local-6989586621679129139"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-type">rngElem</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129139"><span class="hs-identifier hs-type">rng</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129138"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129138"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129139"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129137"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129136"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129139"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-823"></span><span id="rngElem"><span class="annot"><span class="annottext">rngElem :: f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var hs-var">rngElem</span></a></span></span><span> </span><span id="local-6989586621679126522"><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679126522"><span class="hs-identifier hs-var">realset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (dom -&gt; rng -&gt; Bool)
-&gt; (dom -&gt; rng -&gt; Bool) -&gt; Fun (dom -&gt; rng -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
-&gt; Pat (dom, rng, Any, Any) rng
-&gt; Expr (dom, rng, Any, Any) Bool
-&gt; Lam (dom -&gt; rng -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) rng
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) rng
-&gt; f rng v -&gt; Expr (dom, rng, Any, Any) Bool
forall (f :: * -&gt; * -&gt; *) k e a.
(Iter f, Ord k) =&gt;
Expr e k -&gt; f k a -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) rng
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679126522"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126521"><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679126521"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679126520"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679126520"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">rng -&gt; f rng v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679126520"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679126522"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- x is ignored and realset is supplied</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span id="local-6989586621679126516"><span id="local-6989586621679126517"><span id="local-6989586621679126518"><span id="local-6989586621679126519"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domElem"><span class="hs-identifier hs-type">domElem</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126519"><span class="hs-identifier hs-type">dom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126518"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126518"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126519"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126517"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126519"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126516"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-826"></span><span id="domElem"><span class="annot"><span class="annottext">domElem :: f dom v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#domElem"><span class="hs-identifier hs-var hs-var">domElem</span></a></span></span><span> </span><span id="local-6989586621679126514"><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679126514"><span class="hs-identifier hs-var">realset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (dom -&gt; rng -&gt; Bool)
-&gt; (dom -&gt; rng -&gt; Bool) -&gt; Fun (dom -&gt; rng -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
-&gt; Pat (dom, rng, Any, Any) rng
-&gt; Expr (dom, rng, Any, Any) Bool
-&gt; Lam (dom -&gt; rng -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) rng
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) dom
-&gt; f dom v -&gt; Expr (dom, rng, Any, Any) Bool
forall (f :: * -&gt; * -&gt; *) k e a.
(Iter f, Ord k) =&gt;
Expr e k -&gt; f k a -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) dom
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679126514"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126513"><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679126513"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126512"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679126512"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dom -&gt; f dom v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679126513"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679126514"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- y is ignored and realset is supplied</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span id="local-6989586621679129133"><span id="local-6989586621679129134"><span id="local-6989586621679129135"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-type">rngFst</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129135"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129133"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-829"></span><span id="rngFst"><span class="annot"><span class="annottext">rngFst :: Fun (x -&gt; (a, b) -&gt; a)
</span><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-var hs-var">rngFst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (x -&gt; (a, b) -&gt; a)
-&gt; (x -&gt; (a, b) -&gt; a) -&gt; Fun (x -&gt; (a, b) -&gt; a)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
-&gt; Pat (x, a, b, a) (a, b)
-&gt; Expr (x, a, b, a) a
-&gt; Lam (x -&gt; (a, b) -&gt; a)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) a -&gt; Pat (x, a, b, a) b -&gt; Pat (x, a, b, a) (a, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (x, a, b, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126510"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679126510"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126509"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126509"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126508"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126508"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126509"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span id="local-6989586621679129152"><span id="local-6989586621679129153"><span id="local-6989586621679129154"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-type">rngSnd</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129154"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129152"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129152"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-832"></span><span id="rngSnd"><span class="annot"><span class="annottext">rngSnd :: Fun (x -&gt; (a, b) -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-var hs-var">rngSnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (x -&gt; (a, b) -&gt; b)
-&gt; (x -&gt; (a, b) -&gt; b) -&gt; Fun (x -&gt; (a, b) -&gt; b)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
-&gt; Pat (x, a, b, a) (a, b)
-&gt; Expr (x, a, b, a) b
-&gt; Lam (x -&gt; (a, b) -&gt; b)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) a -&gt; Pat (x, a, b, a) b -&gt; Pat (x, a, b, a) (a, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (x, a, b, a) b
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126506"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679126506"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679126505"><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679126505"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679126505"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span id="local-6989586621679129269"><span id="local-6989586621679129270"><span id="local-6989586621679129271"><span id="local-6989586621679129272"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-type">compose1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129271"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129270"><span class="hs-identifier hs-type">t3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129269"><span class="hs-identifier hs-type">t4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129271"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129269"><span class="hs-identifier hs-type">t4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129270"><span class="hs-identifier hs-type">t3</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-835"></span><span id="compose1"><span class="annot"><span class="annottext">compose1 :: Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var hs-var">compose1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126503"><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
</span><a href="#local-6989586621679126503"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679126502"><span class="annot"><span class="annottext">t1 -&gt; t2 -&gt; t3
</span><a href="#local-6989586621679126502"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126501"><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
</span><a href="#local-6989586621679126501"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679126500"><span class="annot"><span class="annottext">t1 -&gt; t4 -&gt; t2
</span><a href="#local-6989586621679126500"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t3) -&gt; (t1 -&gt; t4 -&gt; t3) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t1
-&gt; Pat (t1, t4, Any, Any) t4
-&gt; Expr (t1, t4, Any, Any) t3
-&gt; Lam (t1 -&gt; t4 -&gt; t3)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t1
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t4
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
-&gt; Expr (t1, t4, Any, Any) t1
-&gt; Expr (t1, t4, Any, Any) t2
-&gt; Expr (t1, t4, Any, Any) t3
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
</span><a href="#local-6989586621679126503"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t1
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
-&gt; Expr (t1, t4, Any, Any) t1
-&gt; Expr (t1, t4, Any, Any) t4
-&gt; Expr (t1, t4, Any, Any) t2
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
</span><a href="#local-6989586621679126501"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t1
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t4
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126499"><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679126499"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679126498"><span class="annot"><span class="annottext">t4
</span><a href="#local-6989586621679126498"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t1 -&gt; t2 -&gt; t3
</span><a href="#local-6989586621679126502"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679126499"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t1 -&gt; t4 -&gt; t2
</span><a href="#local-6989586621679126500"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679126499"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t4
</span><a href="#local-6989586621679126498"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span id="local-6989586621679129250"><span id="local-6989586621679129251"><span id="local-6989586621679129252"><span id="local-6989586621679129253"><span id="local-6989586621679129254"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-type">compSndL</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129254"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129252"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129251"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129254"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129250"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129254"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129250"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129252"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129251"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-838"></span><span id="compSndL"><span class="annot"><span class="annottext">compSndL :: Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var hs-var">compSndL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126496"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679126496"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679126495"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679126495"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126494"><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
</span><a href="#local-6989586621679126494"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126493"><span class="annot"><span class="annottext">k -&gt; d -&gt; a
</span><a href="#local-6989586621679126493"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (d, b) -&gt; c)
-&gt; (k -&gt; (d, b) -&gt; c) -&gt; Fun (k -&gt; (d, b) -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, d, b, d) k
-&gt; Pat (k, d, b, d) (d, b)
-&gt; Expr (k, d, b, d) c
-&gt; Lam (k -&gt; (d, b) -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, d, b, d) d -&gt; Pat (k, d, b, d) b -&gt; Pat (k, d, b, d) (d, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) d
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
-&gt; Expr (k, d, b, d) k
-&gt; Expr (k, d, b, d) (a, b)
-&gt; Expr (k, d, b, d) c
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679126496"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, d, b, d) a
-&gt; Expr (k, d, b, d) b -&gt; Expr (k, d, b, d) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
-&gt; Expr (k, d, b, d) k
-&gt; Expr (k, d, b, d) d
-&gt; Expr (k, d, b, d) a
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
</span><a href="#local-6989586621679126494"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) d
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) b
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126492"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126492"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126491"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679126491"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126490"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126490"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679126495"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126492"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; d -&gt; a
</span><a href="#local-6989586621679126493"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126492"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679126491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126490"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span id="local-6989586621679129244"><span id="local-6989586621679129245"><span id="local-6989586621679129246"><span id="local-6989586621679129247"><span id="local-6989586621679129248"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-type">compSndR</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129248"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129245"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129248"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129244"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129248"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129244"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129245"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-841"></span><span id="compSndR"><span class="annot"><span class="annottext">compSndR :: Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; b) -&gt; Fun (k -&gt; (a, d) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-var hs-var">compSndR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126488"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679126488"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679126487"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679126487"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126486"><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
</span><a href="#local-6989586621679126486"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126485"><span class="annot"><span class="annottext">k -&gt; d -&gt; b
</span><a href="#local-6989586621679126485"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, d) -&gt; c)
-&gt; (k -&gt; (a, d) -&gt; c) -&gt; Fun (k -&gt; (a, d) -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, d, a) k
-&gt; Pat (k, a, d, a) (a, d)
-&gt; Expr (k, a, d, a) c
-&gt; Lam (k -&gt; (a, d) -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, d, a) a -&gt; Pat (k, a, d, a) d -&gt; Pat (k, a, d, a) (a, d)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) d
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
-&gt; Expr (k, a, d, a) k
-&gt; Expr (k, a, d, a) (a, b)
-&gt; Expr (k, a, d, a) c
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679126488"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, a, d, a) a
-&gt; Expr (k, a, d, a) b -&gt; Expr (k, a, d, a) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
-&gt; Expr (k, a, d, a) k
-&gt; Expr (k, a, d, a) d
-&gt; Expr (k, a, d, a) b
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
</span><a href="#local-6989586621679126486"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) d
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126484"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126484"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126483"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126483"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126482"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679126482"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679126487"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126484"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126483"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">k -&gt; d -&gt; b
</span><a href="#local-6989586621679126485"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126484"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679126482"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span id="local-6989586621679129222"><span id="local-6989586621679129223"><span id="local-6989586621679129224"><span id="local-6989586621679129225"><span id="local-6989586621679129226"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-type">compCurryR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129226"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129224"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129223"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129222"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129224"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129226"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129222"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129223"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-844"></span><span id="compCurryR"><span class="annot"><span class="annottext">compCurryR :: Fun (k -&gt; (a, b) -&gt; d)
-&gt; Fun (a -&gt; c -&gt; b) -&gt; Fun (k -&gt; (a, c) -&gt; d)
</span><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-var hs-var">compCurryR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126480"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
</span><a href="#local-6989586621679126480"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679126479"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; d
</span><a href="#local-6989586621679126479"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126478"><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
</span><a href="#local-6989586621679126478"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span id="local-6989586621679126477"><span class="annot"><span class="annottext">a -&gt; c -&gt; b
</span><a href="#local-6989586621679126477"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, c) -&gt; d)
-&gt; (k -&gt; (a, c) -&gt; d) -&gt; Fun (k -&gt; (a, c) -&gt; d)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, c, a) k
-&gt; Pat (k, a, c, a) (a, c)
-&gt; Expr (k, a, c, a) d
-&gt; Lam (k -&gt; (a, c) -&gt; d)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, c, a) a -&gt; Pat (k, a, c, a) c -&gt; Pat (k, a, c, a) (a, c)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) c
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
-&gt; Expr (k, a, c, a) k
-&gt; Expr (k, a, c, a) (a, b)
-&gt; Expr (k, a, c, a) d
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
</span><a href="#local-6989586621679126480"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
-&gt; Expr (k, a, c, a) b -&gt; Expr (k, a, c, a) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
-&gt; Expr (k, a, c, a) a
-&gt; Expr (k, a, c, a) c
-&gt; Expr (k, a, c, a) b
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
</span><a href="#local-6989586621679126478"><span class="hs-identifier hs-var">eg</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) c
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126476"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126476"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126475"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126475"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126474"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679126474"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; d
</span><a href="#local-6989586621679126479"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126476"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126475"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a -&gt; c -&gt; b
</span><a href="#local-6989586621679126477"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126475"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679126474"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span id="local-6989586621679129126"><span id="local-6989586621679129127"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-type">nEgate</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129127"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129126"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129127"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129126"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-847"></span><span id="nEgate"><span class="annot"><span class="annottext">nEgate :: Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var hs-var">nEgate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126472"><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126472"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679126471"><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool
</span><a href="#local-6989586621679126471"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool) -&gt; (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) k
-&gt; Pat (k, v, Any, Any) v
-&gt; Expr (k, v, Any, Any) Bool
-&gt; Lam (k -&gt; v -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) v
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) Bool -&gt; Expr (k, v, Any, Any) Bool
forall e. Expr e Bool -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
-&gt; Expr (k, v, Any, Any) k
-&gt; Expr (k, v, Any, Any) v
-&gt; Expr (k, v, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126472"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) v
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126470"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126470"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126469"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126469"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool
</span><a href="#local-6989586621679126471"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126469"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span id="local-6989586621679126467"><span id="local-6989586621679126468"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#always"><span class="hs-identifier hs-type">always</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126467"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-850"></span><span id="always"><span class="annot"><span class="annottext">always :: Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#always"><span class="hs-identifier hs-var hs-var">always</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Fun (a -&gt; b -&gt; Bool)
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span id="local-6989586621679129216"><span id="local-6989586621679129217"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-type">both</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129216"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129216"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129216"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-853"></span><span id="both"><span class="annot"><span class="annottext">both :: Fun (a -&gt; b -&gt; Bool)
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126464"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679126464"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679126463"><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679126463"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679126462"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679126462"><span class="hs-identifier hs-var">ff</span></a></span></span><span> </span><span id="local-6989586621679126461"><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679126461"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool) -&gt; (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
-&gt; Pat (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Lam (a -&gt; b -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) b
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (Bool -&gt; Bool -&gt; Bool)
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (Bool -&gt; Bool -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
-&gt; Expr (a, b, Any, Any) a
-&gt; Expr (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679126464"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) a
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) b
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
-&gt; Expr (a, b, Any, Any) a
-&gt; Expr (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679126462"><span class="hs-identifier hs-var">ff</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) a
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) b
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126460"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126460"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679126459"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126459"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679126463"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126460"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126459"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679126461"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126460"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126459"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span id="local-6989586621679126456"><span id="local-6989586621679126457"><span id="local-6989586621679126458"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lift"><span class="hs-identifier hs-type">lift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126457"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126456"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126457"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126456"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- This is used in the tests, not good to use it elsewhere.</span><span>
</span><span id="line-856"></span><span id="lift"><span class="annot"><span class="annottext">lift :: (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#lift"><span class="hs-identifier hs-var hs-var">lift</span></a></span></span><span> </span><span id="local-6989586621679126454"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679126454"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; c) -&gt; (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; Lam (a -&gt; b -&gt; c)
forall a b c. (a -&gt; b -&gt; c) -&gt; Lam (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-var">Lift</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679126454"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679126454"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- ============================================================================================</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- | Given a BaseRep we can materialize a (Collect k v) into the type witnessed by the BaseRep.</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- Recall a (Collect k v) has no intrinsic type (it is just an ABSTRACT sequence of tuples), so</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- the witness describes how to turn them into the chosen datatype. Note that materialize is meant</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- to be applied to a collection built by iterating over a Query. This produces the keys in</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- ascending order, with no duplicate keys. So we do not need to specify how to merge values.</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- =============================================================================================</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span id="local-6989586621679129083"><span id="local-6989586621679129084"><span id="local-6989586621679129085"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-type">materialize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129085"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129084"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129085"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129083"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129085"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129083"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129084"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129085"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129083"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-869"></span><span id="materialize"><span class="annot"><span class="annottext">materialize :: BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var hs-var">materialize</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679126452"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126452"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126451"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126451"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679126450"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126450"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126451"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; [(k, v)] -&gt; ((k, v) -&gt; [(k, v)] -&gt; [(k, v)]) -&gt; [(k, v)]
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126452"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126448"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126448"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; Map k v -&gt; ((k, v) -&gt; Map k v -&gt; Map k v) -&gt; Map k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126448"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126447"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126447"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126446"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126446"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126445"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126445"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126447"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126446"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679126445"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126443"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126443"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (k, v) -&gt; Set k -&gt; ((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126443"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126442"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126442"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126441"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126441"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126442"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126441"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126440"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126440"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; BiMap v k v
-&gt; ((k, v) -&gt; BiMap v k v -&gt; BiMap v k v)
-&gt; BiMap v k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126440"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">BiMap v k v
forall v k. BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var">biMapEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126439"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126439"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126438"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126438"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126437"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679126437"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; v -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-var">addpair</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126439"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126438"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679126437"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679126436"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126436"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; Single k v -&gt; ((k, v) -&gt; Single k v -&gt; Single k v) -&gt; Single k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679126436"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126435"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126435"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126434"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126434"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126433"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679126433"><span class="hs-identifier hs-var">_ignore</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126435"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126434"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- On the flip side, a witness can be used to specifiy how to build a datatype from</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- a CONCRETE sequence of tuples (a [(k,v)]). This is a way to import a type from from</span><span>
</span><span id="line-878"></span><span class="hs-comment">--  a list. But unlike 'materialize' an arbitray [(k,v)] may have duplicate keys,</span><span>
</span><span id="line-879"></span><span class="hs-comment">--  so when that happens, use 'combine' to merge the associated values.</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span id="local-6989586621679129313"><span id="local-6989586621679129314"><span id="local-6989586621679129315"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-type">addp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129314"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129314"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129314"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129313"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-883"></span><span id="addp"><span class="annot"><span class="annottext">addp :: (v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var hs-var">addp</span></a></span></span><span> </span><span id="local-6989586621679126431"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126431"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126430"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126430"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126429"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126429"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126428"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126428"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126430"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126429"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126428"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126431"><span class="hs-identifier hs-var">combine</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="hs-comment">-- The combine function comb = (\ earlier later -&gt; later) will let values</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- later in the list override ones earlier in the list, and comb =</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- (\ earlier later -&gt; earlier) will keep the value that appears first in the list</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span id="local-6989586621679126425"><span id="local-6989586621679126426"><span id="local-6989586621679126427"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126426"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126427"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126426"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126425"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-890"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: BaseRep f k v -&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126423"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126423"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679126422"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126422"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126423"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126422"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-891"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679126420"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126420"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679126419"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126419"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126420"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126419"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-892"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126418"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126418"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679126417"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126417"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Sett k v -&gt; Sett k v)
-&gt; Sett k v -&gt; [(k, v)] -&gt; Sett k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; Sett k v -&gt; Sett k v
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var">addp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126418"><span class="hs-identifier hs-var">combine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126417"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-893"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126416"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126416"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679126415"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126415"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
forall k v.
(Ord k, Ord v) =&gt;
(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-var">biMapFromList</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126416"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126415"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-894"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679126414"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126414"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679126413"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126413"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Single k v -&gt; Single k v)
-&gt; Single k v -&gt; [(k, v)] -&gt; Single k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; Single k v -&gt; Single k v
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var">addp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679126414"><span class="hs-identifier hs-var">combine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679126413"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="hs-comment">-- =========================================================================================</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- Now we make an iterator that collects triples, on the intersection</span><span>
</span><span id="line-898"></span><span class="hs-comment">-- of the domain of the two Iter types 'f' and 'g'. An answer of (k,b,c) means that</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- (k,b) is in m::f k a, and (k,c) is in n::g k c. All the other possible triples</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- are skipped over.  This is an instance of a thing called a &quot;Generic Join&quot;</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- See https://arxiv.org/pdf/1310.3314.pdf  or  http://personales.dcc.uchile.cl/~pbarcelo/ngo.pdf</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- The number of tuples it touches is proportional to the size of the output (modulo log factors).</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- It's cost is unrelated to the size of its inputs (modulo log factors)</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- This is a very specific version of the AndD compound iterator. It is used in the function 'eval'</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- =========================================================================================</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span id="local-6989586621679126408"><span id="local-6989586621679126409"><span id="local-6989586621679126410"><span id="local-6989586621679126411"><span id="local-6989586621679126412"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2A1D"><span class="hs-operator hs-type">(&#10781;)</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126412"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126411"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126410"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679126411"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126412"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126409"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126410"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126412"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126408"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126412"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126409"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126408"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-908"></span><span id="%2A1D"><span class="annot"><span class="annottext">&#10781; :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#%2A1D"><span class="hs-operator hs-var hs-var">(&#10781;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; g k c -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var">domEq</span></a></span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span id="local-6989586621679129301"><span id="local-6989586621679129302"><span id="local-6989586621679129303"><span id="local-6989586621679129304"><span id="local-6989586621679129305"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-type">domEq</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129305"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129304"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129303"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679129304"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129305"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129303"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129305"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129301"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129305"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129301"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-911"></span><span id="domEq"><span class="annot"><span class="annottext">domEq :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var hs-var">domEq</span></a></span></span><span> </span><span id="local-6989586621679126405"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126405"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679126404"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679126404"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-912"></span><span>    </span><span id="local-6989586621679126403"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126403"><span class="hs-identifier hs-var">triplem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126405"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-913"></span><span>    </span><span id="local-6989586621679126402"><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679126402"><span class="hs-identifier hs-var">triplen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">g k c -&gt; Collect (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679126404"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679126401"><span class="annot"><span class="annottext">loop :: (k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679126401"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126400"><span class="annot"><span class="annottext">mt :: (k, b, f k b)
</span><a href="#local-6989586621679126400"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126399"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126399"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126398"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126398"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126397"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126397"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126396"><span class="annot"><span class="annottext">nt :: (k, b, f k b)
</span><a href="#local-6989586621679126396"><span class="hs-identifier hs-var">nt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126395"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126395"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126394"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126394"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126393"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126393"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-915"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126399"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126395"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-916"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, b) -&gt; Collect (k, b, b) -&gt; Collect (k, b, b)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126399"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126398"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126394"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k b -&gt; f k b -&gt; Collect (k, b, b)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var">domEq</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126397"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126393"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679126392"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126392"><span class="hs-identifier hs-var">mt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126395"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126397"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679126401"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126392"><span class="hs-identifier hs-var">mt'</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126396"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-918"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679126391"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126391"><span class="hs-identifier hs-var">nt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126399"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126393"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679126401"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126400"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126391"><span class="hs-identifier hs-var">nt'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-919"></span><span>    </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, c, g k c) -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord k, Iter f, Iter f) =&gt;
(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679126401"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126403"><span class="hs-identifier hs-var">triplem</span></a></span><span> </span><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679126402"><span class="hs-identifier hs-var">triplen</span></a></span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="hs-comment">-- This is included here for the benchmark tests. It is much slower because it does not use lub.</span><span>
</span><span id="line-922"></span><span>
</span><span id="line-923"></span><span id="local-6989586621679126386"><span id="local-6989586621679126387"><span id="local-6989586621679126388"><span id="local-6989586621679126389"><span id="local-6989586621679126390"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-type">domEqSlow</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126390"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126389"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126388"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679126389"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126390"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126387"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126388"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126390"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126386"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126390"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126387"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126386"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-924"></span><span id="domEqSlow"><span class="annot"><span class="annottext">domEqSlow :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-var hs-var">domEqSlow</span></a></span></span><span> </span><span id="local-6989586621679126384"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126384"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679126383"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679126383"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-925"></span><span>    </span><span id="local-6989586621679126382"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126382"><span class="hs-identifier hs-var">triplem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679126384"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-926"></span><span>    </span><span id="local-6989586621679126381"><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679126381"><span class="hs-identifier hs-var">triplen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">g k c -&gt; Collect (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679126383"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-927"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679126380"><span class="annot"><span class="annottext">loop :: (a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679126380"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126379"><span class="annot"><span class="annottext">mt :: (a, b, f a b)
</span><a href="#local-6989586621679126379"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126378"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126378"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126377"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126377"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126376"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126376"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126375"><span class="annot"><span class="annottext">nt :: (a, b, f a b)
</span><a href="#local-6989586621679126375"><span class="hs-identifier hs-var">nt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679126374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126374"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126373"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126373"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126372"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126372"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-928"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126378"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126374"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-929"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, b) -&gt; Collect (a, b, b) -&gt; Collect (a, b, b)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126378"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126377"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679126373"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; f a b -&gt; Collect (a, b, b)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-var">domEqSlow</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126376"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126372"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679126371"><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126371"><span class="hs-identifier hs-var">mt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126376"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679126380"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126371"><span class="hs-identifier hs-var">mt'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126375"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-931"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679126370"><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126370"><span class="hs-identifier hs-var">nt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679126372"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679126380"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126379"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679126370"><span class="hs-identifier hs-var">nt'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-932"></span><span>    </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, c, g k c) -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord k, Iter f, Iter f) =&gt;
(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679126380"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679126382"><span class="hs-identifier hs-var">triplem</span></a></span><span> </span><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679126381"><span class="hs-identifier hs-var">triplen</span></a></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-935"></span><span class="hs-comment">-- Query is a single datatype that incorporates a language that describes how to build</span><span>
</span><span id="line-936"></span><span class="hs-comment">-- compound iterators, from other iterators.</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="hs-keyword">data</span><span> </span><span id="Query"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-var">Query</span></a></span></span><span> </span><span id="local-6989586621679126369"><span class="annot"><a href="#local-6989586621679126369"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679126368"><span class="annot"><a href="#local-6989586621679126368"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-940"></span><span>   </span><span id="local-6989586621679126367"><span id="local-6989586621679129200"><span id="local-6989586621679129201"><span id="BaseD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126367"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129201"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126367"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129201"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129200"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126367"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129201"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129200"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129201"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129200"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-941"></span><span>   </span><span id="local-6989586621679126363"><span id="local-6989586621679126364"><span id="local-6989586621679126365"><span id="ProjectD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126365"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126365"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126364"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126365"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126364"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126363"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126365"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126363"><span class="hs-identifier hs-type">u</span></a></span></span></span></span><span>
</span><span id="line-942"></span><span>   </span><span id="local-6989586621679126360"><span id="local-6989586621679126361"><span id="local-6989586621679129243"><span id="AndD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129243"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129243"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126361"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129243"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126360"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129243"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126361"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126360"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-943"></span><span>   </span><span id="local-6989586621679126355"><span id="local-6989586621679126356"><span id="local-6989586621679126357"><span id="local-6989586621679126358"><span id="ChainD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126358"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126357"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126357"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126357"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126356"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126357"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126356"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126355"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126355"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-944"></span><span>   </span><span id="local-6989586621679126350"><span id="local-6989586621679126351"><span id="local-6989586621679126352"><span id="local-6989586621679126353"><span id="AndPD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126353"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126353"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126352"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126353"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126351"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126353"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126352"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679126351"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126350"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126353"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126350"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span><span>
</span><span id="line-945"></span><span>   </span><span id="local-6989586621679129119"><span id="local-6989586621679129120"><span id="OrD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129120"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129120"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129120"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129120"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129119"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-946"></span><span>   </span><span id="local-6989586621679129218"><span id="local-6989586621679129219"><span id="GuardD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129219"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129219"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129218"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129219"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129218"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129219"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129218"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-947"></span><span>   </span><span id="local-6989586621679126346"><span id="local-6989586621679129146"><span id="local-6989586621679129147"><span id="DiffD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129147"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129147"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129146"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129147"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126346"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129147"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129146"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-950"></span><span class="hs-comment">-- smart constructors for Query. These apply semantic preserving rewrites when applicable</span><span>
</span><span id="line-951"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-type">smart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-954"></span><span id="smart"><span class="annot"><span class="annottext">smart :: Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var hs-var">smart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-comment">-- for debugging purposes, this can be set to False, in which case no rewrites occurr.</span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span id="local-6989586621679129273"><span id="local-6989586621679129274"><span id="local-6989586621679129275"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-type">projD</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129275"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129275"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129275"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129273"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129275"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129273"><span class="hs-identifier hs-type">u</span></a></span></span></span></span><span>
</span><span id="line-957"></span><span id="projD"><span class="annot"><span class="annottext">projD :: Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var hs-var">projD</span></a></span></span><span> </span><span id="local-6989586621679126342"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126342"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126341"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126341"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126342"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126341"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-958"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679126340"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126340"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126339"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679126339"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679126338"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126338"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126340"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; Fun (k -&gt; v -&gt; v) -&gt; Fun (k -&gt; v -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126338"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679126339"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679126337"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126337"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126336"><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679126336"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126335"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126335"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126337"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679126336"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; Fun (k -&gt; v -&gt; v) -&gt; Fun (k -&gt; v -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126335"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-960"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679126333"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126333"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126332"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126332"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126331"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679126331"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679126330"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126330"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; u) -&gt; Query k u
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126332"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
-&gt; Fun (k -&gt; (v, u) -&gt; v) -&gt; Fun (k -&gt; (v, u) -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126330"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679126331"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679126329"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126329"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679126328"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126328"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126329"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679126328"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-962"></span><span>
</span><span id="line-963"></span><span id="local-6989586621679126325"><span id="local-6989586621679126326"><span id="local-6989586621679126327"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-type">andD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126327"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126327"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126326"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126327"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126325"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126327"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126326"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126325"><span class="hs-identifier hs-type">v2</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-964"></span><span id="andD"><span class="annot"><span class="annottext">andD :: Query k v1 -&gt; Query k v2 -&gt; Query k (v1, v2)
</span><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var hs-var">andD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679126323"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126322"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679126322"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126321"><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679126321"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v
-&gt; Query k v2 -&gt; Fun (k -&gt; (v, v2) -&gt; (v1, v2)) -&gt; Query k (v1, v2)
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126323"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679126321"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
-&gt; Fun (k -&gt; v -&gt; v1) -&gt; Fun (k -&gt; (v, v2) -&gt; (v1, v2))
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var">compSndL</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679126322"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-965"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span id="local-6989586621679126320"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126320"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679126319"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126319"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126318"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v2)
</span><a href="#local-6989586621679126318"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1
-&gt; Query k v -&gt; Fun (k -&gt; (v1, v) -&gt; (v1, v2)) -&gt; Query k (v1, v2)
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126320"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126319"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
-&gt; Fun (k -&gt; v -&gt; v2) -&gt; Fun (k -&gt; (v1, v) -&gt; (v1, v2))
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; b) -&gt; Fun (k -&gt; (a, d) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-var">compSndR</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v2)
</span><a href="#local-6989586621679126318"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span id="local-6989586621679126317"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126317"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126316"><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679126316"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1 -&gt; Query k v2 -&gt; Query k (v1, v2)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679126316"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span id="local-6989586621679129263"><span id="local-6989586621679129264"><span id="local-6989586621679129265"><span id="local-6989586621679129266"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-type">andPD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129266"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129266"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129265"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129266"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129264"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129266"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129265"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129264"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129263"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129266"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129263"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-969"></span><span id="andPD"><span class="annot"><span class="annottext">andPD :: Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var hs-var">andPD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679126315"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126315"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126314"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679126314"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126313"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126313"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126312"><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679126312"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; v) -&gt; Query k v
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126313"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
-&gt; Fun (k -&gt; v -&gt; v1) -&gt; Fun (k -&gt; (v, u) -&gt; v)
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var">compSndL</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679126312"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679126314"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span id="local-6989586621679126311"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126311"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126310"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126310"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126309"><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679126309"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679126311"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126310"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679126309"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-971"></span><span>
</span><span id="line-972"></span><span id="local-6989586621679129227"><span id="local-6989586621679129228"><span id="local-6989586621679129229"><span id="local-6989586621679129230"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-type">chainD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129230"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129229"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129229"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129229"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129228"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129229"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129228"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129227"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129227"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-973"></span><span id="chainD"><span class="annot"><span class="annottext">chainD :: Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var hs-var">chainD</span></a></span></span><span> </span><span id="local-6989586621679126307"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126307"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679126306"><span class="annot"><span class="annottext">Query v v
</span><a href="#local-6989586621679126306"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126305"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; w)
</span><a href="#local-6989586621679126305"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126304"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679126304"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v v -&gt; Fun (k -&gt; (v, v) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126307"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query v v
</span><a href="#local-6989586621679126306"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
-&gt; Fun (v -&gt; v -&gt; w) -&gt; Fun (k -&gt; (v, v) -&gt; u)
forall k a b d c.
Fun (k -&gt; (a, b) -&gt; d)
-&gt; Fun (a -&gt; c -&gt; b) -&gt; Fun (k -&gt; (a, c) -&gt; d)
</span><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-var">compCurryR</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679126304"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; w)
</span><a href="#local-6989586621679126305"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span id="local-6989586621679126303"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126303"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126302"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679126302"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126301"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679126301"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126303"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679126302"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679126301"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-975"></span><span>
</span><span id="line-976"></span><span id="local-6989586621679126299"><span id="local-6989586621679126300"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-type">guardD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126300"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126300"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126299"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126300"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126299"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126300"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126299"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-977"></span><span id="guardD"><span class="annot"><span class="annottext">guardD :: Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-var hs-var">guardD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679126297"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126297"><span class="hs-identifier hs-var">q1</span></a></span></span><span> </span><span id="local-6989586621679126296"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126296"><span class="hs-identifier hs-var">test1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126295"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126295"><span class="hs-identifier hs-var">test2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126297"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
-&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall a b.
Fun (a -&gt; b -&gt; Bool)
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126296"><span class="hs-identifier hs-var">test1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126295"><span class="hs-identifier hs-var">test2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-var">guardD</span></a></span><span> </span><span id="local-6989586621679126294"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126294"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span id="local-6989586621679126293"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126293"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126294"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679126293"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-979"></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-983"></span><span class="hs-comment">-- | Compile the (Exp (f k v)) to a Query iterator, and a BaseRep that indicates</span><span>
</span><span id="line-984"></span><span class="hs-comment">--   how to materialize the iterator to the correct type. Recall the iterator</span><span>
</span><span id="line-985"></span><span class="hs-comment">--   can be used to constuct many things using runCollect, but here we want</span><span>
</span><span id="line-986"></span><span class="hs-comment">--   to materialize it to the same type as the (Exp (f k v)), i.e. (f k v).</span><span>
</span><span id="line-987"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span id="local-6989586621679129061"><span id="local-6989586621679129062"><span id="local-6989586621679129063"><span id="local-6989586621679129064"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-type">compileSubterm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129063"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129062"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129061"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129062"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129061"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-990"></span><span id="compileSubterm"><span class="annot"><span class="annottext">compileSubterm :: Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var hs-var">compileSubterm</span></a></span></span><span> </span><span id="local-6989586621679126291"><span class="annot"><span class="annottext">Exp a
</span><a href="#local-6989586621679126291"><span class="hs-identifier hs-var">_whole</span></a></span></span><span> </span><span id="local-6989586621679126290"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126290"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126290"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span id="local-6989586621679129209"><span id="local-6989586621679129210"><span id="local-6989586621679129211"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129211"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129210"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129209"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129210"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129209"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129211"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129210"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129209"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-993"></span><span id="compile"><span class="annot"><span class="annottext">compile :: Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126288"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126288"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126287"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126287"><span class="hs-identifier hs-var">relation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep f k v -&gt; f k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126288"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126287"><span class="hs-identifier hs-var">relation</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126288"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126286"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126286"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679126285"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126285"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126286"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126285"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126284"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126284"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Single k () -&gt; Single k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k ()
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126284"><span class="hs-identifier hs-var">d</span></a></span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126283"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126283"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Sett k ()
</span><a href="#local-6989586621679126283"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-997"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126282"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126282"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126281"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126281"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126282"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126280"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126280"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126280"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span id="local-6989586621679126279"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126279"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; ()) -&gt; Query k ()
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126279"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Fun (k -&gt; v -&gt; ())
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126278"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126278"><span class="hs-identifier hs-var">_rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett () () -&gt; Sett () () -&gt; Query () ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett () ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126277"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126277"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126276"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126276"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Sett v () -&gt; Query v ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126276"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1002"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126275"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126275"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett () () -&gt; Sett () () -&gt; Query () ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett () ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span id="local-6989586621679126274"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126274"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Sett v () -&gt; Query v ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Sett v ()
forall v k. Ord v =&gt; Query k v -&gt; Sett v ()
</span><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-var">rngStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126274"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- We really ought to memoize this. It might be computed many times.</span><span>
</span><span id="line-1004"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679126272"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126272"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679126271"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126271"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k ((), v) -&gt; Fun (k -&gt; ((), v) -&gt; v) -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k () -&gt; Query k v -&gt; Query k ((), v)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k (), BaseRep g k ()) -&gt; Query k ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; (Query k (), BaseRep g k ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126272"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126270"><span class="hs-identifier hs-var">reld</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; ((), v) -&gt; v)
forall x a b. Fun (x -&gt; (a, b) -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-var">rngSnd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126269"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126270"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126270"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126269"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126269"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126271"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1006"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679126268"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126268"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679126267"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126267"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k () -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126266"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k (), BaseRep g k ()) -&gt; Query k ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; (Query k (), BaseRep g k ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126268"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126265"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>       </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126266"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126266"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126265"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126265"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126267"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1008"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span id="local-6989586621679126264"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126264"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679126263"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126263"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1009"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126264"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126263"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1010"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679126262"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126262"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126261"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126261"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f v ()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126260"><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679126260"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126262"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679126260"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126261"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679126259"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126259"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126258"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126258"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679126257"><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679126257"><span class="hs-identifier hs-var">setd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query v () -&gt; Fun (k -&gt; (v, ()) -&gt; v) -&gt; Query k v
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126259"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679126257"><span class="hs-identifier hs-var">setd</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, ()) -&gt; v)
forall x a b. Fun (x -&gt; (a, b) -&gt; a)
</span><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-var">rngFst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126258"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span id="local-6989586621679126256"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126256"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679126255"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126255"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1013"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126256"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126255"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1014"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679126254"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126254"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126253"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126253"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f v ()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126252"><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679126252"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126254"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall k v. Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var">nEgate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679126252"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126253"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679126251"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126251"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126250"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126250"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Query v (), BaseRep g v ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126251"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall k v. Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var">nEgate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; g v ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126255"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126250"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- This could be expensive</span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span id="local-6989586621679126248"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126248"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679126247"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679126247"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126246"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep g k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k v) -&gt; (Query k v, BaseRep g k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679126247"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; v)
</span><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126245"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- first uses value from rel1 to override value from rel2</span><span>
</span><span id="line-1018"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126246"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126246"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126245"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126245"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126248"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1019"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span id="local-6989586621679126244"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126244"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679126243"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679126243"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126242"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep g k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k v) -&gt; (Query k v, BaseRep g k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679126243"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679126241"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- second uses value from rel2 to override value from rel1</span><span>
</span><span id="line-1020"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126242"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126242"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126241"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126241"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126244"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1021"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span id="local-6989586621679126240"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679126240"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679126239"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679126239"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k n -&gt; Query k n -&gt; Fun (n -&gt; n -&gt; n) -&gt; Query k n
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k n
</span><a href="#local-6989586621679126238"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k n, BaseRep f k n) -&gt; Query k n
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k n) -&gt; (Query k n, BaseRep f k n)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679126239"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (n -&gt; n -&gt; n)
forall t. Monoid t =&gt; Fun (t -&gt; t -&gt; t)
</span><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k n
</span><a href="#local-6989586621679126237"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126238"><span class="annot"><span class="annottext">Query k n
</span><a href="#local-6989586621679126238"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126237"><span class="annot"><span class="annottext">BaseRep f k n
</span><a href="#local-6989586621679126237"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; (Query k n, BaseRep f k n)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679126240"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1023"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span id="local-6989586621679126236"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126236"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679126235"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126235"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; ()) -&gt; Query k ()
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126236"><span class="hs-identifier hs-var">rel1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k u, BaseRep g k u) -&gt; Query k u
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k u) -&gt; (Query k u, BaseRep g k u)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126235"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Fun (k -&gt; (v, u) -&gt; ())
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-1026"></span><span class="hs-comment">-- run materializes compiled code, only if it is not already data</span><span>
</span><span id="line-1027"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-type">testing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1030"></span><span id="testing"><span class="annot"><span class="annottext">testing :: Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var hs-var">testing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span id="local-6989586621679128912"><span id="local-6989586621679128913"><span id="local-6989586621679128914"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-type">runSetExp</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679128914"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128913"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128914"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128912"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128913"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128914"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128912"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1033"></span><span id="runSetExp"><span class="annot"><span class="annottext">runSetExp :: Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var hs-var">runSetExp</span></a></span></span><span> </span><span id="local-6989586621679126232"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126232"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1034"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var">testing</span></a></span><span>
</span><span id="line-1035"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In Testing mode, SetAlgebra expression: &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126232"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; falls through to slow mode.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; f k v
forall k v (f :: * -&gt; * -&gt; *).
Ord k =&gt;
(Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126232"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- Only for use in the SetAlgebra internal tests</span><span>
</span><span id="line-1039"></span><span id="local-6989586621679126228"><span id="local-6989586621679126229"><span id="local-6989586621679126230"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runSet"><span class="hs-identifier hs-type">runSet</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679126230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126229"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126228"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126229"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126228"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1040"></span><span id="runSet"><span class="annot"><span class="annottext">runSet :: Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSet"><span class="hs-identifier hs-var hs-var">runSet</span></a></span></span><span> </span><span id="local-6989586621679126226"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126226"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; f k v
forall k v (f :: * -&gt; * -&gt; *).
Ord k =&gt;
(Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126226"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span id="local-6989586621679129098"><span id="local-6989586621679129099"><span id="local-6989586621679129100"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129100"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129100"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129099"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129098"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129100"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129099"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129098"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129100"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129099"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1043"></span><span id="run"><span class="annot"><span class="annottext">run :: (Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126225"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126225"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126225"><span class="hs-identifier hs-var">x</span></a></span><span>               </span><span class="hs-comment">-- If it is already data (BaseD)</span><span>
</span><span id="line-1044"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126224"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126224"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126224"><span class="hs-identifier hs-var">x</span></a></span><span>               </span><span class="hs-comment">-- and in the right form (the BaseRep's match)</span><span>
</span><span id="line-1045"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679126223"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126223"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126223"><span class="hs-identifier hs-var">x</span></a></span><span>         </span><span class="hs-comment">-- just return the data</span><span>
</span><span id="line-1046"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126222"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126222"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126222"><span class="hs-identifier hs-var">x</span></a></span><span>           </span><span class="hs-comment">-- only need to materialize data</span><span>
</span><span id="line-1047"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679126221"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126221"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126221"><span class="hs-identifier hs-var">x</span></a></span><span>             </span><span class="hs-comment">-- if the forms do not match.</span><span>
</span><span id="line-1048"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679126220"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126220"><span class="hs-identifier hs-var">_source</span></a></span></span><span> </span><span id="local-6989586621679126219"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126219"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; Collect (k, v) -&gt; List k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126219"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- use fifo, since the order matters for Lists.</span><span>
</span><span id="line-1049"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679126218"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126218"><span class="hs-identifier hs-var">_source</span></a></span></span><span> </span><span id="local-6989586621679126217"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126217"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126216"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126216"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126216"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126217"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- use lifo, for others</span><span>
</span><span id="line-1050"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126215"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126215"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; Collect (k, v) -&gt; List k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126215"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- If it is a compund Iterator, for List, than materialize it using fifo</span><span>
</span><span id="line-1051"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126214"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126214"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126213"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126213"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126213"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126214"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- If it is a compund Iterator, for anything else than materialize it using lifo</span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-type">runBoolExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1054"></span><span id="runBoolExp"><span class="annot"><span class="annottext">runBoolExp :: Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var hs-var">runBoolExp</span></a></span></span><span> </span><span id="local-6989586621679126211"><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126211"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1055"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var">testing</span></a></span><span>
</span><span id="line-1056"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In Testing mode, SetAlgebra expression: &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp Bool -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126211"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; falls through to slow mode.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126211"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- Only for use inthe SetAlgebra internal tests</span><span>
</span><span id="line-1060"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-type">runBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1061"></span><span id="runBool"><span class="annot"><span class="annottext">runBool :: Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var hs-var">runBool</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679126209"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126209"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126208"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126208"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; g k () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126209"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126208"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1062"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679126207"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126207"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126206"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126206"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; g k () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126207"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126206"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126205"><span class="annot"><span class="annottext">w :: Exp Bool
</span><a href="#local-6989586621679126205"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span id="local-6989586621679126204"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126204"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126203"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126203"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-var">sameDomain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (f k v) -&gt; Query k v
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126205"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126204"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (g k u) -&gt; Query k u
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126205"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126203"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1064"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126202"><span class="annot"><span class="annottext">w :: Exp Bool
</span><a href="#local-6989586621679126202"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span id="local-6989586621679126201"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126200"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126200"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v) -&gt; Bool -&gt; ((k, v) -&gt; Bool -&gt; Bool) -&gt; Bool
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679126199"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126198"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126198"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126197"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126197"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126196"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679126196"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Query k u -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126198"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679126195"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679126196"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126199"><span class="annot"><span class="annottext">left :: Query k v
</span><a href="#local-6989586621679126199"><span class="hs-identifier hs-var hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (f k v) -&gt; Query k v
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126202"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679126201"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1066"></span><span>          </span><span id="local-6989586621679126195"><span class="annot"><span class="annottext">right :: Query k u
</span><a href="#local-6989586621679126195"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (g k u) -&gt; Query k u
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679126202"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679126200"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- Evaluate an (Exp t) into real data of type t. Try domain and type specific algorithms first,</span><span>
</span><span id="line-1071"></span><span class="hs-comment">-- and if those fail. Compile the formula as an iterator, then run the iterator to get an answer.</span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- Here are some sample of the type specific algorithms we incorporate</span><span>
</span><span id="line-1073"></span><span class="hs-comment">--  x  &#8712; (dom y)            haskey</span><span>
</span><span id="line-1074"></span><span class="hs-comment">--  x  &#8713; (dom y)            not . haskey</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- x &#8746; (singleton y)        addpair</span><span>
</span><span id="line-1076"></span><span class="hs-comment">-- (Set.singleton x) &#8938; y    removekey</span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- x &#8939; (Set.singleton y)    easy on Bimap  remove val</span><span>
</span><span id="line-1078"></span><span class="hs-comment">-- (dom x) &#8838; (dom y)</span><span>
</span><span id="line-1079"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-1080"></span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span id="local-6989586621679129125"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-type">compute</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129125"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129125"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-1083"></span><span id="compute"><span class="annot"><span class="annottext">compute :: Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var hs-var">compute</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126194"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126194"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126193"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126193"><span class="hs-identifier hs-var">relation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679126193"><span class="hs-identifier hs-var">relation</span></a></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126192"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126192"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679126192"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1086"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126191"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126191"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126191"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126190"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126190"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126189"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126189"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126190"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126188"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126188"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126188"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1089"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126187"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126187"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126186"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126186"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Set k
forall (f :: * -&gt; * -&gt; *) k v. (Basic f, Ord k) =&gt; f k v -&gt; Set k
</span><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126186"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>  </span><span class="hs-comment">-- (dom (Map(62)? &#9655; (setSingleton _ )))</span><span>
</span><span id="line-1091"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126185"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126185"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126184"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126184"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126182"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126185"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126182"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126182"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126181"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126181"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679126180"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126180"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126179"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126179"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126179"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126184"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126180"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126181"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126181"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1093"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126178"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126178"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126177"><span class="annot"><a href="#local-6989586621679126177"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126176"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126178"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126176"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126176"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126175"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126175"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679126174"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126174"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126173"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126173"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126173"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126177"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126174"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126175"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126175"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1095"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126172"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126172"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126171"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126171"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126170"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126172"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126170"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126170"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126169"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126169"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679126168"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126168"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126167"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126167"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126167"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126171"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126168"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126169"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126169"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1097"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126166"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126166"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126165"><span class="annot"><a href="#local-6989586621679126165"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126164"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126166"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126164"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679126164"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126163"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126163"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679126162"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126162"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126161"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126161"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126161"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126165"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126162"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126163"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126163"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1099"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126160"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126160"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126159"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126159"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126158"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126159"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126160"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126158"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126158"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126157"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126156"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679126156"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679126155"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126155"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126157"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126155"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1101"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126154"><span class="annot"><a href="#local-6989586621679126154"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126153"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126153"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126152"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126153"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679126154"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126152"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126152"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126151"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126151"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126150"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679126150"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679126149"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126149"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126151"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126149"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126148"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126148"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126147"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126147"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126146"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126147"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126148"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126146"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126146"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126145"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126145"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126144"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679126144"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679126143"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126143"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126145"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126143"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1106"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126142"><span class="annot"><a href="#local-6989586621679126142"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126141"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126141"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126140"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126141"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679126142"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679126140"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679126140"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679126139"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126139"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126138"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679126138"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679126137"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126137"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126139"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679126137"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126136"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126136"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett k ())
</span><a href="#local-6989586621679126136"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126135"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126135"><span class="hs-identifier hs-var">_rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126134"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126134"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126133"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126133"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126133"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126132"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126132"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1113"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126131"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126131"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126130"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126130"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Set v
forall (f :: * -&gt; * -&gt; *) v k. (Basic f, Ord v) =&gt; f k v -&gt; Set v
</span><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126130"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126129"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126129"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett v ()) -&gt; Sett v ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett v ())
</span><a href="#local-6989586621679126129"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126128"><span class="annot"><a href="#local-6989586621679126128"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126127"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126127"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126127"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679126128"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-1117"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126125"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126125"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126124"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126124"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126124"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126125"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126123"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126123"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126122"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126122"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126121"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126121"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126121"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126123"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126120"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126120"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126119"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126119"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.intersection</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126119"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126120"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span class="hs-comment">-- This case inspired by set expression in EpochBoundary.hs</span><span>
</span><span id="line-1122"></span><span>   </span><span class="hs-comment">-- (dom (delegs &#9655; Set.singleton hk) &#9665; stake) in EpochBoundart.hs</span><span>
</span><span id="line-1123"></span><span>   </span><span class="hs-comment">-- ((dom (Map(62)? &#9655; (setSingleton _ ))) &#9665; Map(63)?) which has this structure</span><span>
</span><span id="line-1124"></span><span>   </span><span class="hs-comment">-- materialize MapR (do { (x,y,z) &lt;- delegs `domEq` stake; when (y==hk); one(x,z) })</span><span>
</span><span id="line-1125"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126117"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126117"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126116"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126116"><span class="hs-identifier hs-var">hk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126115"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126115"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1126"></span><span>   </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k v
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126114"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126114"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126113"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126113"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126113"><span class="hs-identifier hs-var">v2</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126116"><span class="hs-identifier hs-var">hk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126115"><span class="hs-identifier hs-var">stake</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126117"><span class="hs-identifier hs-var">delegs</span></a></span><span>
</span><span id="line-1127"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126112"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126112"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126111"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126111"><span class="hs-identifier hs-var">rngf</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126110"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126110"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1128"></span><span>   </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k v
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126109"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126109"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126108"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126108"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126108"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126111"><span class="hs-identifier hs-var">rngf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126110"><span class="hs-identifier hs-var">stake</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126112"><span class="hs-identifier hs-var">delegs</span></a></span><span>
</span><span id="line-1129"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679126107"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126107"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126106"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126106"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126106"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126105"><span class="hs-identifier hs-var">set2</span></a></span><span> </span><span class="hs-comment">-- Pay the cost of materializing set to use O(n* log n) restictKeys</span><span>
</span><span id="line-1130"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126105"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126105"><span class="hs-identifier hs-var">set2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Collect (k, ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g k () -&gt; Collect (k, ())
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679126107"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126104"><span class="annot"><a href="#local-6989586621679126104"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126103"><span class="annot"><a href="#local-6989586621679126103"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126104"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679126103"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679126101"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126101"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126100"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126100"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126099"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126099"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126100"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126098"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126098"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126097"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126097"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126101"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126099"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126098"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126097"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1134"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126096"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126096"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126095"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126095"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126094"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126094"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126095"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126093"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126093"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126092"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126092"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126096"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126094"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126093"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126092"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1135"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126091"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126091"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126090"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126090"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126089"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126089"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126090"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126088"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126088"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126087"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126087"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126091"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k () -&gt; f k v -&gt; Collect (k, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126089"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126088"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126087"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1136"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126086"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126086"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126085"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126085"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126084"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126084"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126085"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126083"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126083"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126082"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126086"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k () -&gt; f k v -&gt; Collect (k, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126084"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126083"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1137"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126081"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126081"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126080"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126080"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126079"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126079"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126080"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126078"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126078"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126077"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126077"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Single v ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126081"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single v () -&gt; f v v -&gt; Collect (v, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679126079"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(v, v) -&gt; Collect (v, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126078"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126077"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1138"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126076"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126076"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679126076"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126075"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126075"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126074"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126074"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126074"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126075"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126072"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126072"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679126071"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126071"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126070"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126070"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126070"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126072"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1142"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126069"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126069"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span id="local-6989586621679126068"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126068"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126067"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126067"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126067"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126068"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126066"><span class="annot"><a href="#local-6989586621679126066"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126065"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126065"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126065"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679126066"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-1144"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126064"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126064"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126063"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126063"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126063"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126064"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-1145"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126062"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126062"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126061"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126061"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126062"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126061"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1146"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126060"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126060"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126059"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126059"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126060"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126059"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1147"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126058"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126058"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126057"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126057"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; f v v -&gt; f v v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126058"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679126057"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1148"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126056"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126055"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126055"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126054"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126054"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; BiMap k k k -&gt; BiMap k k k
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126054"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap k k k
</span><a href="#local-6989586621679126055"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1151"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126053"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126053"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126052"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126052"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679126051"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126051"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; BiMap k k k -&gt; BiMap k k k
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126052"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap k k k
</span><a href="#local-6989586621679126053"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1152"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679126050"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126050"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126049"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126049"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126048"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126048"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; BiMap v k v -&gt; BiMap v k v
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126048"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap v k v
</span><a href="#local-6989586621679126050"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1153"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126047"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126047"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126046"><span class="annot"><a href="#local-6989586621679126046"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126044"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126044"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126046"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126047"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1154"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126043"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126043"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126042"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126042"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (k -&gt; Bool) -&gt; k -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126042"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126043"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1155"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126040"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126040"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126039"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126039"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679126038"><span class="annot"><a href="#local-6989586621679126038"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679126038"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679126039"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126037"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126037"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126036"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126036"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679126036"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1157"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126035"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126035"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679126034"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126034"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679126033"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126033"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1158"></span><span>   </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126035"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126032"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126032"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679126031"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126031"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126034"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Query v () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126031"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Query v ()
Query v ()
</span><a href="#local-6989586621679126030"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126032"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126031"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126030"><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679126030"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679126033"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1159"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126029"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126029"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679126029"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1160"></span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- (dom (Map(16)? &#9655; (setSingleton _ )))</span><span>
</span><span id="line-1162"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126028"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126028"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679126027"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126027"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126026"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126026"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126026"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126027"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126028"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1163"></span><span class="hs-comment">-- ((dom rewards' &#9665; delegs) &#9655; dom poolParams)  in LedgerState.hs</span><span>
</span><span id="line-1164"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126025"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126025"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126024"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126024"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679126023"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126023"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k k
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679126022"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126022"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679126021"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126021"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126021"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126023"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679126025"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679126024"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1165"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126019"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126019"><span class="hs-identifier hs-var">_r1</span></a></span></span><span> </span><span id="local-6989586621679126018"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126018"><span class="hs-identifier hs-var">stkcreds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126017"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126017"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621679126016"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126016"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126015"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126015"><span class="hs-identifier hs-var">_r3</span></a></span></span><span> </span><span id="local-6989586621679126014"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126014"><span class="hs-identifier hs-var">stpools</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1166"></span><span>   </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126017"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126013"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126013"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679126012"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126012"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126018"><span class="hs-identifier hs-var">stkcreds</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126016"><span class="hs-identifier hs-var">delegs</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126012"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; f v v -&gt; Collect ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
k -&gt; f k v -&gt; Collect ()
</span><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-operator hs-var">`element`</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679126014"><span class="hs-identifier hs-var">stpools</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126013"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126012"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1167"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126011"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679126011"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679126011"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679126010"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126010"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126009"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126009"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126008"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126008"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126008"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1170"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679126007"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126007"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679126006"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679126006"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679126005"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679126005"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126007"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679126005"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1171"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679126004"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126004"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679126003"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126003"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679126002"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126002"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126004"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679126003"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679126001"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126001"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126000"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679126000"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679126001"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
v
</span><a href="#local-6989586621679126000"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1173"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125999"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125999"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679125998"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125998"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125999"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679125998"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1174"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125997"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125997"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125996"><span class="annot"><a href="#local-6989586621679125996"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125995"><span class="annot"><a href="#local-6989586621679125995"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125997"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125996"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125997"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125995"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1175"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125993"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125993"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125992"><span class="annot"><a href="#local-6989586621679125992"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125991"><span class="annot"><a href="#local-6989586621679125991"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125993"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125992"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125993"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125991"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1176"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125990"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125990"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125989"><span class="annot"><a href="#local-6989586621679125989"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125988"><span class="annot"><a href="#local-6989586621679125988"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125990"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125989"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125990"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125988"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125987"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125987"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125986"><span class="annot"><a href="#local-6989586621679125986"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125985"><span class="annot"><a href="#local-6989586621679125985"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125987"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125986"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125987"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125985"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125984"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125984"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679125983"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125983"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679125982"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125982"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125984"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
Exp (g k ())
</span><a href="#local-6989586621679125983"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (f k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125984"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k ())
Exp (f k v)
</span><a href="#local-6989586621679125982"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1179"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125981"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125981"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679125980"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125980"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679125979"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125979"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125981"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
Exp (g k ())
</span><a href="#local-6989586621679125980"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (f k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125981"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k ())
Exp (f k v)
</span><a href="#local-6989586621679125979"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125978"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125978"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679125978"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1181"></span><span>
</span><span id="line-1182"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125977"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125977"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679125976"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125976"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679125975"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125975"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125977"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679125975"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125974"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679125973"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125973"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679125972"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125972"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679125972"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1184"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125971"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125971"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679125970"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125970"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679125969"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125969"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125971"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679125970"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1185"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125968"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125968"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679125967"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125967"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125968"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
v
</span><a href="#local-6989586621679125967"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1186"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125966"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125966"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679125965"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125965"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125966"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679125965"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125964"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125964"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125963"><span class="annot"><a href="#local-6989586621679125963"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125962"><span class="annot"><a href="#local-6989586621679125962"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125964"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125963"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125964"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125962"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1188"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125961"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125961"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125960"><span class="annot"><a href="#local-6989586621679125960"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125959"><span class="annot"><a href="#local-6989586621679125959"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125961"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125960"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125961"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125959"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1189"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125958"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125958"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125957"><span class="annot"><a href="#local-6989586621679125957"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125956"><span class="annot"><a href="#local-6989586621679125956"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125958"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125957"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125958"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125956"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1190"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125955"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125955"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125954"><span class="annot"><a href="#local-6989586621679125954"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125953"><span class="annot"><a href="#local-6989586621679125953"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125955"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125954"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125955"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125953"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1191"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125952"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125952"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679125952"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125951"><span class="annot"><a href="#local-6989586621679125951"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125950"><span class="annot"><a href="#local-6989586621679125950"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.isSubsetOf</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125951"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125950"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1194"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125948"><span class="annot"><a href="#local-6989586621679125948"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125947"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125947"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Set k -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125947"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125948"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1195"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125945"><span class="annot"><a href="#local-6989586621679125945"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125944"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125944"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Set k -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125944"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125945"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1196"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125943"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125943"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125942"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125942"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map k v -&gt; Bool
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679125941"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125943"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1197"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679125941"><span class="annot"><span class="annottext">accum :: k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679125941"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679125940"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125940"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125939"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125939"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679125938"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679125938"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125940"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125942"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679125938"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1198"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125937"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125937"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125936"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125936"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map k v -&gt; Bool
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679125935"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125937"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1199"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679125935"><span class="annot"><span class="annottext">accum :: k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679125935"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679125934"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125934"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125933"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125933"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679125932"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679125932"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125934"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125936"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679125932"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1200"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125931"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125931"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679125931"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1201"></span><span>
</span><span id="line-1202"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125930"><span class="annot"><a href="#local-6989586621679125930"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125929"><span class="annot"><a href="#local-6989586621679125929"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125930"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125929"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125928"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125928"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125927"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125927"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.intersection</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125928"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125927"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1204"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125926"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125926"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett k ())
</span><a href="#local-6989586621679125926"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1205"></span><span>
</span><span id="line-1206"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679125925"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125925"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679125924"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125924"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679125923"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125923"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125922"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125922"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125923"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125922"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679125924"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679125921"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125921"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679125920"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125920"><span class="hs-identifier hs-var">_new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125921"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The value on the left is preferred over the right, so 'addkv' chooses 'old'</span><span>
</span><span id="line-1207"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125919"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125919"><span class="hs-identifier hs-var">d0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125918"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125918"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125919"><span class="hs-identifier hs-var">d0</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125918"><span class="hs-identifier hs-var">d1</span></a></span><span>  </span><span class="hs-comment">-- 'Map.union' is left biased, just what we want.</span><span>
</span><span id="line-1208"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125916"><span class="annot"><a href="#local-6989586621679125916"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125915"><span class="annot"><a href="#local-6989586621679125915"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125916"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125915"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679125914"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125914"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125913"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125913"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125912"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125912"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125914"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125913"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125912"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1210"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125911"><span class="annot"><a href="#local-6989586621679125911"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125910"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125910"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125909"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125909"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125910"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125911"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125909"><span class="hs-identifier hs-var">m3</span></a></span><span>
</span><span id="line-1211"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125908"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125908"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679125908"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679125907"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125907"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679125906"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125906"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679125905"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125905"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125904"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125904"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125905"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125904"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679125906"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679125903"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125903"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679125902"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125902"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125902"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The value on the right is preferred over the left, so 'addkv' chooses 'new'</span><span>
</span><span id="line-1214"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125901"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125901"><span class="hs-identifier hs-var">d0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125900"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125900"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125900"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125901"><span class="hs-identifier hs-var">d0</span></a></span><span>   </span><span class="hs-comment">-- we pass @d1@ as first argument, since 'Map.union' is left biased.</span><span>
</span><span id="line-1215"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125899"><span class="annot"><a href="#local-6989586621679125899"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125898"><span class="annot"><a href="#local-6989586621679125898"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125899"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125898"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125897"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125897"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679125897"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125896"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125896"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125895"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125895"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125896"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125895"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1219"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125893"><span class="annot"><a href="#local-6989586621679125893"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125892"><span class="annot"><a href="#local-6989586621679125892"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125893"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125892"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Recall (Sett k):: f k (), so () &lt;&gt; () = ()</span><span>
</span><span id="line-1220"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125891"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125891"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; f k n
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k n)
</span><a href="#local-6989586621679125891"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1221"></span><span>
</span><span id="line-1222"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679125890"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125890"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125889"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125889"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125890"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125889"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1223"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679125888"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125888"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125888"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1224"></span><span>
</span><span id="line-1225"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125887"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125887"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125886"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125886"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125887"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125886"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1226"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679125885"><span class="annot"><a href="#local-6989586621679125885"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679125884"><span class="annot"><a href="#local-6989586621679125884"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679125885"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
Map k v
</span><a href="#local-6989586621679125884"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1227"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125883"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125883"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125882"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125882"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125883"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125882"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1228"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679125881"><span class="annot"><a href="#local-6989586621679125881"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679125880"><span class="annot"><a href="#local-6989586621679125880"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679125881"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
Map k v
</span><a href="#local-6989586621679125880"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1229"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125879"><span class="annot"><a href="#local-6989586621679125879"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125878"><span class="annot"><a href="#local-6989586621679125878"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125878"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125879"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1230"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125877"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125877"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125876"><span class="annot"><a href="#local-6989586621679125876"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125877"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679125876"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1231"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125875"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679125875"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679125875"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1232"></span><span>
</span><span id="line-1233"></span><span id="local-6989586621679125873"><span id="local-6989586621679125874"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125874"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125873"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125873"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125874"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-1234"></span><span id="eval"><span class="annot"><span class="annottext">eval :: Exp t -&gt; s
</span><a href="Control.Iterate.SetAlgebra.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679125871"><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679125871"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; s
forall concrete base. Embed concrete base =&gt; base -&gt; concrete
</span><a href="Control.Iterate.SetAlgebra.html#fromBase"><span class="hs-identifier hs-var">fromBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp t -&gt; t
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679125871"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1237"></span><span class="hs-comment">-- To make compound iterators, i.e. instance (Iter Query), we need &quot;step&quot; functions for each kind</span><span>
</span><span id="line-1238"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- ==== Project ====</span><span>
</span><span id="line-1241"></span><span id="local-6989586621679127958"><span id="local-6989586621679127959"><span id="local-6989586621679127960"><span id="local-6989586621679127961"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-type">projStep</span></a></span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1243"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127960"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127959"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127959"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127959"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127958"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127960"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127958"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127961"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127958"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1245"></span><span id="projStep"><span class="annot"><span class="annottext">projStep :: (t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var hs-var">projStep</span></a></span></span><span> </span><span id="local-6989586621679125869"><span class="annot"><span class="annottext">t -&gt; Collect (k, v, Query k v)
</span><a href="#local-6989586621679125869"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679125868"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679125868"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679125867"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125867"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125866"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125865"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125865"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125864"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125864"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t -&gt; Collect (k, v, Query k v)
</span><a href="#local-6989586621679125869"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125867"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, u, Query k u) -&gt; Collect (k, u, Query k u)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; k -&gt; v -&gt; u
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679125868"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125865"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125864"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679125868"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1246"></span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- ===== And = ====</span><span>
</span><span id="line-1248"></span><span id="local-6989586621679128000"><span id="local-6989586621679128001"><span id="local-6989586621679128002"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-type">andStep</span></a></span><span>
</span><span id="line-1249"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1250"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128001"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128001"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1251"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128000"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128000"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128001"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128000"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128002"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128001"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128000"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1252"></span><span id="andStep"><span class="annot"><span class="annottext">andStep :: (a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var hs-var">andStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125862"><span class="annot"><span class="annottext">ftrip :: (a, b1, Query a b1)
</span><a href="#local-6989586621679125862"><span class="hs-identifier hs-var">ftrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125861"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125860"><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679125860"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125859"><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125859"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125858"><span class="annot"><span class="annottext">gtrip :: (a, b2, Query a b2)
</span><a href="#local-6989586621679125858"><span class="hs-identifier hs-var">gtrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125857"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125857"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125856"><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679125856"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125855"><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125855"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1253"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125857"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1254"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, (b1, b2), Query a (b1, b2))
-&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679125860"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679125856"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query a b1 -&gt; Query a b2 -&gt; Query a (b1, b2)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125859"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125855"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125854"><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125854"><span class="hs-identifier hs-var">ftrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b1 -&gt; Collect (a, b1, Query a b1)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125857"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125859"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125854"><span class="hs-identifier hs-var">ftrip'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125858"><span class="hs-identifier hs-var">gtrip</span></a></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1256"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125852"><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125852"><span class="hs-identifier hs-var">gtrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b2 -&gt; Collect (a, b2, Query a b2)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125855"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125862"><span class="hs-identifier hs-var">ftrip</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125852"><span class="hs-identifier hs-var">gtrip'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span class="hs-comment">-- ==== Chain ====</span><span>
</span><span id="line-1259"></span><span id="local-6989586621679127990"><span id="local-6989586621679127991"><span id="local-6989586621679127992"><span id="local-6989586621679127993"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-type">chainStep</span></a></span><span>
</span><span id="line-1260"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127993"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1261"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127993"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127993"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1262"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127993"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127991"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127993"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127991"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127990"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127990"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127990"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1263"></span><span id="chainStep"><span class="annot"><span class="annottext">chainStep :: (a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var hs-var">chainStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125850"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125849"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125849"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125848"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125848"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125847"><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679125847"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125846"><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679125846"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1264"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">b -&gt; Query b w -&gt; Maybe w
forall (f :: * -&gt; * -&gt; *) key rng.
(Iter f, Ord key) =&gt;
key -&gt; f key rng -&gt; Maybe rng
</span><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125849"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679125847"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- recall that the values 'r1' from f, are not iterated in ascending order, only the keys 'd' are ascending</span><span>
</span><span id="line-1265"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679125845"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679125845"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u) -&gt; Collect (a, u, Query a u)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125850"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u) -&gt; a -&gt; (b, w) -&gt; u
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679125846"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125850"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125849"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679125845"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query a b -&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Query a u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125848"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679125847"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679125846"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1266"></span><span>     </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125844"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125844"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125848"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125844"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679125847"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679125846"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1267"></span><span>
</span><span id="line-1268"></span><span>
</span><span id="line-1269"></span><span class="hs-comment">-- ==== And with Projection ====</span><span>
</span><span id="line-1270"></span><span id="local-6989586621679127982"><span id="local-6989586621679127983"><span id="local-6989586621679127984"><span id="local-6989586621679127985"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-type">andPstep</span></a></span><span>
</span><span id="line-1271"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1272"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127984"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127984"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127983"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127983"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127984"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127983"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127982"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127982"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127982"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1276"></span><span id="andPstep"><span class="annot"><span class="annottext">andPstep :: (a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var hs-var">andPstep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125841"><span class="annot"><span class="annottext">ftrip :: (a, b1, Query a b1)
</span><a href="#local-6989586621679125841"><span class="hs-identifier hs-var">ftrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125840"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125839"><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679125839"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125838"><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125838"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125837"><span class="annot"><span class="annottext">gtrip :: (a, b2, Query a b2)
</span><a href="#local-6989586621679125837"><span class="hs-identifier hs-var">gtrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125836"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125836"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125835"><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679125835"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125834"><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125834"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125833"><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679125833"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1277"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125836"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1278"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w) -&gt; Collect (a, w, Query a w)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w) -&gt; a -&gt; (b1, b2) -&gt; w
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679125833"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679125839"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679125835"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query a b1 -&gt; Query a b2 -&gt; Fun (a -&gt; (b1, b2) -&gt; w) -&gt; Query a w
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125838"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125834"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679125833"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125832"><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125832"><span class="hs-identifier hs-var">ftrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b1 -&gt; Collect (a, b1, Query a b1)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125836"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679125838"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125832"><span class="hs-identifier hs-var">ftrip'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125837"><span class="hs-identifier hs-var">gtrip</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679125833"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1280"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125831"><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125831"><span class="hs-identifier hs-var">gtrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b2 -&gt; Collect (a, b2, Query a b2)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679125834"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679125841"><span class="hs-identifier hs-var">ftrip</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679125831"><span class="hs-identifier hs-var">gtrip'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679125833"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1281"></span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- ==== Or with combine ====</span><span>
</span><span id="line-1283"></span><span id="local-6989586621679127949"><span id="local-6989586621679127950"><span id="local-6989586621679127951"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-type">orStep</span></a></span><span>
</span><span id="line-1284"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1285"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1286"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1287"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1288"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127951"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127949"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1290"></span><span id="orStep"><span class="annot"><span class="annottext">orStep :: (Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var hs-var">orStep</span></a></span></span><span> </span><span id="local-6989586621679125829"><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679125829"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679125828"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125827"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125826"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1291"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (a, v, Query k v) -&gt; Maybe (a, v, Query k v)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679125829"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Collect (a, v, Query k v) -&gt; Maybe (a, v, Query k v)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679125829"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- We have to be careful, because if only one has a nxt, there is still an answer</span><span>
</span><span id="line-1292"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (a, v, Query k v)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-1293"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679125825"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125825"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125824"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125824"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125823"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125823"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125825"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125824"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125823"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1294"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679125822"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125822"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125821"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125821"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125820"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125820"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125822"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125821"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125820"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1295"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679125819"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125819"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125818"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125818"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125817"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125817"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679125816"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125816"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125815"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125814"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125814"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1296"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125819"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125816"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1297"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125819"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125818"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125817"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125814"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125819"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125818"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125817"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1299"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125816"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125814"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span class="hs-comment">-- ===== Guard =====</span><span>
</span><span id="line-1302"></span><span id="local-6989586621679127947"><span id="local-6989586621679127948"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-type">guardStep</span></a></span><span>
</span><span id="line-1303"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1304"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1305"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1306"></span><span id="guardStep"><span class="annot"><span class="annottext">guardStep :: (Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var hs-var">guardStep</span></a></span></span><span> </span><span id="local-6989586621679125812"><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125812"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679125811"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125811"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679125810"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125810"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125809"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125809"><span class="hs-identifier hs-var">triple</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125812"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125810"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125808"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125809"><span class="hs-identifier hs-var">triple</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1307"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679125808"><span class="annot"><span class="annottext">loop :: (a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125808"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125807"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125807"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125806"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125806"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125805"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125805"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool) -&gt; a -&gt; b -&gt; Bool
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125811"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125807"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125806"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125807"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125806"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query a b -&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125805"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125811"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125804"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125804"><span class="hs-identifier hs-var">triple</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125805"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125808"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125804"><span class="hs-identifier hs-var">triple</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1308"></span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- ===== Difference by key =====</span><span>
</span><span id="line-1310"></span><span id="local-6989586621679127971"><span id="local-6989586621679127972"><span id="local-6989586621679127973"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-type">diffStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127972"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127972"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127971"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127972"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127973"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127972"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1311"></span><span id="diffStep"><span class="annot"><span class="annottext">diffStep :: (k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var hs-var">diffStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125802"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125801"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125800"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125800"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125799"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125799"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1312"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Collect (k, u, Query k u) -&gt; Maybe (k, u, Query k u)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Query k u -&gt; Collect (k, u, Query k u)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125799"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1313"></span><span>      </span><span class="annot"><span class="annottext">Maybe (k, u, Query k u)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125800"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125799"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- g has nothing to subtract</span><span>
</span><span id="line-1314"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125798"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125797"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679125797"><span class="hs-identifier hs-var">_u2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125796"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125796"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1315"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125795"><span class="annot"><span class="annottext">(k, v, Query k v)
</span><a href="#local-6989586621679125795"><span class="hs-identifier hs-var">tup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v, Query k v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125800"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v)
</span><a href="#local-6989586621679125795"><span class="hs-identifier hs-var">tup</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125796"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1316"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125800"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125799"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1317"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125800"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125799"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- the hasLub guarantees k1 &lt;= k2, so this case is dead code</span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- ========== Rng ====================</span><span>
</span><span id="line-1320"></span><span id="local-6989586621679129159"><span id="local-6989586621679129160"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-type">rngStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129160"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129159"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129160"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129160"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1321"></span><span id="rngStep"><span class="annot"><span class="annottext">rngStep :: Query k v -&gt; Sett v ()
</span><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-var hs-var">rngStep</span></a></span></span><span> </span><span id="local-6989586621679125794"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125794"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Collect (v, ()) -&gt; Sett v ()
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (v, ())
forall (f :: * -&gt; * -&gt; *) a a. Iter f =&gt; f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679125793"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125794"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1322"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679125793"><span class="annot"><span class="annottext">loop :: f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679125793"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679125792"><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679125792"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125791"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125791"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125790"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125789"><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679125789"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a a -&gt; Collect (a, a, f a a)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679125792"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, ()) -&gt; Collect (a, ()) -&gt; Collect (a, ())
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125790"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679125793"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679125789"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1323"></span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- =========================== Now the Iter instance for Query ======================</span><span>
</span><span id="line-1325"></span><span>
</span><span id="line-1326"></span><span id="local-6989586621679127994"><span id="local-6989586621679127995"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-type">nxtQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127994"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127994"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1327"></span><span id="nxtQuery"><span class="annot"><span class="annottext">nxtQuery :: Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var hs-var">nxtQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679125788"><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679125788"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679125787"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125787"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679125786"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125786"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125785"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125785"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125784"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125786"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125785"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f a b -&gt; f a b -&gt; Query a b
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679125788"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1328"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679125783"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125782"><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a v -&gt; Collect (a, v, Query a v))
-&gt; Fun (a -&gt; v -&gt; b) -&gt; Query a v -&gt; Collect (a, b, Query a b)
forall k t v u.
Ord k =&gt;
(t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var">projStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1329"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679125781"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125781"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125780"><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679125780"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125779"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125779"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125781"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679125778"><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679125778"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a w -&gt; Collect (a, w, Query a w)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679125780"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, w, Query a w) -&gt; Collect (a, (v, w), Query a (v, w))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125779"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679125778"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1330"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679125777"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125776"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125776"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125775"><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679125775"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125774"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125774"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125777"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; Query v w -&gt; Fun (a -&gt; (v, w) -&gt; b) -&gt; Collect (a, b, Query a b)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125774"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125776"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679125775"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1331"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679125773"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125773"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125772"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125772"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125771"><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679125771"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125770"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125770"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125773"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679125769"><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679125769"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a u -&gt; Collect (a, u, Query a u)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125772"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, u, Query a u)
-&gt; Fun (a -&gt; (v, u) -&gt; b)
-&gt; Collect (a, b, Query a b)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125770"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679125769"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679125771"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1332"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679125768"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125768"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125767"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125767"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125766"><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679125766"><span class="hs-identifier hs-var">comb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Query a b
-&gt; Query a b
-&gt; Fun (b -&gt; b -&gt; b)
-&gt; Collect (a, b, Query a b)
forall k a v.
(Ord k, Ord a) =&gt;
(Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var">orStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125767"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679125766"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1333"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679125765"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125765"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125764"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125764"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b.
Ord a =&gt;
(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var">guardStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125764"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125765"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1334"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679125763"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125763"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125762"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125762"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125761"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125761"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125763"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Query a u -&gt; Collect (a, b, Query a b)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125761"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125762"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span id="local-6989586621679128003"><span id="local-6989586621679128004"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-type">lubQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679128004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679128004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128003"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679128004"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679128003"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679128003"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1337"></span><span id="lubQuery"><span class="annot"><span class="annottext">lubQuery :: a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var hs-var">lubQuery</span></a></span></span><span> </span><span id="local-6989586621679125760"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125760"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679125759"><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679125759"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679125758"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125758"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679125757"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125757"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125756"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125756"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679125755"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125755"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125760"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125758"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125757"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125756"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f a b -&gt; f a b -&gt; Query a b
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679125759"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679125755"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1338"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125754"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125754"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679125753"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125753"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125752"><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679125752"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a v -&gt; Collect (a, v, Query a v))
-&gt; Fun (a -&gt; v -&gt; b) -&gt; Query a v -&gt; Collect (a, b, Query a b)
forall k t v u.
Ord k =&gt;
(t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var">projStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125754"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679125752"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125753"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1339"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125751"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125751"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679125750"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125750"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125749"><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679125749"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125748"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125748"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125751"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125750"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679125747"><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679125747"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a w -&gt; Collect (a, w, Query a w)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125751"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679125749"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, w, Query a w) -&gt; Collect (a, (v, w), Query a (v, w))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125748"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679125747"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1340"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125746"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125746"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679125745"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125745"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125744"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125744"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125743"><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679125743"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125742"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125742"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125746"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125745"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; Query v w -&gt; Fun (a -&gt; (v, w) -&gt; b) -&gt; Collect (a, b, Query a b)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125742"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125744"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679125743"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1341"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span>  </span><span id="local-6989586621679125741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125741"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679125740"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125740"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125739"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125739"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125738"><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679125738"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125737"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125737"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125741"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679125740"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679125736"><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679125736"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a u -&gt; Collect (a, u, Query a u)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125741"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125739"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, u, Query a u)
-&gt; Fun (a -&gt; (v, u) -&gt; b)
-&gt; Collect (a, b, Query a b)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679125737"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679125736"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679125738"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1342"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125735"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125735"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679125734"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125734"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125733"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125733"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125732"><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679125732"><span class="hs-identifier hs-var">comb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Query a b
-&gt; Query a b
-&gt; Fun (b -&gt; b -&gt; b)
-&gt; Collect (a, b, Query a b)
forall k a v.
(Ord k, Ord a) =&gt;
(Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var">orStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125735"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125734"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125733"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679125732"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1343"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125731"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679125730"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125730"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125729"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125729"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b.
Ord a =&gt;
(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var">guardStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125731"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679125729"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125730"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1344"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679125728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679125727"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125727"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125726"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125726"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679125725"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679125727"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Query a u -&gt; Collect (a, b, Query a b)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679125726"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span>
</span><span id="line-1347"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679125711"><span id="local-6989586621679125713"><span id="local-6989586621679125715"><span id="local-6989586621679125717"><span id="local-6989586621679125719"><span id="local-6989586621679125721"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1348"></span><span>   </span><span id="local-6989586621679125710"><span class="annot"><span class="annottext">nxt :: Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679125710"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span>
</span><span id="line-1349"></span><span>   </span><span id="local-6989586621679125709"><span class="annot"><span class="annottext">lub :: k -&gt; Query k b -&gt; Collect (k, b, Query k b)
</span><a href="#local-6989586621679125709"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Query k b -&gt; Collect (k, b, Query k b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span class="hs-comment">-- =======================================================================================</span><span>
</span><span id="line-1352"></span><span class="hs-comment">-- Finally we make smart constructors for Query, so we can lift un-embedded Base types</span><span>
</span><span id="line-1353"></span><span class="hs-comment">-- into Queries, so programmers don't need to know about List and Sett.</span><span>
</span><span id="line-1354"></span><span>
</span><span id="line-1355"></span><span id="local-6989586621679125705"><span id="local-6989586621679125706"><span id="local-6989586621679125707"><span id="local-6989586621679125708"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projectQ"><span class="hs-identifier hs-type">projectQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125708"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125707"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125706"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125707"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125706"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125705"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125705"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-1356"></span><span id="projectQ"><span class="annot"><span class="annottext">projectQ :: c -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projectQ"><span class="hs-identifier hs-var hs-var">projectQ</span></a></span></span><span> </span><span id="local-6989586621679125703"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679125703"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679125702"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679125702"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679125703"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679125702"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-1357"></span><span>
</span><span id="line-1358"></span><span id="local-6989586621679125696"><span id="local-6989586621679125697"><span id="local-6989586621679125698"><span id="local-6989586621679125699"><span id="local-6989586621679125700"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andQ"><span class="hs-identifier hs-type">andQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125700"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125699"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125700"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125698"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125697"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125700"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125696"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125699"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125697"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125700"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125698"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679125696"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1359"></span><span id="andQ"><span class="annot"><span class="annottext">andQ :: concrete1 -&gt; concrete2 -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#andQ"><span class="hs-identifier hs-var hs-var">andQ</span></a></span></span><span> </span><span id="local-6989586621679125694"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125694"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125693"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125693"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k w -&gt; Query k (v, w)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125694"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k w
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125693"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1360"></span><span>
</span><span id="line-1361"></span><span id="local-6989586621679125689"><span id="local-6989586621679125690"><span id="local-6989586621679125691"><span id="local-6989586621679125692"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#orQ"><span class="hs-identifier hs-type">orQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1362"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125692"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125691"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125692"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125689"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125692"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1363"></span><span>  </span><span class="annot"><a href="#local-6989586621679125691"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125689"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125692"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125690"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-1364"></span><span id="orQ"><span class="annot"><span class="annottext">orQ :: concrete1 -&gt; concrete2 -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#orQ"><span class="hs-identifier hs-var hs-var">orQ</span></a></span></span><span> </span><span id="local-6989586621679125687"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125687"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125686"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125686"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125685"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125685"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125687"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125686"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125685"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1365"></span><span>
</span><span id="line-1366"></span><span id="local-6989586621679125679"><span id="local-6989586621679125680"><span id="local-6989586621679125681"><span id="local-6989586621679125682"><span id="local-6989586621679125683"><span id="local-6989586621679125684"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainQ"><span class="hs-identifier hs-type">chainQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1367"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125684"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125683"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125682"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125684"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125683"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125681"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125683"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125680"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1368"></span><span>   </span><span class="annot"><a href="#local-6989586621679125682"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125681"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125684"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125683"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679125680"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125679"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125684"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125679"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1369"></span><span id="chainQ"><span class="annot"><span class="annottext">chainQ :: concrete1 -&gt; concrete2 -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainQ"><span class="hs-identifier hs-var hs-var">chainQ</span></a></span></span><span> </span><span id="local-6989586621679125677"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125676"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125676"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125675"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679125675"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125677"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query v w
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125676"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679125675"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1370"></span><span>
</span><span id="line-1371"></span><span id="local-6989586621679125669"><span id="local-6989586621679125670"><span id="local-6989586621679125671"><span id="local-6989586621679125672"><span id="local-6989586621679125673"><span id="local-6989586621679125674"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPQ"><span class="hs-identifier hs-type">andPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1372"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125674"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125673"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125672"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125671"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125670"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1373"></span><span>   </span><span class="annot"><a href="#local-6989586621679125673"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125671"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125672"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679125670"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125669"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125669"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1374"></span><span id="andPQ"><span class="annot"><span class="annottext">andPQ :: concrete1 -&gt; concrete2 -&gt; Fun (k -&gt; (v, u) -&gt; w) -&gt; Query k w
</span><a href="Control.Iterate.SetAlgebra.html#andPQ"><span class="hs-identifier hs-var hs-var">andPQ</span></a></span></span><span> </span><span id="local-6989586621679125667"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125666"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125666"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125665"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; w)
</span><a href="#local-6989586621679125665"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; w) -&gt; Query k w
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679125667"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k u
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679125666"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; w)
</span><a href="#local-6989586621679125665"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1375"></span><span>
</span><span id="line-1376"></span><span id="local-6989586621679125662"><span id="local-6989586621679125663"><span id="local-6989586621679125664"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardQ"><span class="hs-identifier hs-type">guardQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1377"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125664"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125663"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125664"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125662"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1378"></span><span>   </span><span class="annot"><a href="#local-6989586621679125663"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125664"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125662"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125664"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125662"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1379"></span><span id="guardQ"><span class="annot"><span class="annottext">guardQ :: concrete -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#guardQ"><span class="hs-identifier hs-var hs-var">guardQ</span></a></span></span><span> </span><span id="local-6989586621679125660"><span class="annot"><span class="annottext">concrete
</span><a href="#local-6989586621679125660"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125659"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679125659"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete
</span><a href="#local-6989586621679125660"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679125659"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span class="hs-comment">-- Don't know why this won't type check</span><span>
</span><span id="line-1382"></span><span class="hs-comment">-- diffQ :: (Ord k, HasQuery concrete1 k v, HasQuery concrete2 k u) =&gt; concrete1 -&gt; concrete2 -&gt; Query k v</span><span>
</span><span id="line-1383"></span><span class="hs-comment">-- diffQ = \ x y -&gt; DiffD (query x) (query y)</span><span>
</span><span id="line-1384"></span><span>
</span><span id="line-1385"></span><span class="hs-keyword">class</span><span> </span><span id="HasQuery"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-var">HasQuery</span></a></span></span><span> </span><span id="local-6989586621679127914"><span class="annot"><a href="#local-6989586621679127914"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679127913"><span class="annot"><a href="#local-6989586621679127913"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127912"><span class="annot"><a href="#local-6989586621679127912"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1386"></span><span>  </span><span id="query"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679127914"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127913"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127912"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span id="local-6989586621679125657"><span id="local-6989586621679125658"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125657"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679125658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125657"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1389"></span><span>   </span><span id="local-6989586621679125654"><span class="annot"><span class="annottext">query :: Query k v -&gt; Query k v
</span><a href="#local-6989586621679125654"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125653"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125653"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125653"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span id="local-6989586621679125651"><span id="local-6989586621679125652"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125652"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679125651"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679125652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125651"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1392"></span><span>   </span><span id="local-6989586621679125649"><span class="annot"><span class="annottext">query :: [(k, v)] -&gt; Query k v
</span><a href="#local-6989586621679125649"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125648"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679125648"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; List k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679125647"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125647"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679125646"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125646"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679125647"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679125648"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1393"></span><span>
</span><span id="line-1394"></span><span id="local-6989586621679125645"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125645"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679125645"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679125645"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1395"></span><span>   </span><span id="local-6989586621679125643"><span class="annot"><span class="annottext">query :: Set k -&gt; Query k ()
</span><a href="#local-6989586621679125643"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125642"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125642"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125642"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span id="local-6989586621679125640"><span id="local-6989586621679125641"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679125641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125640"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679125641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125640"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1398"></span><span>   </span><span id="local-6989586621679125638"><span class="annot"><span class="annottext">query :: Map k v -&gt; Query k v
</span><a href="#local-6989586621679125638"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125637"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679125637"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v -&gt; Map k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v
forall k v. Basic Map =&gt; BaseRep Map k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679125637"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span id="local-6989586621679125635"><span id="local-6989586621679125636"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125636"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125635"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125636"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679125635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1401"></span><span>   </span><span id="local-6989586621679125633"><span class="annot"><span class="annottext">query :: BiMap v k v -&gt; Query k v
</span><a href="#local-6989586621679125633"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125632"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679125632"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v -&gt; BiMap v k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v
forall v k. (Basic (BiMap v), Ord v) =&gt; BaseRep (BiMap v) k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679125632"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span id="local-6989586621679125630"><span id="local-6989586621679125631"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679125631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125630"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679125631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125630"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1404"></span><span>   </span><span id="local-6989586621679125628"><span class="annot"><span class="annottext">query :: Single k v -&gt; Query k v
</span><a href="#local-6989586621679125628"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679125627"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679125627"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679125627"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1405"></span><span>
</span><span id="line-1406"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- Show Instances</span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span id="local-6989586621679125624"><span id="local-6989586621679125625"><span id="local-6989586621679125626"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679125619"><span id="local-6989586621679125622"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125626"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125625"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125624"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1411"></span><span>  </span><span id="local-6989586621679125618"><span class="annot"><span class="annottext">show :: BaseRep f k v -&gt; [Char]
</span><a href="#local-6989586621679125618"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map&quot;</span></span><span>
</span><span id="line-1412"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Set&quot;</span></span><span>
</span><span id="line-1413"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;List&quot;</span></span><span>
</span><span id="line-1414"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Single&quot;</span></span><span>
</span><span id="line-1415"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BiMap&quot;</span></span></span></span></span><span>
</span><span id="line-1416"></span><span>
</span><span id="line-1417"></span><span id="local-6989586621679125617"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679125612"><span id="local-6989586621679125615"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125617"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1418"></span><span>  </span><span id="local-6989586621679125611"><span class="annot"><span class="annottext">show :: Exp t -&gt; [Char]
</span><a href="#local-6989586621679125611"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679125610"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125610"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679125610"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1419"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679125608"><span class="annot"><a href="#local-6989586621679125608"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Set(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679125608"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1420"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679125607"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125607"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;List(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List k v -&gt; [(k, v)]
forall k v. List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-var">unList</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
List k v
</span><a href="#local-6989586621679125607"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1421"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Single(_ _)&quot;</span></span><span>
</span><span id="line-1422"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;SetSingle(_)&quot;</span></span><span>
</span><span id="line-1423"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679125605"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125605"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679125604"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125604"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125605"><span class="hs-identifier hs-var">rep</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-1424"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span id="local-6989586621679125603"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125603"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(dom &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125603"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1425"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span id="local-6989586621679125602"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125602"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(rng &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125602"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1426"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679125601"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125601"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125600"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125600"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125601"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#9665; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125600"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1427"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679125599"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125599"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125598"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125598"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125599"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8938; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125598"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1428"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span id="local-6989586621679125597"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125596"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679125596"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125597"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#9655; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679125596"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1429"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span id="local-6989586621679125595"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125595"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125594"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679125594"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125595"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8939; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679125594"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1430"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679125593"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125593"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125592"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125592"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125593"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8712; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125592"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1431"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679125591"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125591"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679125590"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125590"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679125591"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8713; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679125590"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1432"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span id="local-6989586621679125589"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125589"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125588"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125588"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125589"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8745; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125588"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1433"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span id="local-6989586621679125587"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125586"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125586"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125587"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8838; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125586"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1434"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span id="local-6989586621679125585"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125584"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679125584"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125585"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8746; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679125584"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1435"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span id="local-6989586621679125583"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679125583"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125582"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679125582"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k n) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679125583"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8746;+ &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k n) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679125582"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1436"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span id="local-6989586621679125581"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125581"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125580"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679125580"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125581"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#10755; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679125580"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1437"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(singleton _ _ )&quot;</span></span><span>
</span><span id="line-1438"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(setSingleton _ )&quot;</span></span><span>
</span><span id="line-1439"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span id="local-6989586621679125579"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125578"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125578"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679125579"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8781; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679125578"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span></span><span>
</span><span id="line-1440"></span><span>
</span><span id="line-1441"></span><span id="local-6989586621679127787"><span id="local-6989586621679127788"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-type">ppQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127788"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127787"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span></span><span>
</span><span id="line-1442"></span><span id="ppQuery"><span class="annot"><span class="annottext">ppQuery :: Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var hs-var">ppQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679125576"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125576"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679125575"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679125575"><span class="hs-identifier hs-var">_f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep f k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679125576"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1443"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679125574"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125574"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125573"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679125573"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125574"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679125573"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679125572"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125572"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125571"><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679125571"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;And&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125572"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k w -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679125571"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1445"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679125570"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125570"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125569"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125569"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125568"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v)
</span><a href="#local-6989586621679125568"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Chain&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125570"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query v w -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679125569"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v)
</span><a href="#local-6989586621679125568"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1446"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679125567"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125567"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125566"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125566"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125565"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125565"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Or&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125567"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125566"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679125565"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1447"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679125564"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125564"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125563"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679125563"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Guard&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125564"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679125563"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679125562"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125562"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125561"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125561"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Diff&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125562"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k u -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125561"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1449"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679125560"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125560"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679125559"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125559"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679125558"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679125558"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AndP&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125560"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k u -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679125559"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679125558"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>
</span><span id="line-1451"></span><span>
</span><span id="line-1452"></span><span id="local-6989586621679125556"><span id="local-6989586621679125557"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679125551"><span id="local-6989586621679125554"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125557"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125556"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1453"></span><span>   </span><span id="local-6989586621679125550"><span class="annot"><span class="annottext">show :: Query k v -&gt; [Char]
</span><a href="#local-6989586621679125550"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679125549"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125549"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679125549"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1454"></span></pre></body></html>