<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Iterate.SetAlgebra</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Decoder</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-identifier">decodeListLen</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">decodeMapSkel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier">dropMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rnf</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html"><span class="hs-identifier">Control.Iterate.Collect</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Coders.html"><span class="hs-identifier">Data.Coders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Coders.html#invalidKey"><span class="hs-identifier">invalidKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">link</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">link2</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.ANSI.Leijen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">align</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vsep</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- ==================================================================================================</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | In order to build typed Exp (which are a typed deep embedding) of Set operations, we need to know</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- what kind of basic types of Maps and Sets can be embedded. Every Basic type has a few operations</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- for creating one from a list, for adding and removing key-value pairs, looking up a value given a key.</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Instances of this algebra are functional in that every key has exactly one value associated with it.</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- ===================================================================================================</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Basic"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-var">Basic</span></a></span></span><span> </span><span id="local-6989586621679133891"><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">-- | in addpair the new value always prevails, to make a choice use 'addkv' which has a combining function that allows choice.</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679133879"><span id="local-6989586621679133880"><span id="addpair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-type">addpair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133880"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133880"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133879"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133880"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133879"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133880"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133879"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-53"></span><span>  </span><span id="local-6989586621679131381"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-var hs-var">addpair</span></a></span><span> </span><span id="local-6989586621679131380"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131380"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131379"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131379"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679131378"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679131378"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131380"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131379"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679131378"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679131376"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131376"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679131375"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131375"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131375"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- | use (\ old new -&gt; old) if you want the v in (f k v) to prevail, and use (\ old new -&gt; new) if you want the v in (k,v) to prevail</span></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679133888"><span id="local-6989586621679133889"><span id="addkv"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-type">addkv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133889"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133889"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133889"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133889"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133888"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679133877"><span id="local-6989586621679133878"><span id="removekey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-type">removekey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133878"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133878"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133878"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133877"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133878"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133877"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679133875"><span id="local-6989586621679133876"><span id="domain"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-type">domain</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133876"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133876"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133875"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133876"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679133872"><span id="local-6989586621679133873"><span id="range"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-type">range</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133873"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133872"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133873"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133873"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679133870"><span id="local-6989586621679133871"><span id="emptyc"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#emptyc"><span class="hs-identifier hs-type">emptyc</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133871"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133871"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133870"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621679131370"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#emptyc"><span class="hs-identifier hs-var hs-var">emptyc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;emptyc only works on some types.&quot;</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- ========== Basic List ==============</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | The constructor for List is hidden, since it requires some invariants. Use fromPairs to build an initial List.</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131366"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>   </span><span id="local-6989586621679131359"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; List k v -&gt; (v -&gt; v -&gt; v) -&gt; List k v
</span><a href="#local-6989586621679131359"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131358"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131358"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131357"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131357"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679131355"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131355"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131354"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131354"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131353"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131355"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>       </span><span id="local-6989586621679131353"><span class="annot"><span class="annottext">insert :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131353"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131358"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131357"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>       </span><span class="annot"><a href="#local-6989586621679131353"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679131352"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131352"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131351"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131351"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679131350"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131350"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-70"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131358"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-71"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131352"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131351"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131353"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131350"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-72"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131358"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131357"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131352"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131351"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131350"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-73"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131352"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131354"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131351"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131357"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131350"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-74"></span><span>   </span><span id="local-6989586621679131348"><span class="annot"><span class="annottext">removekey :: k -&gt; List k v -&gt; List k v
</span><a href="#local-6989586621679131348"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679131347"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131347"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679131346"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131346"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131345"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131346"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>       </span><span id="local-6989586621679131345"><span class="annot"><span class="annottext">remove :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131345"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>       </span><span class="annot"><a href="#local-6989586621679131345"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679131344"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131344"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131343"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131343"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679131342"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131342"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131344"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131347"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131342"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131347"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131343"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679131345"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131342"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>   </span><span id="local-6989586621679131341"><span class="annot"><span class="annottext">domain :: List k v -&gt; Set k
</span><a href="#local-6989586621679131341"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679131340"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131340"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k -&gt; [(k, v)] -&gt; Set k
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131338"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131338"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131337"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131337"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131336"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131336"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131338"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131336"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131340"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-78"></span><span>   </span><span id="local-6989586621679131333"><span class="annot"><span class="annottext">range :: List k v -&gt; Set v
</span><a href="#local-6989586621679131333"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679131332"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131332"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; [(k, v)] -&gt; Set v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131331"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131331"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131330"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131330"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131329"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679131329"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131330"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679131329"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131332"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-79"></span><span>   </span><span id="local-6989586621679131328"><span class="annot"><span class="annottext">emptyc :: List k v
</span><a href="#local-6989586621679131328"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621679132942"><span id="local-6989586621679132943"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-type">fromPairs</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132943"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132942"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132942"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132942"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132943"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132942"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132943"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132942"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-83"></span><span id="fromPairs"><span class="annot"><span class="annottext">fromPairs :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679131326"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131326"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679131325"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131325"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131326"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679131323"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131323"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679131322"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131322"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131323"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131322"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131325"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679133844"><span id="local-6989586621679133845"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133845"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133844"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133844"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133844"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133845"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133844"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133845"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133844"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-86"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679131321"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131321"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679131320"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131320"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679131319"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131319"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131318"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131318"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131319"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131318"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679131317"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131317"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679131316"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131316"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131315"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131315"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679131314"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131314"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131313"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131313"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679131312"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131312"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131316"><span class="hs-identifier hs-var">k1</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131314"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131317"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131316"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131317"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131315"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131313"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131312"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679131311"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131311"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131310"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131310"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679131309"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131309"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131310"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131311"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131309"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- ================ Basic Single ===============</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- The Single type encode 0 or 1 pairs. Iteration is trivial. Succeeds only once.</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="Single"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span id="local-6989586621679131308"><span class="annot"><a href="#local-6989586621679131308"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679131307"><span class="annot"><a href="#local-6989586621679131307"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679133830"><span id="local-6989586621679133831"><span id="Single"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133831"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133830"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133831"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133830"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679133825"><span id="local-6989586621679133826"><span id="Fail"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133826"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133825"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679133829"><span id="SetSingle"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621679131298"><span id="local-6989586621679131300"><span id="local-6989586621679131302"><span id="local-6989586621679131303"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679131303"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679131302"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131303"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131302"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- Since we can only store one key, we have to choose who wins</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- We use the combine function to decide. (\ old new -&gt; old) keeps</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- the orginal value. (\ old new -&gt; new) overwrites the stored value.</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Something else like (\ old new -&gt; old+new) overwrites with a combination</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131294"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679131288"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Single k v -&gt; (v -&gt; v -&gt; v) -&gt; Single k v
</span><a href="#local-6989586621679131288"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131287"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131287"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131286"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131286"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131285"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679131285"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679131284"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131284"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679131285"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-110"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679131283"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131283"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679131282"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131282"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131283"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131284"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131282"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131286"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679131281"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131281"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131281"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-112"></span><span>       </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131287"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131286"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679131280"><span class="annot"><span class="annottext">removekey :: k -&gt; Single k v -&gt; Single k v
</span><a href="#local-6989586621679131280"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679131279"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131279"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679131278"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131278"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679131277"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131277"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131279"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131278"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131278"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131277"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679131276"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131276"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679131275"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131275"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131276"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131275"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131275"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679131274"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131274"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679131273"><span class="annot"><span class="annottext">domain :: Single k v -&gt; Set k
</span><a href="#local-6989586621679131273"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679131272"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131272"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679131271"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131271"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131272"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679131269"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131269"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131269"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679131268"><span class="annot"><span class="annottext">range :: Single k v -&gt; Set v
</span><a href="#local-6989586621679131268"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679131267"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131267"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679131266"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131266"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131266"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679131265"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131265"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679131264"><span class="annot"><span class="annottext">emptyc :: Single k v
</span><a href="#local-6989586621679131264"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- ============== Basic Map =========================</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131261"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679131255"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
</span><a href="#local-6989586621679131255"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131254"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131254"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131253"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131253"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131252"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131252"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679131251"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131251"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131251"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131254"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131253"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131252"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679131248"><span class="annot"><span class="annottext">removekey :: k -&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621679131248"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679131247"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131247"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131246"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131246"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131247"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131246"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679131244"><span class="annot"><span class="annottext">domain :: Map k v -&gt; Set k
</span><a href="#local-6989586621679131244"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span id="local-6989586621679131243"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131243"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131243"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679131241"><span class="annot"><span class="annottext">range :: Map k v -&gt; Set v
</span><a href="#local-6989586621679131241"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679131240"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131240"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; Map k v -&gt; Set v
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679131238"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131238"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679131237"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131237"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span id="local-6989586621679131236"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679131236"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131237"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679131236"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131240"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679131235"><span class="annot"><span class="annottext">emptyc :: Map k v
</span><a href="#local-6989586621679131235"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Data.Map uses(\ new old -&gt; ...) while our convention is (\ old new -&gt; ...)</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- We also use this in the Basic instance for BiMap, which uses Data.Map</span><span>
</span><span id="line-136"></span><span id="local-6989586621679133810"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-type">mapflip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133810"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-137"></span><span id="mapflip"><span class="annot"><span class="annottext">mapflip :: (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var hs-var">mapflip</span></a></span></span><span> </span><span id="local-6989586621679131233"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131233"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679131232"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131232"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679131231"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131231"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131233"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131231"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131232"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- =================== Basic BiMap =====================</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- For Bijections we define (BiMap v k v).  Reasons we can't use (Data.Bimap k v)</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- 1) We need to enforce that the second argument `v` is in the Ord class, when making it an Iter instance.</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- 2) The constructor for Data.BiMap is not exported, and it implements a Bijection</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- 3) Missing operation 'restrictkeys' and 'withoutkeys' make performant versions of operations  &#9665; &#8938; &#9655; &#8939; hard.</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- 4) Missing operation 'union', make performant versions of &#8746; and &#10755; hard.</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- 5) So we roll our own which is really a (Data.Map k v) with an index that maps v to Set{k}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="BiMap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-var">BiMap</span></a></span></span><span> </span><span id="local-6989586621679131230"><span class="annot"><a href="#local-6989586621679131230"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679131229"><span class="annot"><a href="#local-6989586621679131229"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679131228"><span class="annot"><a href="#local-6989586621679131228"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679133707"><span id="local-6989586621679133708"><span id="local-6989586621679133709"><span id="MkBiMap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133709"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679133708"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133707"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133708"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133708"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133709"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133707"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133708"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-149"></span><span>                                </span><span class="hs-comment">--  ^   the 1st and 3rd parameter must be the same:             ^   ^</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- ============== begin necessary Cardano.Binary instances ===============</span><span>
</span><span id="line-152"></span><span id="local-6989586621679131225"><span id="local-6989586621679131226"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131219"><span id="local-6989586621679131221"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131225"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131225"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131225"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131225"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- The `toCBOR` instance encodes only the forward map. We wrap this in a</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- length-one list because a _previous_ encoding wrote out both maps, and we</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- can easily use the list length token to distinguish between them.</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679131217"><span class="annot"><span class="annottext">toCBOR :: BiMap b a b -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131215"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131215"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131215"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679131211"><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679131209"><span class="annot"><a href="#local-6989586621679131209"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679131208"><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131209"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679131207"><span class="annot"><span class="annottext">fromCBOR :: Decoder s (BiMap b a b)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="annottext">Decoder s Int
forall s. Decoder s Int
</span><span class="hs-identifier hs-var">decodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Int
-&gt; (Int -&gt; Decoder s (BiMap b a b)) -&gt; Decoder s (BiMap b a b)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Decoder s (BiMap b a b)
forall a b s.
(FromCBOR a, FromCBOR b, Ord a, Ord b) =&gt;
Decoder s (BiMap b a b)
</span><a href="Control.Iterate.SetAlgebra.html#decodeMapAsBimap"><span class="hs-identifier hs-var">decodeMapAsBimap</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-comment">-- Previous encoding of 'BiMap' encoded both the forward and reverse</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-comment">-- directions. In this case we skip the reverse encoding. Note that,</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-comment">-- further, the reverse encoding was from 'b' to 'a', not the current 'b'</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-comment">-- to 'Set a', and hence the dropper reflects that.</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679131204"><span class="annot"><span class="annottext">BiMap b a b
</span><a href="#local-6989586621679131204"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (BiMap b a b)
forall a b s.
(FromCBOR a, FromCBOR b, Ord a, Ord b) =&gt;
Decoder s (BiMap b a b)
</span><a href="Control.Iterate.SetAlgebra.html#decodeMapAsBimap"><span class="hs-identifier hs-var">decodeMapAsBimap</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s -&gt; Dropper s
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">dropMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s b -&gt; Dropper s
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Decoder s b -&gt; Dropper s) -&gt; Decoder s b -&gt; Dropper s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. FromCBOR b =&gt; Decoder s b
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679131208"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s a -&gt; Dropper s
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Decoder s a -&gt; Dropper s) -&gt; Decoder s a -&gt; Dropper s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. FromCBOR a =&gt; Decoder s a
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679131209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">BiMap b a b -&gt; Decoder s (BiMap b a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BiMap b a b
</span><a href="#local-6989586621679131204"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679131203"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131203"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Decoder s (BiMap b a b)
forall s a. Word -&gt; Decoder s a
</span><a href="Data.Coders.html#invalidKey"><span class="hs-identifier hs-var">invalidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131203"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Decode a serialised CBOR Map as a Bimap</span><span>
</span><span id="line-177"></span><span id="local-6989586621679133769"><span id="local-6989586621679133770"><span id="local-6989586621679133771"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#decodeMapAsBimap"><span class="hs-identifier hs-type">decodeMapAsBimap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621679133769"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133770"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-180"></span><span id="decodeMapAsBimap"><span class="annot"><span class="annottext">decodeMapAsBimap :: Decoder s (BiMap b a b)
</span><a href="Control.Iterate.SetAlgebra.html#decodeMapAsBimap"><span class="hs-identifier hs-var hs-var">decodeMapAsBimap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; BiMap b a b) -&gt; Decoder s (BiMap b a b)
forall k v m s.
(Ord k, FromCBOR k, FromCBOR v) =&gt;
([(k, v)] -&gt; m) -&gt; Decoder s m
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-binary-1.5.0/noopt/doc/html/cardano-binary/src"><span class="hs-identifier hs-var">decodeMapSkel</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; BiMap b a b
forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromAscDistinctList"><span class="hs-identifier hs-var">biMapFromAscDistinctList</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679131199"><span id="local-6989586621679131200"><span id="local-6989586621679131201"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131197"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679131201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679131200"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131199"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131200"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679131193"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BiMap v a b) -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy (BiMap v a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BiMap&quot;</span></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679131191"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; BiMap v a b -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></span></span><span> </span><span id="local-6989586621679131189"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679131189"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131188"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679131187"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679131187"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; (Map a b, Map b (Set a)) -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">wNoThunks</span></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679131189"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679131187"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621679131184"><span id="local-6989586621679131185"><span id="local-6989586621679131186"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131186"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131185"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131184"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>   </span><span id="local-6989586621679131181"><span class="annot"><span class="annottext">rnf :: BiMap v a b -&gt; ()
</span><a href="#local-6989586621679131181"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131180"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131180"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679131179"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; () -&gt; ()
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679131180"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map b (Set a) -&gt; () -&gt; ()
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- ============== end Necessary Cardano.Binary instances ===================</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621679131176"><span id="local-6989586621679131177"><span id="local-6989586621679131178"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131173"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679131178"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679131177"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131176"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131178"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131177"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131172"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131172"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131171"><span class="annot"><span class="annottext">== :: BiMap u k v -&gt; BiMap u k v -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131170"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131170"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131172"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131170"><span class="hs-identifier hs-var">x</span></a></span></span></span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span id="local-6989586621679131167"><span id="local-6989586621679131168"><span id="local-6989586621679131169"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131162"><span id="local-6989586621679131165"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679131169"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679131168"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131167"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131169"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131168"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679131160"><span class="annot"><span class="annottext">show :: BiMap u k v -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131158"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131158"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679131157"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131157"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131158"><span class="hs-identifier hs-var">l</span></a></span></span></span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621679133715"><span id="local-6989586621679133716"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-type">addBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133716"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133715"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133716"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133715"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133716"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133715"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133716"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133715"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-198"></span><span id="addBack"><span class="annot"><span class="annottext">addBack :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var hs-var">addBack</span></a></span></span><span> </span><span id="local-6989586621679131155"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131155"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679131154"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131154"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131153"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k -&gt; Set k)
-&gt; v -&gt; Set k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131155"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131154"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679131150"><span id="local-6989586621679131151"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-type">retract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131151"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131150"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131151"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131150"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679131151"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679131150"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679131151"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679131150"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-201"></span><span id="retract"><span class="annot"><span class="annottext">retract :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var hs-var">retract</span></a></span></span><span> </span><span id="local-6989586621679131148"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131148"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679131147"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131147"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131146"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k) -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131147"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131148"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679133705"><span id="local-6989586621679133706"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-type">insertBackwards</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133706"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133705"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133705"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133705"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133706"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133705"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133706"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133705"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133706"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-204"></span><span id="insertBackwards"><span class="annot"><span class="annottext">insertBackwards :: v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var hs-var">insertBackwards</span></a></span></span><span> </span><span id="local-6989586621679131142"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131142"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679131141"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131141"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679131140"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131140"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131139"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131139"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131141"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131140"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131142"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131140"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131139"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621679131138"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131135"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131138"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131138"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679131129"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; BiMap v k v -&gt; (v -&gt; v -&gt; v) -&gt; BiMap v k v
</span><a href="#local-6989586621679131129"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131128"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131128"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131127"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131127"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131126"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131126"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679131125"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131125"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131124"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131124"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Control.Iterate.SetAlgebra.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131124"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131128"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131127"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131126"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131123"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131122"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131128"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131125"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131123"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131123"><span class="hs-identifier hs-var">oldv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131122"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131122"><span class="hs-identifier hs-var">newv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131128"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131126"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131127"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131127"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679131120"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131120"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131120"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131124"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131120"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131127"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679131119"><span class="annot"><span class="annottext">removekey :: k -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679131119"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679131118"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131118"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131117"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679131117"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131116"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131116"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679131115"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131115"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- equality constraint (a ~ v) from (BiMap a k v) into scope.</span><span>
</span><span id="line-210"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131118"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131116"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679131114"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131114"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131118"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131116"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131114"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131118"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131115"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131117"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679131113"><span class="annot"><span class="annottext">domain :: BiMap v k v -&gt; Set k
</span><a href="#local-6989586621679131113"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131112"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131112"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679131111"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131111"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131112"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679131110"><span class="annot"><span class="annottext">range :: BiMap v k v -&gt; Set v
</span><a href="#local-6989586621679131110"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131109"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131109"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span id="local-6989586621679131108"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map v (Set k) -&gt; Set v
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679131107"><span class="annot"><span class="annottext">emptyc :: BiMap v k v
</span><a href="#local-6989586621679131107"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BiMap v k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;emptyc cannot be defined for BiMap, use the variable: biMapEmpty :: BiMap v k v&quot;</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679133689"><span id="local-6989586621679133690"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-type">biMapEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133690"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133689"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133690"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-218"></span><span id="biMapEmpty"><span class="annot"><span class="annottext">biMapEmpty :: BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var hs-var">biMapEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Make a BiMap from a list of pairs.</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- The combine function comb=(\ earlier later -&gt; later) will let elements</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- later in the list override ones earlier in the list, and comb =</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- (\ earlier later -&gt; earlier) will keep the vaue that appears first in the list</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679132929"><span id="local-6989586621679132930"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-type">biMapFromList</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132930"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132930"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132930"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132929"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-226"></span><span id="biMapFromList"><span class="annot"><span class="annottext">biMapFromList :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-var hs-var">biMapFromList</span></a></span></span><span> </span><span id="local-6989586621679131104"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131104"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span id="local-6989586621679131103"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131103"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; BiMap v k v -&gt; BiMap v k v)
-&gt; BiMap v k v -&gt; [(k, v)] -&gt; BiMap v k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679131102"><span class="hs-identifier hs-var">addEntry</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
forall v k. BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var">biMapEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131103"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679131102"><span class="annot"><span class="annottext">addEntry :: (k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679131102"><span class="hs-identifier hs-var hs-var">addEntry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131101"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131100"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131099"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131099"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679131098"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131098"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131099"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131099"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131104"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131098"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679131097"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131097"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131099"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131104"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131097"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131096"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131101"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131098"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>               </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679131096"><span class="annot"><span class="annottext">newv :: v
</span><a href="#local-6989586621679131096"><span class="hs-identifier hs-var hs-var">newv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131104"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131097"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span id="local-6989586621679133748"><span id="local-6989586621679133749"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#biMapFromAscDistinctList"><span class="hs-identifier hs-type">biMapFromAscDistinctList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133749"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133748"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133749"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679133748"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133748"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133748"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-235"></span><span id="biMapFromAscDistinctList"><span class="annot"><span class="annottext">biMapFromAscDistinctList :: [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromAscDistinctList"><span class="hs-identifier hs-var hs-var">biMapFromAscDistinctList</span></a></span></span><span> </span><span id="local-6989586621679131095"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131095"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">bmForward</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131093"><span class="hs-identifier hs-var">bmBackward</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679131094"><span class="annot"><span class="annottext">bmForward :: Map k v
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var hs-var">bmForward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Map k v
forall k a. [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromDistinctAscList</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131095"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679131093"><span class="annot"><span class="annottext">bmBackward :: Map v (Set k)
</span><a href="#local-6989586621679131093"><span class="hs-identifier hs-var hs-var">bmBackward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; Map v (Set k) -&gt; [(k, v)] -&gt; Map v (Set k)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">((k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
 -&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v)
-&gt; Map v (Set k)
-&gt; Map v (Set k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Control.Iterate.SetAlgebra.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131095"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- This synonym makes (BiMap v k v) appear as an ordinary Binary type contructor: (Bimap k v)</span><span>
</span><span id="line-241"></span><span class="hs-keyword">type</span><span> </span><span id="Bimap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span></span><span> </span><span id="local-6989586621679131089"><span class="annot"><a href="#local-6989586621679131089"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679131088"><span class="annot"><a href="#local-6989586621679131088"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131088"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131089"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131088"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- This operation is very fast (Log n) on BiMap, but extremely slow on other collections.</span><span>
</span><span id="line-244"></span><span id="local-6989586621679132252"><span id="local-6989586621679132253"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-type">removeval</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132253"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132253"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132253"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132252"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-245"></span><span id="removeval"><span class="annot"><span class="annottext">removeval :: v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var hs-var">removeval</span></a></span></span><span> </span><span id="local-6989586621679131086"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131086"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131085"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679131085"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679131084"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131084"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679131083"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131083"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Maybe (Set k)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131086"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131083"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679131082"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131082"><span class="hs-identifier hs-var">kset</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; Set k -&gt; Map k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679131081"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131081"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679131080"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131080"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131081"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131080"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131084"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131082"><span class="hs-identifier hs-var">kset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131086"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679131083"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set k)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131085"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- ================= Basic Set =====================</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="Sett"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span id="local-6989586621679131079"><span class="annot"><a href="#local-6989586621679131079"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679131078"><span class="annot"><a href="#local-6989586621679131078"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679133673"><span id="Sett"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133673"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133673"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679131069"><span class="annot"><span class="annottext">addpair :: k -&gt; v -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679131069"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span id="local-6989586621679131068"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131068"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679131067"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131067"><span class="hs-identifier hs-var">_unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131066"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131066"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131068"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131066"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679131065"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Sett k v -&gt; (v -&gt; v -&gt; v) -&gt; Sett k v
</span><a href="#local-6989586621679131065"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131064"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131064"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679131063"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679131063"><span class="hs-identifier hs-var">_unit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131062"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131062"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679131061"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679131061"><span class="hs-identifier hs-var">_comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131064"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131062"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- We can ignore comb since there is only one function at type: () -&gt; () -&gt; ()</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679131060"><span class="annot"><span class="annottext">removekey :: k -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679131060"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679131059"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131059"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131058"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131058"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679131059"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131058"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679131057"><span class="annot"><span class="annottext">domain :: Sett k v -&gt; Set k
</span><a href="#local-6989586621679131057"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131056"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131056"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131056"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679131055"><span class="annot"><span class="annottext">range :: Sett k v -&gt; Set v
</span><a href="#local-6989586621679131055"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131054"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131054"><span class="hs-identifier hs-var">_xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679131053"><span class="annot"><span class="annottext">emptyc :: Sett k v
</span><a href="#local-6989586621679131053"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Sett k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Sett Set.empty has type (Sett k ()) and it needs type (Sett k v)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span id="local-6989586621679131052"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679131047"><span id="local-6989586621679131050"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679131052"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131052"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>   </span><span id="local-6989586621679131046"><span class="annot"><span class="annottext">show :: Sett key () -&gt; [Char]
</span><a href="#local-6989586621679131046"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131045"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679131045"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set key -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679131045"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span id="local-6989586621679131040"><span id="local-6989586621679131042"><span id="local-6989586621679131044"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679131044"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131044"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- Every iterable type type forms an isomorphism with some Base type. For most</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- Base types the isomorphism is the identity in both directions, but for some,</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- like List and Sett, the embeddings are not the trivial identities because the</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- concrete types are not binary type constructors. The Embed class also allows</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- us to add 'newtypes' which encode some Base type to the system.</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">class</span><span> </span><span id="Embed"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679133657"><span class="annot"><a href="#local-6989586621679133657"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679133656"><span class="annot"><a href="#local-6989586621679133656"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679133657"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133656"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>  </span><span id="toBase"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#toBase"><span class="hs-identifier hs-type">toBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133657"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133656"><span class="hs-identifier hs-type">base</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span id="fromBase"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromBase"><span class="hs-identifier hs-type">fromBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133656"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133657"><span class="hs-identifier hs-type">concrete</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621679131036"><span id="local-6989586621679131037"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131037"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131037"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679131036"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131037"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131036"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>   </span><span id="local-6989586621679131032"><span class="annot"><span class="annottext">toBase :: [(k, v)] -&gt; List k v
</span><a href="#local-6989586621679131032"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679131031"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131031"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679131030"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131030"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679131029"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131029"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131030"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679131029"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131031"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>   </span><span id="local-6989586621679131028"><span class="annot"><span class="annottext">fromBase :: List k v -&gt; [(k, v)]
</span><a href="#local-6989586621679131028"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679131027"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131027"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679131027"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621679131026"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679131026"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131026"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>   </span><span id="local-6989586621679131023"><span class="annot"><span class="annottext">toBase :: Set k -&gt; Sett k ()
</span><a href="#local-6989586621679131023"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679131022"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-285"></span><span>   </span><span id="local-6989586621679131021"><span class="annot"><span class="annottext">fromBase :: Sett k () -&gt; Set k
</span><a href="#local-6989586621679131021"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679131020"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span id="local-6989586621679131018"><span id="local-6989586621679131019"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679131019"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131018"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679131019"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131018"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>   </span><span id="local-6989586621679131015"><span class="annot"><span class="annottext">toBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679131015"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679131014"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131014"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131014"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-289"></span><span>   </span><span id="local-6989586621679131013"><span class="annot"><span class="annottext">fromBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679131013"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679131012"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131012"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679131012"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span id="local-6989586621679131010"><span id="local-6989586621679131011"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131011"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131010"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131011"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131011"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131010"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131011"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>   </span><span id="local-6989586621679131007"><span class="annot"><span class="annottext">toBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679131007"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679131006"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131006"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131006"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-293"></span><span>   </span><span id="local-6989586621679131005"><span class="annot"><span class="annottext">fromBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679131005"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679131004"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131004"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679131004"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621679131002"><span id="local-6989586621679131003"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131003"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131002"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131003"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131002"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>   </span><span id="local-6989586621679130999"><span class="annot"><span class="annottext">toBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679130999"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679130998"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130998"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130998"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-297"></span><span>   </span><span id="local-6989586621679130997"><span class="annot"><span class="annottext">fromBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679130997"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679130996"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130996"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130996"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- Necessary when asking Boolean queries like: (&#8838;),(&#8712;),(&#8713;)</span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>   </span><span id="local-6989586621679130993"><span class="annot"><span class="annottext">toBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679130993"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679130992"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130992"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130992"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-302"></span><span>   </span><span id="local-6989586621679130991"><span class="annot"><span class="annottext">fromBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679130991"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679130990"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130990"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130990"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- ================= The Iter class =================================================</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- The Set algebra include types that encode finite maps of some type. They</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- have a finite domain, and for each domain element they pair a single range</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- element. We are interested in those finite maps that can iterate their</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- pairs in ascending domain order. The operations are: `nxt` and `lub` .</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- lub can skip over many items in sub-linear time, it can make things really fast.</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- Many finite maps can support a support lub operation in sub-linear time. Some examples:</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- Balanced binary trees, Arrays (using binary search), Tries, etc. There are basic and compound</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- Iter instances. Compound types include components with types that have Iter instances.</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-keyword">class</span><span> </span><span id="Iter"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-var">Iter</span></a></span></span><span> </span><span id="local-6989586621679133648"><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679133642"><span id="local-6989586621679133643"><span id="nxt"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-type">nxt</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133642"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133643"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133642"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133642"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679133638"><span id="local-6989586621679133639"><span id="lub"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-type">lub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133639"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133639"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133639"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133638"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133639"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133638"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133639"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133638"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-comment">-- The next few methods can all be defined via nxt and lub, but for base types there often exist</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-comment">-- much more efficent means, so the default definitions should be overwritten for such basic types.</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-comment">-- For compound types with Guards, these are often the only way to define them.</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679133619"><span id="local-6989586621679133620"><span id="hasNxt"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-type">hasNxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133619"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621679130986"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var hs-var">hasNxt</span></a></span><span> </span><span id="local-6989586621679130985"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130985"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, f a b) -&gt; Maybe (a, b, f a b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130985"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679133634"><span id="local-6989586621679133635"><span id="hasLub"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-type">hasLub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133634"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133635"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133634"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133634"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679130982"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var hs-var">hasLub</span></a></span><span> </span><span id="local-6989586621679130981"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130981"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130980"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130980"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, f k b) -&gt; Maybe (k, b, f k b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130981"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130980"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679133625"><span id="local-6989586621679133626"><span id="haskey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-type">haskey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133626"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133626"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133626"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133625"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679130978"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679130977"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130977"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130976"><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679130976"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key b -&gt; Maybe (key, b, f key b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130977"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679130976"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe (key, b, f key b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130975"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130975"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f key b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130977"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130975"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">}</span></span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679133617"><span id="local-6989586621679133618"><span id="isnull"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-type">isnull</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133618"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133617"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679130973"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var hs-var">isnull</span></a></span><span> </span><span id="local-6989586621679130972"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130972"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v, f k v) -&gt; Bool
forall t. Collect t -&gt; Bool
</span><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier hs-var">isempty</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130972"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679133615"><span id="local-6989586621679133616"><span id="lookup"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133616"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133616"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133616"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133615"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679133615"><span class="hs-identifier hs-type">rng</span></a></span></span></span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679130969"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679130968"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130968"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130967"><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679130967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key rng -&gt; Maybe (key, rng, f key rng)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130968"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679130967"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe (key, rng, f key rng)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130966"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130966"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130965"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130965"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f key rng
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130968"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130966"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130965"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">}</span></span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679133613"><span id="local-6989586621679133614"><span id="element"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-identifier hs-type">element</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133614"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133614"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133614"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133613"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679130963"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-identifier hs-var hs-var">element</span></a></span><span> </span><span id="local-6989586621679130962"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130962"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130961"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130961"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130962"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130961"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- ============== Iter List ==============</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679130959"><span class="annot"><a href="#local-6989586621679130959"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679130958"><span class="annot"><a href="#local-6989586621679130958"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679133864"><span id="local-6989586621679133865"><span id="UnSafeList"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133865"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133865"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133864"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133865"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133864"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-339"></span><span id="local-6989586621679131479"><span id="local-6989586621679131480"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-type">unList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131480"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131479"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131480"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131479"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-340"></span><span id="unList"><span class="annot"><span class="annottext">unList :: List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-var hs-var">unList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679130956"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130956"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130956"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-341"></span><span id="local-6989586621679130950"><span id="local-6989586621679130952"><span id="local-6989586621679130954"><span id="local-6989586621679130955"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679130955"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679130954"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130955"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130954"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130939"><span id="local-6989586621679130943"><span id="local-6989586621679130945"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>                      </span><span class="hs-comment">-- List is the only basic instance with non-linear nxt and lub. It also depends on</span><span>
</span><span id="line-344"></span><span>   </span><span id="local-6989586621679130937"><span class="annot"><span class="annottext">nxt :: List a b -&gt; Collect (a, b, List a b)
</span><a href="#local-6989586621679130937"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, List a b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>                 </span><span class="hs-comment">-- key-value pairs being stored in ascending order. For small Lists (10 or so elements) this is OK.</span><span>
</span><span id="line-345"></span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130935"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130935"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130934"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130934"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679130933"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679130933"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Collect (a, b, List a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130935"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130934"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679130933"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>   </span><span id="local-6989586621679130931"><span class="annot"><span class="annottext">lub :: k -&gt; List k b -&gt; Collect (k, b, List k b)
</span><a href="#local-6989586621679130931"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679130930"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130930"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679130929"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679130929"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((k, b) -&gt; Bool) -&gt; [(k, b)] -&gt; [(k, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130927"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130927"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130926"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130926"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130927"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130930"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679130929"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-347"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, List k b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-348"></span><span>                       </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130924"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130924"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130923"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130923"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679130922"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679130922"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, List k b) -&gt; Collect (k, b, List k b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130924"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130923"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(k, b)] -&gt; List k b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679130922"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>   </span><span id="local-6989586621679130921"><span class="annot"><span class="annottext">isnull :: List k v -&gt; Bool
</span><a href="#local-6989586621679130921"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679130920"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130920"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130920"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-350"></span><span>   </span><span id="local-6989586621679130918"><span class="annot"><span class="annottext">lookup :: key -&gt; List key rng -&gt; Maybe rng
</span><a href="#local-6989586621679130918"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679130917"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130917"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679130916"><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679130916"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; [(key, rng)] -&gt; Maybe rng
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">List.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130917"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679130916"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-351"></span><span>   </span><span id="local-6989586621679130915"><span class="annot"><span class="annottext">hasNxt :: List a b -&gt; Maybe (a, b, List a b)
</span><a href="#local-6989586621679130915"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasNxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, List a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-352"></span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130914"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130914"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130913"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130913"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679130912"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679130912"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Maybe (a, b, List a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130914"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130913"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679130912"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621679130910"><span id="local-6989586621679130911"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130905"><span id="local-6989586621679130908"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130910"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130910"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>   </span><span id="local-6989586621679130904"><span class="annot"><span class="annottext">show :: List k v -&gt; [Char]
</span><a href="#local-6989586621679130904"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679130903"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130903"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130903"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- =============== Iter Single ==================</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130892"><span id="local-6989586621679130897"><span id="local-6989586621679130899"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679130891"><span class="annot"><span class="annottext">nxt :: Single a b -&gt; Collect (a, b, Single a b)
</span><a href="#local-6989586621679130891"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679130890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130890"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130889"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130889"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130887"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130887"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130886"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130886"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130886"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130890"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130889"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single a b
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130887"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679130885"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130885"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130884"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130884"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130883"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130883"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130883"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130885"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single a ()
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130884"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Single a b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130882"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130882"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130881"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130881"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130882"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679130880"><span class="annot"><span class="annottext">lub :: k -&gt; Single k b -&gt; Collect (k, b, Single k b)
</span><a href="#local-6989586621679130880"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679130879"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130879"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679130878"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130878"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130877"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130877"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130876"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130876"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130875"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130875"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130878"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130879"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130875"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130878"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130877"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single k b
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130876"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130876"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679130873"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130873"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679130872"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130872"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130871"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130871"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130870"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130870"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130872"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130873"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130870"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130872"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Single k ()
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130871"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130871"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679130869"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130869"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130868"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130868"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130867"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130867"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130868"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679130866"><span class="annot"><span class="annottext">haskey :: key -&gt; Single key b -&gt; Bool
</span><a href="#local-6989586621679130866"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679130865"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130865"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679130864"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130864"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130865"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130864"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679130863"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130863"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679130862"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130862"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130861"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130861"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130863"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130862"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679130860"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130860"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key b
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679130859"><span class="annot"><span class="annottext">isnull :: Single k v -&gt; Bool
</span><a href="#local-6989586621679130859"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679130858"><span class="annot"><span class="annottext">lookup :: key -&gt; Single key rng -&gt; Maybe rng
</span><a href="#local-6989586621679130858"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679130857"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130857"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679130856"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130856"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130857"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130856"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679130855"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130855"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679130854"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130854"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130853"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130853"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130855"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130854"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130853"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679130852"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130852"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key rng
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span id="local-6989586621679130850"><span id="local-6989586621679130851"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130845"><span id="local-6989586621679130848"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130851"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130850"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130851"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130850"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679130844"><span class="annot"><span class="annottext">show :: Single k v -&gt; [Char]
</span><a href="#local-6989586621679130844"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679130843"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130843"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130842"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130842"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(Single &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130843"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130842"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679130841"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130841"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(SetSingle &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130841"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Fail&quot;</span></span></span></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- ============= Iter Sett ===============</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130830"><span id="local-6989586621679130835"><span id="local-6989586621679130837"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621679130829"><span class="annot"><span class="annottext">nxt :: Sett a b -&gt; Collect (a, b, Sett a b)
</span><a href="#local-6989586621679130829"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130828"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679130828"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Sett a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Sett a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130827"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130827"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130826"><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130826"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679130828"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130827"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130824"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130824"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130823"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679130823"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; (a, Set a)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679130828"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130826"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130824"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set a -&gt; Sett a ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679130823"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130827"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621679130821"><span class="annot"><span class="annottext">lub :: k -&gt; Sett k b -&gt; Collect (k, b, Sett k b)
</span><a href="#local-6989586621679130821"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679130820"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130820"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130819"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130819"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Sett k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Sett k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130818"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130818"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130817"><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130817"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130819"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-386"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130818"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-387"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130820"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130819"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-388"></span><span>                                     </span><span class="hs-special">(</span><span id="local-6989586621679130815"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130815"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span id="local-6989586621679130814"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130814"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130817"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130820"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130814"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130818"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-389"></span><span>                                     </span><span class="hs-special">(</span><span id="local-6989586621679130813"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130813"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span id="local-6989586621679130812"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130812"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130812"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-390"></span><span>                                                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130818"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-391"></span><span>                                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130811"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130811"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130810"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130810"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; (k, Set k)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130812"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130817"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130811"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span>  </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130810"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130818"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679130809"><span class="annot"><span class="annottext">haskey :: key -&gt; Sett key b -&gt; Bool
</span><a href="#local-6989586621679130809"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679130808"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130808"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130807"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679130807"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130808"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679130807"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621679130805"><span class="annot"><span class="annottext">isnull :: Sett k v -&gt; Bool
</span><a href="#local-6989586621679130805"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130804"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130804"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130804"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679130803"><span class="annot"><span class="annottext">lookup :: key -&gt; Sett key rng -&gt; Maybe rng
</span><a href="#local-6989586621679130803"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679130802"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130802"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130801"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679130801"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130802"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679130801"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- ================== Iter Map ===============</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130790"><span id="local-6989586621679130795"><span id="local-6989586621679130797"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679130789"><span class="annot"><span class="annottext">nxt :: Map a b -&gt; Collect (a, b, Map a b)
</span><a href="#local-6989586621679130789"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679130788"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130788"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Map a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Map a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130787"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130787"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130786"><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130786"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130788"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130787"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130784"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130784"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130783"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130783"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679130782"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130782"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130786"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130784"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130783"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130782"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130787"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679130781"><span class="annot"><span class="annottext">lub :: k -&gt; Map k b -&gt; Collect (k, b, Map k b)
</span><a href="#local-6989586621679130781"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679130780"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130780"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679130779"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130779"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Map k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Map k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130778"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130778"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130777"><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130780"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130779"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>                  </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-406"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130775"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130775"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679130774"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130774"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130773"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130773"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130780"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130774"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130773"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-407"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130772"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130772"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-408"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130770"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130770"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span id="local-6989586621679130769"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130769"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130768"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130767"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130766"><span class="hs-identifier hs-var">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-409"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130768"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130768"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130767"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130767"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679130766"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130766"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130769"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679130764"><span class="annot"><span class="annottext">haskey :: key -&gt; Map key b -&gt; Bool
</span><a href="#local-6989586621679130764"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679130763"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130763"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130762"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679130762"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Maybe b
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130763"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679130762"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679130761"><span class="annot"><span class="annottext">isnull :: Map k v -&gt; Bool
</span><a href="#local-6989586621679130761"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679130759"><span class="annot"><span class="annottext">lookup :: key -&gt; Map key rng -&gt; Maybe rng
</span><a href="#local-6989586621679130759"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- ===========================================================</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- Some times we need to write our own version of functions</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- over  Map.Map that do not appear in the library</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- For example</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- 1) version of Map.withoutKeys where both parts are Map.Map</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- 2) Comparing that two maps have exactly the same set of keys</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- 3) The intersection of two maps guarded by a predicate.</span><span>
</span><span id="line-422"></span><span class="hs-comment">--    ((dom stkcred) &#9665; deleg) &#9655; (dom stpool))   ==&gt;</span><span>
</span><span id="line-423"></span><span class="hs-comment">--    intersectDomP (\ k v -&gt; Map.member v stpool) stkcred deleg</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- ============================================================</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span id="local-6989586621679133506"><span id="local-6989586621679133507"><span id="local-6989586621679133508"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-type">noKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133508"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133508"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133508"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133506"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133508"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133507"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-427"></span><span id="noKeys"><span class="annot"><span class="annottext">noKeys :: Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var hs-var">noKeys</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span id="local-6989586621679130757"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130757"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130757"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span id="local-6989586621679130756"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130756"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130754"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130754"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130753"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130753"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679130752"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130752"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; (Map k a, Map k a)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Map k a)
</span><span class="hs-identifier hs-var">Map.split</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130754"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130756"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679130750"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130750"><span class="hs-identifier hs-var">lm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130749"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130749"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k a -&gt; Map k a
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130748"><span class="hs-identifier hs-var">lm'</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130747"><span class="hs-identifier hs-var">rm'</span></a></span><span>     </span><span class="hs-comment">-- We know `k` is not in either `lm` or `rm`</span><span>
</span><span id="line-431"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130748"><span class="annot"><span class="annottext">lm' :: Map k a
</span><a href="#local-6989586621679130748"><span class="hs-identifier hs-var hs-var">lm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k b -&gt; Map k a
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130750"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130753"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-432"></span><span>           </span><span class="hs-glyph">!</span><span id="local-6989586621679130747"><span class="annot"><span class="annottext">rm' :: Map k a
</span><a href="#local-6989586621679130747"><span class="hs-identifier hs-var hs-var">rm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Map k b -&gt; Map k a
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130749"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130752"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-433"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-pragma hs-type">noKeys</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- This version benchmarks better than the following three versions, by almost a factor of 4, at Trees with 100 to 100,000 pairs</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- keysEqual2 x y = Map.foldrWithKey' (\ k v ans -&gt; k:ans) [] x == Map.foldrWithKey' (\ k v ans -&gt; k:ans) [] y</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- keysEqual3 x y = Map.keysSet x == Map.keysSet y</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- keysEqual4 x y = Map.keys x == Map.keys y</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- This is a type specific version of sameDomain</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span id="local-6989586621679133498"><span id="local-6989586621679133499"><span id="local-6989586621679133500"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-type">keysEqual</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133500"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133500"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133499"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133500"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133498"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-443"></span><span id="keysEqual"><span class="annot"><span class="annottext">keysEqual :: Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var hs-var">keysEqual</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-445"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-446"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span id="local-6989586621679130745"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130745"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130744"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130744"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130743"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130743"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679130742"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130742"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-447"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v1 -&gt; (Map k v1, Bool, Map k v1)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var">splitMember</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130744"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130745"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679130740"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130740"><span class="hs-identifier hs-var">lm</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span id="local-6989586621679130739"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130739"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v1 -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130743"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130740"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v1 -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130742"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130739"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">(Map k v1, Bool, Map k v1)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- cost O(min (size m) (size n) * log(max (size m) (size n))), BUT the constants are high, too slow except for small maps.</span><span>
</span><span id="line-452"></span><span id="local-6989586621679132686"><span id="local-6989586621679132687"><span id="local-6989586621679132688"><span id="local-6989586621679132689"><span id="local-6989586621679132690"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-type">sameDomain</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132690"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132689"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132688"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679132689"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132690"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132687"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132688"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132690"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132686"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-453"></span><span id="sameDomain"><span class="annot"><span class="annottext">sameDomain :: f k b -&gt; g k c -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-var hs-var">sameDomain</span></a></span></span><span> </span><span id="local-6989586621679130736"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130736"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130735"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679130735"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (k, b, f k b) -&gt; Maybe (k, c, g k c) -&gt; Bool
forall a (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord a, Iter f, Iter f) =&gt;
Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679130734"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k b -&gt; Maybe (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130736"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g k c -&gt; Maybe (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679130735"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679130734"><span class="annot"><span class="annottext">loop :: Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679130734"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679130733"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130733"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130732"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130732"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679130731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130731"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130730"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130730"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130733"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130731"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-456"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b) -&gt; Maybe (a, b, f a b) -&gt; Bool
</span><a href="#local-6989586621679130734"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Maybe (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130732"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Maybe (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Maybe (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679130730"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-458"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-459"></span><span>        </span><span class="annot"><a href="#local-6989586621679130734"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-460"></span><span>        </span><span class="annot"><a href="#local-6989586621679130734"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, f a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | A variant of 'splitLookup' that indicates only whether the</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- key was present, rather than producing its value. This is used to</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- implement 'keysEqual' to avoid allocating unnecessary 'Just'</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-466"></span><span id="local-6989586621679133501"><span id="local-6989586621679133502"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-type">splitMember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133501"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133501"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-467"></span><span id="splitMember"><span class="annot"><span class="annottext">splitMember :: k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var hs-var">splitMember</span></a></span></span><span> </span><span id="local-6989586621679130729"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130729"><span class="hs-identifier hs-var">k0</span></a></span></span><span> </span><span id="local-6989586621679130728"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130728"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679130727"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130729"><span class="hs-identifier hs-var">k0</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130728"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-468"></span><span>     </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679130725"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130725"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679130724"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130724"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679130723"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130723"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130725"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130724"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130723"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621679133483"><span id="local-6989586621679133484"><span class="annot"><a href="#local-6989586621679130727"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679130727"><span class="annot"><span class="annottext">go :: k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679130727"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130722"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130722"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130721"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130721"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130721"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="annottext">Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-474"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130720"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130720"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679130719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130719"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130718"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130718"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679130717"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130717"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130722"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130720"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-475"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679130716"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130716"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span id="local-6989586621679130715"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130715"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679130714"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130714"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679130727"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130722"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130718"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-476"></span><span>                    </span><span class="hs-glyph">!</span><span id="local-6989586621679130713"><span class="annot"><span class="annottext">gt' :: Map k a
</span><a href="#local-6989586621679130713"><span class="hs-identifier hs-var hs-var">gt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130720"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130719"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130714"><span class="hs-identifier hs-var">gt</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130717"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-477"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130716"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130715"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130713"><span class="hs-identifier hs-var">gt'</span></a></span><span>
</span><span id="line-478"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679130712"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130712"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span id="local-6989586621679130711"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130711"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679130710"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130710"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall k a.
Ord k =&gt;
k -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
</span><a href="#local-6989586621679130727"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130722"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130717"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-479"></span><span>                    </span><span class="hs-glyph">!</span><span id="local-6989586621679130709"><span class="annot"><span class="annottext">lt' :: Map k a
</span><a href="#local-6989586621679130709"><span class="hs-identifier hs-var hs-var">lt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130720"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130719"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130718"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130712"><span class="hs-identifier hs-var">lt</span></a></span><span>
</span><span id="line-480"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130709"><span class="hs-identifier hs-var">lt'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130711"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130710"><span class="hs-identifier hs-var">gt</span></a></span><span>
</span><span id="line-481"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Bool -&gt; Map k a -&gt; StrictTriple (Map k a) Bool (Map k a)
forall a b c. a -&gt; b -&gt; c -&gt; StrictTriple a b c
</span><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130718"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679130717"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-pragma hs-type">splitMember</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-keyword">data</span><span> </span><span id="StrictTriple"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span></span><span> </span><span id="local-6989586621679133480"><span class="annot"><a href="#local-6989586621679133480"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679133479"><span class="annot"><a href="#local-6989586621679133479"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679133478"><span class="annot"><a href="#local-6989586621679133478"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StrictTriple"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StrictTriple"><span class="hs-identifier hs-var">StrictTriple</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679133480"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679133479"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679133478"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | intersetDomP p m1 m2 == Keep the key and value from m2, iff (the key is in the dom of m1) &amp;&amp; ((p key value) is true)</span><span>
</span><span id="line-488"></span><span id="local-6989586621679133470"><span id="local-6989586621679133471"><span id="local-6989586621679133472"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-type">intersectDomP</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133472"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133472"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133471"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133472"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133470"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133472"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133471"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133472"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133471"><span class="hs-identifier hs-type">v2</span></a></span></span></span></span><span>
</span><span id="line-489"></span><span id="intersectDomP"><span class="annot"><span class="annottext">intersectDomP :: (k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var hs-var">intersectDomP</span></a></span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v2
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-490"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v2
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span id="local-6989586621679130707"><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130707"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679130706"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130706"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130705"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130705"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130704"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679130704"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679130703"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130703"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679130702"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130702"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130701"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130707"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130705"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679130704"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Map k v2 -&gt; Map k v2 -&gt; Map k v2
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130705"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679130704"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130700"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130699"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-494"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Map k v2 -&gt; Map k v2 -&gt; Map k v2
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130700"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130699"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679130698"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130698"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130701"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130701"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130697"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130697"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v1 -&gt; (Map k v1, Bool, Map k v1)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Bool, Map k a)
</span><a href="Control.Iterate.SetAlgebra.html#splitMember"><span class="hs-identifier hs-var">splitMember</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130705"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130706"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679130700"><span class="annot"><span class="annottext">l1l2 :: Map k v2
</span><a href="#local-6989586621679130700"><span class="hs-identifier hs-var hs-var">l1l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130707"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130698"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130703"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679130699"><span class="annot"><span class="annottext">r1r2 :: Map k v2
</span><a href="#local-6989586621679130699"><span class="hs-identifier hs-var hs-var">r1r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130707"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130697"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130702"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-499"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-pragma hs-type">intersectDomP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- |- Similar to intersectDomP, except the Map returned has the same key as the first input map, rather than the second input map.</span><span>
</span><span id="line-505"></span><span id="local-6989586621679133464"><span id="local-6989586621679133465"><span id="local-6989586621679133466"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-type">intersectDomPLeft</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133466"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133466"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133465"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133466"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133464"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133466"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133465"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133466"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133464"><span class="hs-identifier hs-type">v1</span></a></span></span></span></span><span>
</span><span id="line-506"></span><span id="intersectDomPLeft"><span class="annot"><span class="annottext">intersectDomPLeft :: (k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var hs-var">intersectDomPLeft</span></a></span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v1
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-507"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Map k v1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v1
forall k a. Map k a
</span><span class="hs-identifier hs-var">Tip</span></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span id="local-6989586621679130695"><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130695"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130694"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130694"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130693"><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679130693"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679130692"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130692"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679130691"><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130691"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130690"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130690"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-509"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679130689"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679130688"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679130688"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130695"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130694"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679130688"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v1 -&gt; Map k v1 -&gt; Map k v1 -&gt; Map k v1
forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130694"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679130693"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130687"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130686"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-511"></span><span>      </span><span id="local-6989586621679130685"><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679130685"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v1 -&gt; Map k v1 -&gt; Map k v1
forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130687"><span class="hs-identifier hs-var">l1l2</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130686"><span class="hs-identifier hs-var">r1r2</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679130684"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130684"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130689"><span class="annot"><span class="annottext">Maybe v2
</span><a href="#local-6989586621679130689"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130683"><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130683"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v2 -&gt; (Map k v2, Maybe v2, Map k v2)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130694"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130690"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679130687"><span class="annot"><span class="annottext">l1l2 :: Map k v1
</span><a href="#local-6989586621679130687"><span class="hs-identifier hs-var hs-var">l1l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130695"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130692"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130684"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679130686"><span class="annot"><span class="annottext">r1r2 :: Map k v1
</span><a href="#local-6989586621679130686"><span class="hs-identifier hs-var hs-var">r1r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v2 -&gt; Bool
</span><a href="#local-6989586621679130695"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v1
</span><a href="#local-6989586621679130691"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v2
</span><a href="#local-6989586621679130683"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-516"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-pragma hs-type">intersectDomPLeft</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- |- fold over the intersection of a Map and a Set</span><span>
</span><span id="line-519"></span><span id="local-6989586621679133458"><span id="local-6989586621679133459"><span id="local-6989586621679133460"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-type">intersectMapSetFold</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133460"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133460"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133459"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133458"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133458"><span class="hs-identifier hs-type">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133460"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133459"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679133460"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133458"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133458"><span class="hs-identifier hs-type">ans</span></a></span></span></span></span><span>
</span><span id="line-520"></span><span id="intersectMapSetFold"><span class="annot"><span class="annottext">intersectMapSetFold :: (k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var hs-var">intersectMapSetFold</span></a></span></span><span> </span><span id="local-6989586621679130681"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130681"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130680"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130680"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130680"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-521"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span id="local-6989586621679130679"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130679"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130678"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130678"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130677"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130677"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130678"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130677"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-522"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span id="local-6989586621679130676"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130676"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130675"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130675"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130674"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130674"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679130673"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130673"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679130672"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130672"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130671"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130671"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130670"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130670"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130676"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130673"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130669"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130668"><span class="hs-identifier hs-var">addKV</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130675"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130674"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130676"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130672"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130667"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130670"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130669"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130669"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130666"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130666"><span class="hs-identifier hs-var">found</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130667"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130667"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130675"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130671"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-525"></span><span>        </span><span id="local-6989586621679130668"><span class="annot"><span class="annottext">addKV :: k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130668"><span class="hs-identifier hs-var hs-var">addKV</span></a></span></span><span> </span><span id="local-6989586621679130665"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130665"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679130664"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130664"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130663"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130663"><span class="hs-identifier hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130666"><span class="hs-identifier hs-var">found</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130676"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130665"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130664"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130663"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130663"><span class="hs-identifier hs-var">ans1</span></a></span><span>
</span><span id="line-526"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-pragma hs-type">intersectMapSetFold</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">-- | Fold with 'accum' all those pairs in the map, not appearing in the set.</span><span>
</span><span id="line-529"></span><span id="local-6989586621679130660"><span id="local-6989586621679130661"><span id="local-6989586621679130662"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-type">disjointMapSetFold</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130662"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130662"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130661"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130660"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130660"><span class="hs-identifier hs-type">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130662"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130661"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130662"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130660"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130660"><span class="hs-identifier hs-type">ans</span></a></span></span></span></span><span>
</span><span id="line-530"></span><span id="disjointMapSetFold"><span class="annot"><span class="annottext">disjointMapSetFold :: (k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var hs-var">disjointMapSetFold</span></a></span></span><span> </span><span id="local-6989586621679130658"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130658"><span class="hs-identifier hs-var">_accum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><span class="hs-identifier hs-var">Tip</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130657"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130657"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130657"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-531"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span id="local-6989586621679130656"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130656"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679130655"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130655"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130654"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130654"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130653"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130653"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130654"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; ans -&gt; Map k v -&gt; ans
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey'</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130656"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130653"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130655"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-532"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span id="local-6989586621679130651"><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130651"><span class="hs-identifier hs-var">accum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bin</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679130650"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130650"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130649"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130649"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679130648"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130648"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679130647"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130647"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130646"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130646"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130645"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130645"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130651"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130648"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130644"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130643"><span class="hs-identifier hs-var">addKV</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130650"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130649"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130651"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130647"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130642"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130645"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130644"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130644"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130641"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130641"><span class="hs-identifier hs-var">found</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130642"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130642"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; (Set k, Bool, Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Bool, Set a)
</span><span class="hs-identifier hs-var">Set.splitMember</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130650"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130646"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span id="local-6989586621679130643"><span class="annot"><span class="annottext">addKV :: k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130643"><span class="hs-identifier hs-var hs-var">addKV</span></a></span></span><span> </span><span id="local-6989586621679130640"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130640"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679130639"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130639"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679130638"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130638"><span class="hs-identifier hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679130641"><span class="hs-identifier hs-var">found</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130651"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130640"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130639"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130638"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130638"><span class="hs-identifier hs-var">ans1</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- ============== Iter BiMap ====================</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span id="local-6989586621679130636"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130625"><span id="local-6989586621679130630"><span id="local-6989586621679130632"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130636"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-540"></span><span>  </span><span id="local-6989586621679130624"><span class="annot"><span class="annottext">nxt :: BiMap v a b -&gt; Collect (a, b, BiMap v a b)
</span><a href="#local-6989586621679130624"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679130623"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130623"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679130622"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679130622"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, BiMap v a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, BiMap v a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130621"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130621"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130620"><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130620"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-541"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130623"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-542"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130621"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130619"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130619"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130618"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130618"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679130617"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130617"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130620"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130619"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130618"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679130617"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679130622"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130621"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>  </span><span id="local-6989586621679130616"><span class="annot"><span class="annottext">lub :: k -&gt; BiMap v k b -&gt; Collect (k, b, BiMap v k b)
</span><a href="#local-6989586621679130616"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679130615"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130615"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679130614"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130614"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679130613"><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679130613"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, BiMap v k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, BiMap v k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130612"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130612"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679130611"><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130611"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-545"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130615"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130614"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span>           </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-546"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130610"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130610"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679130609"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130609"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130608"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130608"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130611"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130615"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130609"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130608"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679130613"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130612"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-547"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130607"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130607"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b
</span><span class="hs-identifier hs-var">Tip</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130612"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-548"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679130606"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130606"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span id="local-6989586621679130605"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130605"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679130611"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130604"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130603"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130602"><span class="hs-identifier hs-var">m3</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679130613"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679130612"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-549"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679130604"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130604"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130603"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130603"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679130602"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130602"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679130605"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span id="local-6989586621679130601"><span class="annot"><span class="annottext">isnull :: BiMap v k v -&gt; Bool
</span><a href="#local-6989586621679130601"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679130600"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130600"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679130599"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679130599"><span class="hs-identifier hs-var">_g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130600"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679130598"><span class="annot"><span class="annottext">lookup :: key -&gt; BiMap v key rng -&gt; Maybe rng
</span><a href="#local-6989586621679130598"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679130597"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679130596"><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679130596"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679130595"><span class="annot"><span class="annottext">Map rng (Set key)
</span><a href="#local-6989586621679130595"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130597"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679130596"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679130594"><span class="annot"><span class="annottext">haskey :: key -&gt; BiMap v key b -&gt; Bool
</span><a href="#local-6989586621679130594"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679130593"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130593"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679130592"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679130592"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679130591"><span class="annot"><span class="annottext">Map b (Set key)
</span><a href="#local-6989586621679130591"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679130593"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679130592"><span class="hs-identifier hs-var">left</span></a></span></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- BaseRep witnesses Basic types. I.e. those types that are instances of both Basic and Iter.</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- It is used in constructors 'Base' and 'BaseD' and functions 'materialize' and 'fromList'</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-keyword">data</span><span> </span><span id="BaseRep"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-var">BaseRep</span></a></span></span><span> </span><span id="local-6989586621679130590"><span class="annot"><a href="#local-6989586621679130590"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679130589"><span class="annot"><a href="#local-6989586621679130589"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679130588"><span class="annot"><a href="#local-6989586621679130588"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-561"></span><span>   </span><span id="local-6989586621679133373"><span id="local-6989586621679133374"><span id="MapR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span></span><span class="hs-glyph">::</span><span>    </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679133374"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133373"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-562"></span><span>   </span><span id="local-6989586621679133371"><span id="SetR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span></span><span class="hs-glyph">::</span><span>    </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133371"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-563"></span><span>   </span><span id="local-6989586621679133367"><span id="local-6989586621679133368"><span id="ListR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span></span><span class="hs-glyph">::</span><span>   </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133368"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133367"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-564"></span><span>   </span><span id="local-6989586621679133363"><span id="local-6989586621679133364"><span id="SingleR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133363"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-565"></span><span>   </span><span id="local-6989586621679133358"><span id="local-6989586621679133359"><span id="BiMapR"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-comment">-- ==========================================================================</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- The most basic operation of iteration, where (Iter f) is to use the 'nxt'</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- operator on (f k v) to create a (Collect k v). The two possible</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- ways to produce their elements are in LIFO or FIFO order.</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span id="local-6989586621679133429"><span id="local-6989586621679133430"><span id="local-6989586621679133431"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-type">lifo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133431"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133431"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133430"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133429"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133430"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133429"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-575"></span><span id="lifo"><span class="annot"><span class="annottext">lifo :: f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var hs-var">lifo</span></a></span></span><span> </span><span id="local-6989586621679130581"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130581"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130580"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130580"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130579"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130579"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130578"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130578"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130581"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130580"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130579"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130578"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span id="local-6989586621679130574"><span id="local-6989586621679130575"><span id="local-6989586621679130576"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-type">fifo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130576"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130576"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130575"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130574"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130575"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130574"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-578"></span><span id="fifo"><span class="annot"><span class="annottext">fifo :: f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var hs-var">fifo</span></a></span></span><span> </span><span id="local-6989586621679130572"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130572"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130571"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130571"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130570"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130570"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130569"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130569"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130572"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Collect (k, v) -&gt; (k, v) -&gt; Collect (k, v)
forall t. Collect t -&gt; t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#rear"><span class="hs-identifier hs-var">rear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130569"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130571"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130570"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-comment">-- ================================================================================================</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- | The self typed GADT: Exp, that encodes the shape of Set expressions. A deep embedding.</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- Exp is a typed Symbolic representation of queries we may ask. It allows us to introspect a query</span><span>
</span><span id="line-584"></span><span class="hs-comment">-- The strategy is to</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- 1) Define Exp so all queries can be represented.</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- 2) Define smart constructors that &quot;parse&quot; the surface syntax, and build a typed Exp</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- 3) Write an evaluate function:  eval:: Exp t -&gt; t</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- 4) &quot;eval&quot; can introspect the code and apply efficient domain and type specific translations</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- 5) Use the (Iter f) class to evaluate some Exp that can benefit from its efficient nature.</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-keyword">data</span><span> </span><span id="Exp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span></span><span> </span><span id="local-6989586621679130567"><span class="annot"><a href="#local-6989586621679130567"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>   </span><span id="local-6989586621679130564"><span id="local-6989586621679130565"><span id="local-6989586621679130566"><span id="Base"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130566"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130565"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130565"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130566"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130564"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130565"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130566"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130564"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130565"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130566"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130564"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- Note the use of BaseRep to witness what Base type.</span><span>
</span><span id="line-594"></span><span>   </span><span id="local-6989586621679130560"><span id="local-6989586621679130561"><span id="local-6989586621679130562"><span id="Dom"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130561"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130560"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-595"></span><span>   </span><span id="local-6989586621679130556"><span id="local-6989586621679130557"><span id="local-6989586621679130558"><span id="Rng"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-var">Rng</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130558"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130557"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130556"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130558"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130557"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130557"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-596"></span><span>   </span><span id="local-6989586621679130551"><span id="local-6989586621679130552"><span id="local-6989586621679130553"><span id="local-6989586621679130554"><span id="DRestrict"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130554"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130553"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130553"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130554"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130552"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130554"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130551"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130552"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130554"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130551"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-597"></span><span>   </span><span id="local-6989586621679130546"><span id="local-6989586621679130547"><span id="local-6989586621679130548"><span id="local-6989586621679130549"><span id="DExclude"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130549"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130548"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130548"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130549"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130547"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130549"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130546"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130547"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130549"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130546"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-598"></span><span>   </span><span id="local-6989586621679130541"><span id="local-6989586621679130542"><span id="local-6989586621679130543"><span id="local-6989586621679130544"><span id="RRestrict"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130544"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130543"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130542"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130541"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130544"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130542"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130543"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130542"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130541"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130544"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130542"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-599"></span><span>   </span><span id="local-6989586621679130536"><span id="local-6989586621679130537"><span id="local-6989586621679130538"><span id="local-6989586621679130539"><span id="RExclude"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130539"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130538"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130537"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130536"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130539"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130537"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130538"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130537"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130536"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130539"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130537"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-600"></span><span>   </span><span id="local-6989586621679130533"><span id="local-6989586621679130534"><span id="Elem"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130533"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130534"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130533"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130534"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-601"></span><span>   </span><span id="local-6989586621679130530"><span id="local-6989586621679130531"><span id="NotElem"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-var">NotElem</span></a></span></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130531"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130530"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130531"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130531"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130530"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130531"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-602"></span><span>   </span><span id="local-6989586621679130524"><span id="local-6989586621679130525"><span id="local-6989586621679130526"><span id="local-6989586621679130527"><span id="local-6989586621679130528"><span id="Intersect"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-var">Intersect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130528"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130527"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130526"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130525"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130524"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-603"></span><span>   </span><span id="local-6989586621679130518"><span id="local-6989586621679130519"><span id="local-6989586621679130520"><span id="local-6989586621679130521"><span id="local-6989586621679130522"><span id="Subset"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-var">Subset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130522"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130521"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130520"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130521"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130522"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130519"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130520"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130522"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130518"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-604"></span><span>   </span><span id="local-6989586621679130513"><span id="local-6989586621679130514"><span id="local-6989586621679130515"><span id="local-6989586621679130516"><span id="UnionOverrideLeft"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-var">UnionOverrideLeft</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130516"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130515"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130516"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130514"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130516"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130515"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130513"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130516"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130515"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130514"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130516"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130515"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-605"></span><span>        </span><span class="hs-comment">-- The (Show k, Show v) supports logging errors if there are duplicate keys.</span><span>
</span><span id="line-606"></span><span>   </span><span id="local-6989586621679130509"><span id="local-6989586621679130510"><span id="local-6989586621679130511"><span id="UnionPlus"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-var">UnionPlus</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130511"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679130510"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130509"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130511"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130510"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130509"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130511"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130510"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130509"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130511"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130510"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-607"></span><span>   </span><span id="local-6989586621679130504"><span id="local-6989586621679130505"><span id="local-6989586621679130506"><span id="local-6989586621679130507"><span id="UnionOverrideRight"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-var">UnionOverrideRight</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130507"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130506"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130507"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130504"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130507"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130506"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130507"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-608"></span><span>   </span><span id="local-6989586621679130501"><span id="local-6989586621679130502"><span id="Singleton"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130502"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130501"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130502"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130501"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-609"></span><span>   </span><span id="local-6989586621679130499"><span id="SetSingleton"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130499"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130499"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130499"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-610"></span><span>   </span><span id="local-6989586621679130493"><span id="local-6989586621679130494"><span id="local-6989586621679130495"><span id="local-6989586621679130496"><span id="local-6989586621679130497"><span id="KeyEqual"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-var">KeyEqual</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130497"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130496"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130495"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130496"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130497"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130494"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130495"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130497"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130493"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">-- deriving instance NFData t =&gt; NFData(Exp t)</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">-- =======================================================================================================</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- When we build an Exp, we want to make sure all Sets with one element become (SetSingleton x)</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- so we use these 'smart' constructors.</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span id="local-6989586621679130488"><span id="local-6989586621679130489"><span id="local-6989586621679130490"><span id="local-6989586621679130491"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-type">dRestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130491"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130490"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130490"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130491"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130491"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130488"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130491"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130488"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-620"></span><span id="dRestrict"><span class="annot"><span class="annottext">dRestrict :: Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var hs-var">dRestrict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130486"><span class="annot"><a href="#local-6989586621679130486"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130485"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130485"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130486"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Single k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130486"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
Exp (f k v)
</span><a href="#local-6989586621679130485"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-621"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var">dRestrict</span></a></span><span> </span><span id="local-6989586621679130482"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679130482"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130481"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130481"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-var">DRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679130482"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130481"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span id="local-6989586621679130477"><span id="local-6989586621679130478"><span id="local-6989586621679130479"><span id="local-6989586621679130480"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-type">rRestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130480"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130479"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130478"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130477"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130480"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130478"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130479"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130478"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130477"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130480"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130478"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-624"></span><span id="rRestrict"><span class="annot"><span class="annottext">rRestrict :: Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var hs-var">rRestrict</span></a></span></span><span> </span><span id="local-6989586621679130475"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130475"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130474"><span class="annot"><a href="#local-6989586621679130474"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130474"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Single v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130475"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130474"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var">rRestrict</span></a></span><span> </span><span id="local-6989586621679130473"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130473"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679130472"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679130472"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-var">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130473"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679130472"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span id="local-6989586621679130468"><span id="local-6989586621679130469"><span id="local-6989586621679130470"><span id="local-6989586621679130471"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-type">dExclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130471"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130470"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130470"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130471"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130469"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130471"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130468"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130469"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130471"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130468"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-628"></span><span id="dExclude"><span class="annot"><span class="annottext">dExclude :: Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var hs-var">dExclude</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130466"><span class="annot"><a href="#local-6989586621679130466"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130465"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130465"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130466"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Single k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130466"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
Exp (f k v)
</span><a href="#local-6989586621679130465"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-629"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var">dExclude</span></a></span><span> </span><span id="local-6989586621679130464"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679130464"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130463"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130463"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-var">DExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679130464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130463"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span id="local-6989586621679130459"><span id="local-6989586621679130460"><span id="local-6989586621679130461"><span id="local-6989586621679130462"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-type">rExclude</span></a></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130462"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130461"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130460"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130459"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130462"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130460"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130461"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130460"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130459"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130462"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130460"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-632"></span><span id="rExclude"><span class="annot"><span class="annottext">rExclude :: Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var hs-var">rExclude</span></a></span></span><span> </span><span id="local-6989586621679130457"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130457"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679130456"><span class="annot"><a href="#local-6989586621679130456"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130456"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Single v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130457"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set k -&gt; k
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130456"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var">rExclude</span></a></span><span> </span><span id="local-6989586621679130455"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130455"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679130454"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679130454"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-var">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679130455"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679130454"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- =================================================================</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- | Basic types are those that can be embedded into Exp.</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- The HasExp class, encodes how to lift a Basic type into an Exp.</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- The function 'toExp' will build a typed Exp for that Basic type.</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- This will be really usefull in the smart constructors.</span><span>
</span><span id="line-640"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-keyword">class</span><span> </span><span id="HasExp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-var">HasExp</span></a></span></span><span> </span><span id="local-6989586621679133381"><span class="annot"><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679133380"><span class="annot"><a href="#local-6989586621679133380"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133380"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-643"></span><span>  </span><span id="toExp"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-type">toExp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133380"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- | The simplest Base type is one that is already an Exp</span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span id="local-6989586621679130452"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130452"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130452"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-648"></span><span>  </span><span id="local-6989586621679130449"><span class="annot"><span class="annottext">toExp :: Exp t -&gt; Exp t
</span><a href="#local-6989586621679130449"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130448"><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679130448"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679130448"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span id="local-6989586621679130446"><span id="local-6989586621679130447"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130447"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130447"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130446"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679130447"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130446"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679130444"><span class="annot"><span class="annottext">toExp :: Map k v -&gt; Exp (Map k v)
</span><a href="#local-6989586621679130444"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130443"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130443"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v -&gt; Map k v -&gt; Exp (Map k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v
forall k v. Basic Map =&gt; BaseRep Map k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130443"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span id="local-6989586621679130442"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130442"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679130442"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130442"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>  </span><span id="local-6989586621679130440"><span class="annot"><span class="annottext">toExp :: Set k -&gt; Exp (Sett k ())
</span><a href="#local-6989586621679130440"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130439"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130439"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130439"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span id="local-6989586621679130437"><span id="local-6989586621679130438"><span class="hs-keyword">instance</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130438"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130438"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130437"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130438"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130437"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-658"></span><span>  </span><span id="local-6989586621679130435"><span class="annot"><span class="annottext">toExp :: [(k, v)] -&gt; Exp (List k v)
</span><a href="#local-6989586621679130435"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130434"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130434"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; List k v -&gt; Exp (List k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130433"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679130433"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130432"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679130432"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679130433"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679130432"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130434"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span id="local-6989586621679130430"><span id="local-6989586621679130431"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130431"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130431"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130430"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130431"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130430"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>  </span><span id="local-6989586621679130428"><span class="annot"><span class="annottext">toExp :: Single k v -&gt; Exp (Single k v)
</span><a href="#local-6989586621679130428"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130427"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130427"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Exp (Single k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130427"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span id="local-6989586621679130425"><span id="local-6989586621679130426"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130426"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130426"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130426"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-664"></span><span>  </span><span id="local-6989586621679130423"><span class="annot"><span class="annottext">toExp :: Bimap k v -&gt; Exp (Bimap k v)
</span><a href="#local-6989586621679130423"><span class="hs-identifier hs-var hs-var hs-var hs-var">toExp</span></a></span></span><span> </span><span id="local-6989586621679130422"><span class="annot"><span class="annottext">Bimap k v
</span><a href="#local-6989586621679130422"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v -&gt; Bimap k v -&gt; Exp (Bimap k v)
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
BaseRep f k v -&gt; f k v -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v
forall v k. (Basic (BiMap v), Ord v) =&gt; BaseRep (BiMap v) k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap k v
</span><a href="#local-6989586621679130422"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- ==========================================================================================</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- Smart constructors build typed Exp with real values at the leaves (the Base constuctor)</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span class="hs-comment">-- (&#8838;),</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- (&#8745;),</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span id="local-6989586621679130418"><span id="local-6989586621679130419"><span id="local-6989586621679130420"><span id="local-6989586621679130421"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dom"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130421"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130420"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130419"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130421"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130418"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130420"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130421"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-674"></span><span id="dom"><span class="annot"><span class="annottext">dom :: s -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#dom"><span class="hs-identifier hs-var hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621679130416"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130416"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
Exp (f k v) -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130416"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span id="local-6989586621679130412"><span id="local-6989586621679130413"><span id="local-6989586621679130414"><span id="local-6989586621679130415"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rng"><span class="hs-identifier hs-type">rng</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130415"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130414"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130412"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130415"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130414"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130413"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130414"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-677"></span><span id="rng"><span class="annot"><span class="annottext">rng :: s -&gt; Exp (Sett v ())
</span><a href="Control.Iterate.SetAlgebra.html#rng"><span class="hs-identifier hs-var hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621679130410"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130410"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (Sett v ())
forall k v (f :: * -&gt; * -&gt; *).
(Ord k, Ord v) =&gt;
Exp (f k v) -&gt; Exp (Sett v ())
</span><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-var">Rng</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130410"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span id="local-6989586621679133329"><span id="local-6989586621679133330"><span id="local-6989586621679133331"><span id="local-6989586621679133332"><span id="local-6989586621679133333"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-type">(&#9665;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%3C%7C"><span class="hs-operator hs-type">(&lt;|)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-type">drestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133333"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133332"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133333"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133331"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133330"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133333"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133329"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133332"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133331"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133330"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133333"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133329"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-680"></span><span id="%25C1"><span class="annot"><span class="annottext">&#9665; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-var hs-var">(&#9665;)</span></a></span></span><span> </span><span id="local-6989586621679130406"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130406"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130405"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130405"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dRestrict"><span class="hs-identifier hs-var">dRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (Sett k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130406"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130405"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span id="drestrict"><span class="annot"><span class="annottext">drestrict :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-var hs-var">drestrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, HasExp s1 (Sett k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25C1"><span class="hs-operator hs-var">(&#9665;)</span></a></span><span>
</span><span id="line-682"></span><span id="%3C%7C"><span class="annot"><span class="annottext">&lt;| :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%3C%7C"><span class="hs-operator hs-var hs-var">(&lt;|)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, HasExp s1 (Sett k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#drestrict"><span class="hs-identifier hs-var">drestrict</span></a></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span id="local-6989586621679133307"><span id="local-6989586621679133308"><span id="local-6989586621679133309"><span id="local-6989586621679133310"><span id="local-6989586621679133311"><span id="local-6989586621679133312"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-type">(&#8938;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#dexclude"><span class="hs-identifier hs-type">dexclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133312"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133311"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133310"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133311"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133312"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133309"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133308"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133312"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133307"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133310"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133309"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133308"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133312"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133307"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-685"></span><span id="%22EA"><span class="annot"><span class="annottext">&#8938; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-var hs-var">(&#8938;)</span></a></span></span><span> </span><span id="local-6989586621679130402"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130402"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130401"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130401"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g) =&gt;
Exp (g k ()) -&gt; Exp (f k v) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dExclude"><span class="hs-identifier hs-var">dExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130402"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130401"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span id="dexclude"><span class="annot"><span class="annottext">dexclude :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#dexclude"><span class="hs-identifier hs-var hs-var">dexclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) s1 s2 (f :: * -&gt; * -&gt; *) v.
(Ord k, Iter g, HasExp s1 (g k ()), HasExp s2 (f k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EA"><span class="hs-operator hs-var">(&#8938;)</span></a></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span id="local-6989586621679133290"><span id="local-6989586621679133291"><span id="local-6989586621679133292"><span id="local-6989586621679133293"><span id="local-6989586621679133294"><span id="local-6989586621679133295"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-type">(&#9655;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%7C%3E"><span class="hs-operator hs-type">(|&gt;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rrestrict"><span class="hs-identifier hs-type">rrestrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133295"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133294"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133292"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133291"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133295"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133290"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133294"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133293"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133292"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133290"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133291"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133295"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-689"></span><span id="%25B7"><span class="annot"><span class="annottext">&#9655; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var hs-var">(&#9655;)</span></a></span></span><span> </span><span id="local-6989586621679130397"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130397"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130396"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130396"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rRestrict"><span class="hs-identifier hs-var">rRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130397"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g v ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130396"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span id="rrestrict"><span class="annot"><span class="annottext">rrestrict :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rrestrict"><span class="hs-identifier hs-var hs-var">rrestrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var">(&#9655;)</span></a></span><span>
</span><span id="line-691"></span><span id="%7C%3E"><span class="annot"><span class="annottext">|&gt; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%7C%3E"><span class="hs-operator hs-var hs-var">(|&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%25B7"><span class="hs-operator hs-var">(&#9655;)</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span id="local-6989586621679130390"><span id="local-6989586621679130391"><span id="local-6989586621679130392"><span id="local-6989586621679130393"><span id="local-6989586621679130394"><span id="local-6989586621679130395"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-type">(&#8939;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rexclude"><span class="hs-identifier hs-type">rexclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130394"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130392"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130391"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130395"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130390"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130394"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130392"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130390"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130391"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130395"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130393"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-694"></span><span id="%22EB"><span class="annot"><span class="annottext">&#8939; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-var hs-var">(&#8939;)</span></a></span></span><span> </span><span id="local-6989586621679130387"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130387"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130386"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130386"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v (f :: * -&gt; * -&gt; *).
(Ord k, Iter g, Ord v) =&gt;
Exp (f k v) -&gt; Exp (g v ()) -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rExclude"><span class="hs-identifier hs-var">rExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130387"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g v ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130386"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span id="rexclude"><span class="annot"><span class="annottext">rexclude :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#rexclude"><span class="hs-identifier hs-var hs-var">rexclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k (g :: * -&gt; * -&gt; *) v s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Iter g, Ord v, HasExp s1 (f k v), HasExp s2 (g v ())) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%22EB"><span class="hs-operator hs-var">(&#8939;)</span></a></span><span>
</span><span id="line-696"></span><span id="local-6989586621679130383"><span id="local-6989586621679130384"><span id="local-6989586621679130385"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2208"><span class="hs-operator hs-type">(&#8712;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679130385"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130385"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130384"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130383"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130384"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130385"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130385"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130383"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-697"></span><span id="%2208"><span class="annot"><span class="annottext">&#8712; :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2208"><span class="hs-operator hs-var hs-var">(&#8712;)</span></a></span></span><span> </span><span id="local-6989586621679130381"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130381"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130380"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130380"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130381"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130380"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span id="local-6989586621679133261"><span id="local-6989586621679133262"><span id="local-6989586621679133263"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-type">(&#8713;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#notelem"><span class="hs-identifier hs-type">notelem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679133263"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133263"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133262"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133261"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133262"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133263"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133263"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133261"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-700"></span><span id="%2209"><span class="annot"><span class="annottext">&#8713; :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-var hs-var">(&#8713;)</span></a></span></span><span> </span><span id="local-6989586621679130377"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130377"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130376"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130376"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-var">NotElem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130377"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; Exp (g k ())
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130376"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span id="notelem"><span class="annot"><span class="annottext">notelem :: k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#notelem"><span class="hs-identifier hs-var hs-var">notelem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; s -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *) s.
(Show k, Ord k, Iter g, HasExp s (g k ())) =&gt;
k -&gt; s -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2209"><span class="hs-operator hs-var">(&#8713;)</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span id="local-6989586621679133240"><span id="local-6989586621679133241"><span id="local-6989586621679133242"><span id="local-6989586621679133243"><span id="local-6989586621679133244"><span id="local-6989586621679133245"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-type">(&#8746;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionleft"><span class="hs-identifier hs-type">unionleft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679133245"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679133244"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133245"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133243"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133245"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133244"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133241"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133240"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133245"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133244"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133243"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133241"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133245"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133244"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-704"></span><span id="%222A"><span class="annot"><span class="annottext">&#8746; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-var hs-var">(&#8746;)</span></a></span></span><span> </span><span id="local-6989586621679130373"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130373"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130372"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130372"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k v) -&gt; Exp (f k v)
forall k v (k :: * -&gt; * -&gt; *) (n :: * -&gt; * -&gt; *).
(Show k, Show v, Ord k) =&gt;
Exp (k k v) -&gt; Exp (n k v) -&gt; Exp (k k v)
</span><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-var">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130373"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130372"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span id="unionleft"><span class="annot"><span class="annottext">unionleft :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#unionleft"><span class="hs-identifier hs-var hs-var">unionleft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k v s1 (f :: * -&gt; * -&gt; *) s2 (g :: * -&gt; * -&gt; *).
(Show k, Show v, Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%222A"><span class="hs-operator hs-var">(&#8746;)</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span id="local-6989586621679133220"><span id="local-6989586621679133221"><span id="local-6989586621679133222"><span id="local-6989586621679133223"><span id="local-6989586621679133224"><span id="local-6989586621679133225"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-type">(&#10755;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionright"><span class="hs-identifier hs-type">unionright</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133225"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133224"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133223"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133222"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133221"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133220"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133222"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133224"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133221"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133223"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133225"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133222"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-708"></span><span id="%2A03"><span class="annot"><span class="annottext">&#10755; :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-var hs-var">(&#10755;)</span></a></span></span><span> </span><span id="local-6989586621679130369"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130369"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130368"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130368"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k v) -&gt; Exp (f k v)
forall k (f :: * -&gt; * -&gt; *) k (v :: * -&gt; * -&gt; *).
Ord k =&gt;
Exp (f k k) -&gt; Exp (v k k) -&gt; Exp (f k k)
</span><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-var">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130369"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130368"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span id="unionright"><span class="annot"><span class="annottext">unionright :: s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#unionright"><span class="hs-identifier hs-var hs-var">unionright</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k v)
forall k s1 (f :: * -&gt; * -&gt; *) v s2 (g :: * -&gt; * -&gt; *).
(Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="Control.Iterate.SetAlgebra.html#%2A03"><span class="hs-operator hs-var">(&#10755;)</span></a></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span id="local-6989586621679133204"><span id="local-6989586621679133205"><span id="local-6989586621679133206"><span id="local-6989586621679133207"><span id="local-6989586621679133208"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-type">(&#8746;+)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#unionplus"><span class="hs-identifier hs-type">unionplus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133208"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679133207"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133206"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133205"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133208"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133207"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133204"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133205"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133208"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133207"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133206"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133204"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133205"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133208"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133207"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-712"></span><span id="%222A%2B"><span class="annot"><span class="annottext">&#8746;+ :: s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-var hs-var">(&#8746;+)</span></a></span></span><span> </span><span id="local-6989586621679130365"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130365"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130364"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130364"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; Exp (f k n) -&gt; Exp (f k n)
forall k n (f :: * -&gt; * -&gt; *).
(Ord k, Monoid n) =&gt;
Exp (f k n) -&gt; Exp (f k n) -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-var">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k n)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130365"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (f k n)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130364"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span id="unionplus"><span class="annot"><span class="annottext">unionplus :: s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#unionplus"><span class="hs-identifier hs-var hs-var">unionplus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (f k n)
forall k n s1 (f :: * -&gt; * -&gt; *) s2.
(Ord k, Monoid n, HasExp s1 (f k n), HasExp s2 (f k n)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k n)
</span><a href="Control.Iterate.SetAlgebra.html#%222A%2B"><span class="hs-operator hs-var">(&#8746;+)</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span id="local-6989586621679130362"><span id="local-6989586621679130363"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130363"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130363"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130362"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130363"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130362"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-716"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: k -&gt; v -&gt; Exp (Single k v)
</span><a href="Control.Iterate.SetAlgebra.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679130360"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130360"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130359"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130359"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Exp (Single k v)
forall k v. Ord k =&gt; k -&gt; v -&gt; Exp (Single k v)
</span><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130360"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130359"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span id="local-6989586621679130358"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#setSingleton"><span class="hs-identifier hs-type">setSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130358"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130358"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-719"></span><span id="setSingleton"><span class="annot"><span class="annottext">setSingleton :: k -&gt; Exp (Single k ())
</span><a href="Control.Iterate.SetAlgebra.html#setSingleton"><span class="hs-identifier hs-var hs-var">setSingleton</span></a></span></span><span> </span><span id="local-6989586621679130356"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130356"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Exp (Single k ())
forall v. Ord v =&gt; v -&gt; Exp (Single v ())
</span><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-var">SetSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130356"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span id="local-6989586621679133179"><span id="local-6989586621679133180"><span id="local-6989586621679133181"><span id="local-6989586621679133182"><span id="local-6989586621679133183"><span id="local-6989586621679133184"><span id="local-6989586621679133185"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-type">(&#8745;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#intersect"><span class="hs-identifier hs-type">intersect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133185"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133184"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133183"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133182"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133184"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133185"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133181"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133180"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133183"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133185"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133179"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133182"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133180"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133185"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-722"></span><span id="%2229"><span class="annot"><span class="annottext">&#8745; :: s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-var hs-var">(&#8745;)</span></a></span></span><span> </span><span id="local-6989586621679130353"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130353"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130352"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130352"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-var">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130353"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130352"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span id="intersect"><span class="annot"><span class="annottext">intersect :: s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#intersect"><span class="hs-identifier hs-var hs-var">intersect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp (Sett k ())
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp (Sett k ())
</span><a href="Control.Iterate.SetAlgebra.html#%2229"><span class="hs-operator hs-var">(&#8745;)</span></a></span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span id="local-6989586621679133158"><span id="local-6989586621679133159"><span id="local-6989586621679133160"><span id="local-6989586621679133161"><span id="local-6989586621679133162"><span id="local-6989586621679133163"><span id="local-6989586621679133164"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-type">(&#8838;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#subset"><span class="hs-identifier hs-type">subset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679133164"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133163"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133162"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133161"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133163"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133164"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133160"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133159"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133162"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133164"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133158"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133161"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133159"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-726"></span><span id="%2286"><span class="annot"><span class="annottext">&#8838; :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-var hs-var">(&#8838;)</span></a></span></span><span> </span><span id="local-6989586621679130349"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130349"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130348"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130348"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-var">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130349"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130348"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span id="subset"><span class="annot"><span class="annottext">subset :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#subset"><span class="hs-identifier hs-var hs-var">subset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%2286"><span class="hs-operator hs-var">(&#8838;)</span></a></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span id="local-6989586621679130341"><span id="local-6989586621679130342"><span id="local-6989586621679130343"><span id="local-6989586621679130344"><span id="local-6989586621679130345"><span id="local-6989586621679130346"><span id="local-6989586621679130347"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-type">(&#8781;)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#keyeq"><span class="hs-identifier hs-type">keyeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130347"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130346"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130345"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130344"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130346"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130347"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130343"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasExp"><span class="hs-identifier hs-type">HasExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130342"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130345"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130347"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130341"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130344"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130342"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-730"></span><span id="%224D"><span class="annot"><span class="annottext">&#8781; :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-var hs-var">(&#8781;)</span></a></span></span><span> </span><span id="local-6989586621679130338"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130338"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130337"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130337"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) v u.
(Ord k, Iter f, Iter g) =&gt;
Exp (f k v) -&gt; Exp (g k u) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-var">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s1 -&gt; Exp (f k v)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679130338"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s2 -&gt; Exp (g k u)
forall s t. HasExp s t =&gt; s -&gt; Exp t
</span><a href="Control.Iterate.SetAlgebra.html#toExp"><span class="hs-identifier hs-var">toExp</span></a></span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679130337"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span id="keyeq"><span class="annot"><span class="annottext">keyeq :: s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#keyeq"><span class="hs-identifier hs-var hs-var">keyeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s1 -&gt; s2 -&gt; Exp Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) s1 v s2 u.
(Ord k, Iter f, Iter g, HasExp s1 (f k v), HasExp s2 (g k u)) =&gt;
s1 -&gt; s2 -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#%224D"><span class="hs-operator hs-var">(&#8781;)</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">--</span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="hs-comment">-- =================================================================================================</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- | Symbolc functions (Fun) are data, that can be pattern matched over. They</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- 1) Represent a wide class of binary functions that are used in translating the SetAlgebra</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- 2) Turned into a String so they can be printed</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- 3) Turned into the function they represent.</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- 4) Composed into bigger functions</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- 5) Symbolically symplified</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- Here  we implement Symbolic Binary functions with upto 4 variables, which is enough for this use</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- =================================================================================================</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-keyword">data</span><span> </span><span id="Pat"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-var">Pat</span></a></span></span><span> </span><span id="local-6989586621679130336"><span class="annot"><a href="#local-6989586621679130336"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621679130335"><span class="annot"><a href="#local-6989586621679130335"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-746"></span><span>  </span><span id="local-6989586621679130332"><span id="local-6989586621679130333"><span id="local-6989586621679130334"><span id="local-6989586621679133043"><span id="P1"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133043"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130334"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130333"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130332"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133043"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span><span>
</span><span id="line-747"></span><span>  </span><span id="local-6989586621679130328"><span id="local-6989586621679130329"><span id="local-6989586621679130330"><span id="local-6989586621679133038"><span id="P2"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130330"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133038"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130329"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130328"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133038"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-748"></span><span>  </span><span id="local-6989586621679130324"><span id="local-6989586621679130325"><span id="local-6989586621679130326"><span id="local-6989586621679132996"><span id="P3"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130326"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130325"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132996"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679132996"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-749"></span><span>  </span><span id="local-6989586621679130319"><span id="local-6989586621679130320"><span id="local-6989586621679130321"><span id="local-6989586621679130322"><span id="P4"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130322"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130321"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130320"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130319"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-750"></span><span>  </span><span id="local-6989586621679130314"><span id="local-6989586621679130315"><span id="local-6989586621679130316"><span id="local-6989586621679130317"><span id="PPair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130317"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130316"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130315"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130314"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130317"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130316"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130315"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130314"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130315"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130317"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130316"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130315"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130314"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130314"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130315"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-keyword">data</span><span> </span><span id="Expr"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span></span><span> </span><span id="local-6989586621679130312"><span class="annot"><a href="#local-6989586621679130312"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621679130311"><span class="annot"><a href="#local-6989586621679130311"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-753"></span><span>  </span><span id="local-6989586621679130308"><span id="local-6989586621679130309"><span id="local-6989586621679130310"><span id="local-6989586621679133035"><span id="X1"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133035"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130310"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130309"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130308"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133035"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span><span>
</span><span id="line-754"></span><span>  </span><span id="local-6989586621679130304"><span id="local-6989586621679130305"><span id="local-6989586621679130306"><span id="local-6989586621679133028"><span id="X2"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130306"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133028"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130305"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130304"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133028"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-755"></span><span>  </span><span id="local-6989586621679130300"><span id="local-6989586621679130301"><span id="local-6989586621679130302"><span id="local-6989586621679132989"><span id="X3"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130302"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130301"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132989"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130300"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679132989"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-756"></span><span>  </span><span id="local-6989586621679130295"><span id="local-6989586621679130296"><span id="local-6989586621679130297"><span id="local-6989586621679130298"><span id="X4"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#X4"><span class="hs-identifier hs-var">X4</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130298"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130297"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130296"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130295"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-757"></span><span>  </span><span id="local-6989586621679130291"><span id="local-6989586621679130292"><span id="local-6989586621679130293"><span id="local-6989586621679133011"><span id="HasKey"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130293"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130292"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133011"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130292"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130293"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130292"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130291"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133011"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621679132958"><span id="Neg"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132958"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132958"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-759"></span><span>  </span><span id="local-6989586621679130287"><span id="local-6989586621679130288"><span id="local-6989586621679132979"><span id="local-6989586621679132980"><span id="Ap"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130288"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130287"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132980"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132979"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130288"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132979"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130287"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132979"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132980"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-760"></span><span>  </span><span id="local-6989586621679130284"><span id="local-6989586621679130285"><span id="local-6989586621679132973"><span id="EPair"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132973"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130285"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132973"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130284"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132973"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130284"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-761"></span><span>  </span><span id="local-6989586621679130282"><span id="local-6989586621679133108"><span id="local-6989586621679133109"><span id="FST"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-var">FST</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133109"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130282"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133109"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133108"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-762"></span><span>  </span><span id="local-6989586621679130280"><span id="local-6989586621679133110"><span id="local-6989586621679133112"><span id="SND"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-var">SND</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133112"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130280"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133110"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133112"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133110"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-763"></span><span>  </span><span id="local-6989586621679133018"><span id="local-6989586621679133019"><span id="Lit"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679133019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679133019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133018"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133019"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-764"></span><span>
</span><span id="line-765"></span><span class="hs-comment">-- Carefull no pattern P1, P2, P3, P4 should appear MORE THAN ONCE in a Lam.</span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span class="hs-keyword">data</span><span> </span><span id="Lam"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span></span><span> </span><span id="local-6989586621679130277"><span class="annot"><a href="#local-6989586621679130277"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-768"></span><span>  </span><span id="local-6989586621679130270"><span id="local-6989586621679130271"><span id="local-6989586621679130272"><span id="local-6989586621679130273"><span id="local-6989586621679130274"><span id="local-6989586621679130275"><span id="local-6989586621679130276"><span id="Lam"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130276"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130275"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130274"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130273"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130272"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130276"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130275"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130274"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130273"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130271"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130276"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130275"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130274"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130273"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130270"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130272"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130271"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130270"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-769"></span><span>  </span><span id="local-6989586621679130268"><span id="Add"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679130268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130268"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-770"></span><span>  </span><span id="local-6989586621679130266"><span id="Cat"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679130266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130266"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-771"></span><span>  </span><span id="local-6989586621679130264"><span id="Eql"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679130264"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130264"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130264"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-772"></span><span>  </span><span id="Both"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>  </span><span id="local-6989586621679130259"><span id="local-6989586621679130260"><span id="local-6989586621679130261"><span id="Lift"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-var">Lift</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130261"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130260"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130259"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130261"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130260"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130259"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- For use n the tests only!</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">-- ============= Printing in &#120631;-Normal Form =========================</span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="hs-keyword">type</span><span> </span><span id="StringEnv"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-var">StringEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span id="local-6989586621679133117"><span id="local-6989586621679133118"><span id="local-6989586621679133119"><span id="local-6989586621679133120"><span id="local-6989586621679133121"><span id="local-6989586621679133122"><span id="local-6989586621679133123"><span id="local-6989586621679133124"><span id="local-6989586621679133125"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-type">bindE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133125"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133124"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133123"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133122"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133121"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133120"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133119"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133118"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133117"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133121"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-780"></span><span id="bindE"><span class="annot"><span class="annottext">bindE :: Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var hs-var">bindE</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span id="local-6989586621679130255"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130255"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130254"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679130254"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130253"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130253"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130252"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130252"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130251"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130251"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130254"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130255"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130253"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130252"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130251"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span id="local-6989586621679130249"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130249"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130248"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679130248"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679130247"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130247"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130246"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130246"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130245"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130245"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130247"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130248"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130249"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130246"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130245"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span> </span><span id="local-6989586621679130244"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130244"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130243"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679130243"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679130242"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130242"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130241"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130241"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130240"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130240"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130242"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130241"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130243"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130244"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130240"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span><span> </span><span id="local-6989586621679130239"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130239"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130238"><span class="annot"><span class="annottext">e :: StringEnv
</span><a href="#local-6989586621679130238"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679130237"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130237"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130236"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130236"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130235"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130235"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130237"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130236"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130235"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (w, x, y, z) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130238"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130239"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679130234"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130234"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679130233"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130233"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-type">EPair</span></a></span><span> </span><span id="local-6989586621679130232"><span class="annot"><span class="annottext">Expr (w, x, y, z) a
</span><a href="#local-6989586621679130232"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679130231"><span class="annot"><span class="annottext">Expr (w, x, y, z) b
</span><a href="#local-6989586621679130231"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130230"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130230"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a -&gt; Expr (w, x, y, z) a -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130234"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) a
Expr (w, x, y, z) a
</span><a href="#local-6989586621679130232"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) b -&gt; Expr (w, x, y, z) b -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130233"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) b
Expr (w, x, y, z) b
</span><a href="#local-6989586621679130231"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130230"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679130229"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130229"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679130228"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130228"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130227"><span class="annot"><span class="annottext">Expr (w, x, y, z) t
</span><a href="#local-6989586621679130227"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679130226"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130226"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b -&gt; Expr (w, x, y, z) b -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130228"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (w, x, y, z) (d, b) -&gt; Expr (w, x, y, z) b
forall e a b. Expr e (a, b) -&gt; Expr e b
</span><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-var">SND</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
Expr (w, x, y, z) (d, b)
</span><a href="#local-6989586621679130227"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) a -&gt; Expr (w, x, y, z) a -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130229"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (w, x, y, z) (a, c) -&gt; Expr (w, x, y, z) a
forall e a b. Expr e (a, b) -&gt; Expr e a
</span><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-var">FST</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (w, x, y, z) t
Expr (w, x, y, z) (a, c)
</span><a href="#local-6989586621679130227"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130226"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span id="local-6989586621679133132"><span id="local-6989586621679133133"><span id="local-6989586621679133134"><span id="local-6989586621679133135"><span id="local-6989586621679133136"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-type">showE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679133136"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133135"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133134"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679133133"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133132"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span></span></span></span><span>
</span><span id="line-788"></span><span id="showE"><span class="annot"><span class="annottext">showE :: StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var hs-var">showE</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130225"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130225"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-789"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130224"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130224"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130224"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-790"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130223"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130223"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130223"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-791"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130222"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130222"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="Control.Iterate.SetAlgebra.html#X4"><span class="hs-identifier hs-var">X4</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130222"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-792"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130221"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130221"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-type">EPair</span></a></span><span> </span><span id="local-6989586621679130220"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679130220"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130219"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679130219"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) a -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130221"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679130220"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) b -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130221"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679130219"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-793"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130218"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130218"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621679130217"><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679130217"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679130216"><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679130216"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679130215"><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679130215"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130214"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679130214"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130213"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679130213"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (d, c, b, a) v -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) s -&gt; Expr (a, b, c, d) s -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679130216"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
Expr (a, b, c, d) s
</span><a href="#local-6989586621679130213"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (d, c, b, a) t -&gt; Expr (a, b, c, d) t -&gt; StringEnv -&gt; StringEnv
forall a b c d t w x y z.
Pat (a, b, c, d) t -&gt; Expr (w, x, y, z) t -&gt; StringEnv -&gt; StringEnv
</span><a href="Control.Iterate.SetAlgebra.html#bindE"><span class="hs-identifier hs-var">bindE</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679130217"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
Expr (a, b, c, d) t
</span><a href="#local-6989586621679130214"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130218"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679130215"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-794"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130212"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130212"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#FST"><span class="hs-identifier hs-type">FST</span></a></span><span> </span><span id="local-6989586621679130211"><span class="annot"><span class="annottext">Expr (a, b, c, d) (t, b)
</span><a href="#local-6989586621679130211"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(fst &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) (t, b) -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130212"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) (t, b)
</span><a href="#local-6989586621679130211"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-795"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130210"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130210"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SND"><span class="hs-identifier hs-type">SND</span></a></span><span> </span><span id="local-6989586621679130209"><span class="annot"><span class="annottext">Expr (a, b, c, d) (a, t)
</span><a href="#local-6989586621679130209"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(snd &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) (a, t) -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130210"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) (a, t)
</span><a href="#local-6989586621679130209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-796"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130208"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130208"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span id="local-6989586621679130207"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; t)
</span><a href="#local-6989586621679130207"><span class="hs-identifier hs-var">oper</span></a></span></span><span> </span><span id="local-6989586621679130206"><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679130206"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130205"><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679130205"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) a -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) a
</span><a href="#local-6989586621679130206"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Lam (a -&gt; b -&gt; t) -&gt; [Char]
forall t. StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; t)
</span><a href="#local-6989586621679130207"><span class="hs-identifier hs-var">oper</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) b -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) b
</span><a href="#local-6989586621679130205"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-797"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130203"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130203"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-type">HasKey</span></a></span><span> </span><span id="local-6989586621679130202"><span class="annot"><span class="annottext">Expr (a, b, c, d) k
</span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679130201"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130201"><span class="hs-identifier hs-var">_datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(haskey &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) k -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130203"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) k
</span><a href="#local-6989586621679130202"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; ?)&quot;</span></span><span>
</span><span id="line-798"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span id="local-6989586621679130200"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130200"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621679130199"><span class="annot"><span class="annottext">Expr (a, b, c, d) Bool
</span><a href="#local-6989586621679130199"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(not &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) Bool -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130200"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) Bool
</span><a href="#local-6989586621679130199"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-799"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679130198"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679130198"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679130198"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span id="local-6989586621679133085"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-type">showL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133085"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-802"></span><span id="showL"><span class="annot"><span class="annottext">showL :: StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var hs-var">showL</span></a></span></span><span> </span><span id="local-6989586621679130197"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621679130196"><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679130196"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679130195"><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679130195"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679130194"><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679130194"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\\ &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) t -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) t
</span><a href="#local-6989586621679130196"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) s -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) s
</span><a href="#local-6989586621679130195"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (d, c, b, a) v -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130197"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (d, c, b, a) v
</span><a href="#local-6989586621679130194"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-803"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679130192"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130192"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; + &quot;</span></span><span>
</span><span id="line-804"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679130191"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130191"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &lt;&gt; &quot;</span></span><span>
</span><span id="line-805"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679130190"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130190"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; == &quot;</span></span><span>
</span><span id="line-806"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679130189"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130189"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &amp;&amp; &quot;</span></span><span>
</span><span id="line-807"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span id="local-6989586621679130188"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130188"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-type">Lift</span></a></span><span> </span><span id="local-6989586621679130187"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679130187"><span class="hs-identifier hs-var">_f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;lifted function&gt;&quot;</span></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span id="local-6989586621679133072"><span id="local-6989586621679133073"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-type">showP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#StringEnv"><span class="hs-identifier hs-type">StringEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133073"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133072"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-810"></span><span id="showP"><span class="annot"><span class="annottext">showP :: StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var hs-var">showP</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130186"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130186"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130186"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-811"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130185"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130185"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130185"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-812"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130184"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130184"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130184"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-813"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679130183"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130183"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat any t
</span><a href="Control.Iterate.SetAlgebra.html#P4"><span class="hs-identifier hs-var">P4</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679130183"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-814"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span id="local-6989586621679130182"><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130182"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-type">PPair</span></a></span><span> </span><span id="local-6989586621679130181"><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130181"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679130180"><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130180"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) a -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130182"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) a
</span><a href="#local-6989586621679130181"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">StringEnv -&gt; Pat (d, c, b, a) b -&gt; [Char]
forall any t. StringEnv -&gt; Pat any t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showP"><span class="hs-identifier hs-var">showP</span></a></span><span> </span><span class="annot"><span class="annottext">StringEnv
</span><a href="#local-6989586621679130182"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (d, c, b, a) b
</span><a href="#local-6989586621679130180"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span id="local-6989586621679130175"><span id="local-6989586621679130176"><span id="local-6989586621679130177"><span id="local-6989586621679130178"><span id="local-6989586621679130179"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130170"><span id="local-6989586621679130173"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130179"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130178"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130177"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130176"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679130175"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-817"></span><span>   </span><span id="local-6989586621679130169"><span class="annot"><span class="annottext">show :: Expr (a, b, c, d) t -&gt; [Char]
</span><a href="#local-6989586621679130169"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679130168"><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="#local-6989586621679130168"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
forall a b c d t. StringEnv -&gt; Expr (a, b, c, d) t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showE"><span class="hs-identifier hs-var">showE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X1&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X2&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X3&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X4&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (a, b, c, d) t
</span><a href="#local-6989586621679130168"><span class="hs-identifier hs-var">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-818"></span><span id="local-6989586621679130167"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130162"><span id="local-6989586621679130165"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130167"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-819"></span><span>   </span><span id="local-6989586621679130161"><span class="annot"><span class="annottext">show :: Lam t -&gt; [Char]
</span><a href="#local-6989586621679130161"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679130160"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679130160"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringEnv -&gt; Lam t -&gt; [Char]
forall t. StringEnv -&gt; Lam t -&gt; [Char]
</span><a href="Control.Iterate.SetAlgebra.html#showL"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X1&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X2&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X3&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X4&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679130160"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">-- ===============================================================================================================</span><span>
</span><span id="line-822"></span><span class="hs-comment">-- An symbolic function Fun has two parts, a Lam that can be analyzed, and real function that can be applied</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- ===============================================================================================================</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-keyword">data</span><span> </span><span id="Fun"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span></span><span> </span><span id="local-6989586621679133051"><span class="annot"><a href="#local-6989586621679133051"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fun"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679133051"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679133051"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-comment">-- | We can observe a Fun by showing the Lam part.</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span id="local-6989586621679130158"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130153"><span id="local-6989586621679130156"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130158"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-830"></span><span>  </span><span id="local-6989586621679130152"><span class="annot"><span class="annottext">show :: Fun t -&gt; [Char]
</span><a href="#local-6989586621679130152"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130151"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679130151"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679130150"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679130150"><span class="hs-identifier hs-var">_fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam t -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679130151"><span class="hs-identifier hs-var">lam</span></a></span></span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- Operations we use to manipulate Fun. Some simple ones, and some ways to compose them.</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- The great thing is the types completely decide what the operations do.</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span class="hs-comment">-- Used in projectStep, chainStep, andPStep, orStep and guardStep</span><span>
</span><span id="line-839"></span><span id="local-6989586621679131629"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131629"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131629"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-840"></span><span id="apply"><span class="annot"><span class="annottext">apply :: Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130148"><span class="annot"><span class="annottext">Lam t
</span><a href="#local-6989586621679130148"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span id="local-6989586621679130147"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679130147"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679130147"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- Used in compile (UnionOverrideLeft case)</span><span>
</span><span id="line-843"></span><span id="local-6989586621679132735"><span id="local-6989586621679132736"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-type">first</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132736"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132736"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-844"></span><span id="first"><span class="annot"><span class="annottext">first :: Fun (v -&gt; s -&gt; v)
</span><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-var hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (v -&gt; s -&gt; v) -&gt; (v -&gt; s -&gt; v) -&gt; Fun (v -&gt; s -&gt; v)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
-&gt; Pat (v, s, Any, Any) s
-&gt; Expr (v, s, Any, Any) v
-&gt; Lam (v -&gt; s -&gt; v)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) s
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (v, s, Any, Any) v
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130145"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130145"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130144"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130144"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130145"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-comment">-- Used in compile (UnionOverrideRight case)</span><span>
</span><span id="line-847"></span><span id="local-6989586621679132879"><span id="local-6989586621679132880"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-type">second</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132880"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132879"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132879"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-848"></span><span id="second"><span class="annot"><span class="annottext">second :: Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (v -&gt; s -&gt; s) -&gt; (v -&gt; s -&gt; s) -&gt; Fun (v -&gt; s -&gt; s)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
-&gt; Pat (v, s, Any, Any) s
-&gt; Expr (v, s, Any, Any) s
-&gt; Lam (v -&gt; s -&gt; s)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) v
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (v, s, Any, Any) s
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (v, s, Any, Any) s
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130142"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130142"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679130141"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130141"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679130141"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-comment">-- Used in compile (UnionPlus case)</span><span>
</span><span id="line-851"></span><span id="local-6989586621679132727"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-type">plus</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679132727"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132727"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132727"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132727"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-852"></span><span id="plus"><span class="annot"><span class="annottext">plus :: Fun (t -&gt; t -&gt; t)
</span><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-var hs-var">plus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; t) -&gt; (t -&gt; t -&gt; t) -&gt; Fun (t -&gt; t -&gt; t)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; t)
forall m. Monoid m =&gt; Lam (m -&gt; m -&gt; m)
</span><a href="Control.Iterate.SetAlgebra.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span id="local-6989586621679130139"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#eql"><span class="hs-identifier hs-type">eql</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679130139"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130139"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130139"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-855"></span><span id="eql"><span class="annot"><span class="annottext">eql :: Fun (t -&gt; t -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#eql"><span class="hs-identifier hs-var hs-var">eql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; Bool) -&gt; (t -&gt; t -&gt; Bool) -&gt; Fun (t -&gt; t -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t -&gt; t -&gt; Bool)
forall t. Eq t =&gt; Lam (t -&gt; t -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#Eql"><span class="hs-identifier hs-var">Eql</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span id="local-6989586621679132953"><span id="local-6989586621679132954"><span id="local-6989586621679132955"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-type">constant</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679132955"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132955"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132953"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132955"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-858"></span><span id="constant"><span class="annot"><span class="annottext">constant :: c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var hs-var">constant</span></a></span></span><span> </span><span id="local-6989586621679130136"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679130136"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; c) -&gt; (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
-&gt; Pat (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) c
-&gt; Lam (a -&gt; b -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) b
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Expr (a, b, Any, Any) c
forall t env. Show t =&gt; t -&gt; Expr env t
</span><a href="Control.Iterate.SetAlgebra.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679130136"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130135"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130135"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679130134"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130134"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679130136"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- Used in compile (RExclude RRestrict cases)</span><span>
</span><span id="line-861"></span><span id="local-6989586621679132754"><span id="local-6989586621679132755"><span id="local-6989586621679132756"><span id="local-6989586621679132757"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-type">rngElem</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132757"><span class="hs-identifier hs-type">rng</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132756"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132756"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132757"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132755"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132754"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132757"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-862"></span><span id="rngElem"><span class="annot"><span class="annottext">rngElem :: f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var hs-var">rngElem</span></a></span></span><span> </span><span id="local-6989586621679130132"><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679130132"><span class="hs-identifier hs-var">realset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (dom -&gt; rng -&gt; Bool)
-&gt; (dom -&gt; rng -&gt; Bool) -&gt; Fun (dom -&gt; rng -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
-&gt; Pat (dom, rng, Any, Any) rng
-&gt; Expr (dom, rng, Any, Any) Bool
-&gt; Lam (dom -&gt; rng -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) rng
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) rng
-&gt; f rng v -&gt; Expr (dom, rng, Any, Any) Bool
forall (f :: * -&gt; * -&gt; *) k e a.
(Iter f, Ord k) =&gt;
Expr e k -&gt; f k a -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) rng
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679130132"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130131"><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679130131"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679130130"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130130"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">rng -&gt; f rng v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130130"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f rng v
</span><a href="#local-6989586621679130132"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- x is ignored and realset is supplied</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span id="local-6989586621679130126"><span id="local-6989586621679130127"><span id="local-6989586621679130128"><span id="local-6989586621679130129"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domElem"><span class="hs-identifier hs-type">domElem</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130129"><span class="hs-identifier hs-type">dom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130128"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130128"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130129"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130127"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130129"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130126"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-865"></span><span id="domElem"><span class="annot"><span class="annottext">domElem :: f dom v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#domElem"><span class="hs-identifier hs-var hs-var">domElem</span></a></span></span><span> </span><span id="local-6989586621679130124"><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679130124"><span class="hs-identifier hs-var">realset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (dom -&gt; rng -&gt; Bool)
-&gt; (dom -&gt; rng -&gt; Bool) -&gt; Fun (dom -&gt; rng -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
-&gt; Pat (dom, rng, Any, Any) rng
-&gt; Expr (dom, rng, Any, Any) Bool
-&gt; Lam (dom -&gt; rng -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) dom
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (dom, rng, Any, Any) rng
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) dom
-&gt; f dom v -&gt; Expr (dom, rng, Any, Any) Bool
forall (f :: * -&gt; * -&gt; *) k e a.
(Iter f, Ord k) =&gt;
Expr e k -&gt; f k a -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#HasKey"><span class="hs-identifier hs-var">HasKey</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (dom, rng, Any, Any) dom
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679130124"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130123"><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679130123"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130122"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679130122"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dom -&gt; f dom v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">dom
</span><a href="#local-6989586621679130123"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f dom v
</span><a href="#local-6989586621679130124"><span class="hs-identifier hs-var">realset</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- y is ignored and realset is supplied</span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span id="local-6989586621679132751"><span id="local-6989586621679132752"><span id="local-6989586621679132753"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-type">rngFst</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132753"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132752"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132751"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132752"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-868"></span><span id="rngFst"><span class="annot"><span class="annottext">rngFst :: Fun (x -&gt; (a, b) -&gt; a)
</span><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-var hs-var">rngFst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (x -&gt; (a, b) -&gt; a)
-&gt; (x -&gt; (a, b) -&gt; a) -&gt; Fun (x -&gt; (a, b) -&gt; a)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
-&gt; Pat (x, a, b, a) (a, b)
-&gt; Expr (x, a, b, a) a
-&gt; Lam (x -&gt; (a, b) -&gt; a)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) a -&gt; Pat (x, a, b, a) b -&gt; Pat (x, a, b, a) (a, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (x, a, b, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130120"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679130120"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130119"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130119"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130118"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130118"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130119"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span id="local-6989586621679132770"><span id="local-6989586621679132771"><span id="local-6989586621679132772"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-type">rngSnd</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132772"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-871"></span><span id="rngSnd"><span class="annot"><span class="annottext">rngSnd :: Fun (x -&gt; (a, b) -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-var hs-var">rngSnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (x -&gt; (a, b) -&gt; b)
-&gt; (x -&gt; (a, b) -&gt; b) -&gt; Fun (x -&gt; (a, b) -&gt; b)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
-&gt; Pat (x, a, b, a) (a, b)
-&gt; Expr (x, a, b, a) b
-&gt; Lam (x -&gt; (a, b) -&gt; b)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) x
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (x, a, b, a) a -&gt; Pat (x, a, b, a) b -&gt; Pat (x, a, b, a) (a, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (x, a, b, a) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (x, a, b, a) b
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130116"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679130116"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679130115"><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679130115"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679130115"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span id="local-6989586621679132887"><span id="local-6989586621679132888"><span id="local-6989586621679132889"><span id="local-6989586621679132890"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-type">compose1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132890"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132889"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132888"><span class="hs-identifier hs-type">t3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132890"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132887"><span class="hs-identifier hs-type">t4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132889"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132890"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132887"><span class="hs-identifier hs-type">t4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132888"><span class="hs-identifier hs-type">t3</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-874"></span><span id="compose1"><span class="annot"><span class="annottext">compose1 :: Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var hs-var">compose1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130113"><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
</span><a href="#local-6989586621679130113"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679130112"><span class="annot"><span class="annottext">t1 -&gt; t2 -&gt; t3
</span><a href="#local-6989586621679130112"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130111"><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
</span><a href="#local-6989586621679130111"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679130110"><span class="annot"><span class="annottext">t1 -&gt; t4 -&gt; t2
</span><a href="#local-6989586621679130110"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t3) -&gt; (t1 -&gt; t4 -&gt; t3) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t1
-&gt; Pat (t1, t4, Any, Any) t4
-&gt; Expr (t1, t4, Any, Any) t3
-&gt; Lam (t1 -&gt; t4 -&gt; t3)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t1
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (t1, t4, Any, Any) t4
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
-&gt; Expr (t1, t4, Any, Any) t1
-&gt; Expr (t1, t4, Any, Any) t2
-&gt; Expr (t1, t4, Any, Any) t3
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t2 -&gt; t3)
</span><a href="#local-6989586621679130113"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t1
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
-&gt; Expr (t1, t4, Any, Any) t1
-&gt; Expr (t1, t4, Any, Any) t4
-&gt; Expr (t1, t4, Any, Any) t2
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (t1 -&gt; t4 -&gt; t2)
</span><a href="#local-6989586621679130111"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t1
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (t1, t4, Any, Any) t4
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130109"><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679130109"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130108"><span class="annot"><span class="annottext">t4
</span><a href="#local-6989586621679130108"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t1 -&gt; t2 -&gt; t3
</span><a href="#local-6989586621679130112"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679130109"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t1 -&gt; t4 -&gt; t2
</span><a href="#local-6989586621679130110"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679130109"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t4
</span><a href="#local-6989586621679130108"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span id="local-6989586621679132868"><span id="local-6989586621679132869"><span id="local-6989586621679132870"><span id="local-6989586621679132871"><span id="local-6989586621679132872"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-type">compSndL</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132872"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132870"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132869"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132872"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132868"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132872"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132868"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132870"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132869"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-877"></span><span id="compSndL"><span class="annot"><span class="annottext">compSndL :: Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var hs-var">compSndL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130106"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679130106"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130105"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679130105"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130104"><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
</span><a href="#local-6989586621679130104"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679130103"><span class="annot"><span class="annottext">k -&gt; d -&gt; a
</span><a href="#local-6989586621679130103"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (d, b) -&gt; c)
-&gt; (k -&gt; (d, b) -&gt; c) -&gt; Fun (k -&gt; (d, b) -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, d, b, d) k
-&gt; Pat (k, d, b, d) (d, b)
-&gt; Expr (k, d, b, d) c
-&gt; Lam (k -&gt; (d, b) -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, d, b, d) d -&gt; Pat (k, d, b, d) b -&gt; Pat (k, d, b, d) (d, b)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) d
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, d, b, d) b
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
-&gt; Expr (k, d, b, d) k
-&gt; Expr (k, d, b, d) (a, b)
-&gt; Expr (k, d, b, d) c
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679130106"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, d, b, d) a
-&gt; Expr (k, d, b, d) b -&gt; Expr (k, d, b, d) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
-&gt; Expr (k, d, b, d) k
-&gt; Expr (k, d, b, d) d
-&gt; Expr (k, d, b, d) a
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; a)
</span><a href="#local-6989586621679130104"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) d
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr (k, d, b, d) b
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130102"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130102"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130101"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679130101"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130100"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130100"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679130105"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130102"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; d -&gt; a
</span><a href="#local-6989586621679130103"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130102"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679130101"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130100"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span id="local-6989586621679132862"><span id="local-6989586621679132863"><span id="local-6989586621679132864"><span id="local-6989586621679132865"><span id="local-6989586621679132866"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-type">compSndR</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132865"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132864"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132863"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132862"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132864"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132866"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132865"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132862"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132863"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-880"></span><span id="compSndR"><span class="annot"><span class="annottext">compSndR :: Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; b) -&gt; Fun (k -&gt; (a, d) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-var hs-var">compSndR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130098"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679130098"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130097"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679130097"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130096"><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
</span><a href="#local-6989586621679130096"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679130095"><span class="annot"><span class="annottext">k -&gt; d -&gt; b
</span><a href="#local-6989586621679130095"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, d) -&gt; c)
-&gt; (k -&gt; (a, d) -&gt; c) -&gt; Fun (k -&gt; (a, d) -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, d, a) k
-&gt; Pat (k, a, d, a) (a, d)
-&gt; Expr (k, a, d, a) c
-&gt; Lam (k -&gt; (a, d) -&gt; c)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, d, a) a -&gt; Pat (k, a, d, a) d -&gt; Pat (k, a, d, a) (a, d)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, d, a) d
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
-&gt; Expr (k, a, d, a) k
-&gt; Expr (k, a, d, a) (a, b)
-&gt; Expr (k, a, d, a) c
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; c)
</span><a href="#local-6989586621679130098"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, a, d, a) a
-&gt; Expr (k, a, d, a) b -&gt; Expr (k, a, d, a) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
-&gt; Expr (k, a, d, a) k
-&gt; Expr (k, a, d, a) d
-&gt; Expr (k, a, d, a) b
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; d -&gt; b)
</span><a href="#local-6989586621679130096"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, d, a) d
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130094"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130094"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130093"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130093"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130092"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679130092"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; c
</span><a href="#local-6989586621679130097"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130094"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130093"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">k -&gt; d -&gt; b
</span><a href="#local-6989586621679130095"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130094"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679130092"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span id="local-6989586621679132840"><span id="local-6989586621679132841"><span id="local-6989586621679132842"><span id="local-6989586621679132843"><span id="local-6989586621679132844"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-type">compCurryR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132844"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132843"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132842"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132841"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132843"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132840"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132842"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132844"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132843"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132840"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132841"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-883"></span><span id="compCurryR"><span class="annot"><span class="annottext">compCurryR :: Fun (k -&gt; (a, b) -&gt; d)
-&gt; Fun (a -&gt; c -&gt; b) -&gt; Fun (k -&gt; (a, c) -&gt; d)
</span><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-var hs-var">compCurryR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130090"><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
</span><a href="#local-6989586621679130090"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679130089"><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; d
</span><a href="#local-6989586621679130089"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130088"><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
</span><a href="#local-6989586621679130088"><span class="hs-identifier hs-var">eg</span></a></span></span><span> </span><span id="local-6989586621679130087"><span class="annot"><span class="annottext">a -&gt; c -&gt; b
</span><a href="#local-6989586621679130087"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, c) -&gt; d)
-&gt; (k -&gt; (a, c) -&gt; d) -&gt; Fun (k -&gt; (a, c) -&gt; d)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, c, a) k
-&gt; Pat (k, a, c, a) (a, c)
-&gt; Expr (k, a, c, a) d
-&gt; Lam (k -&gt; (a, c) -&gt; d)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, a, c, a) a -&gt; Pat (k, a, c, a) c -&gt; Pat (k, a, c, a) (a, c)
forall d c b a.
Pat (d, c, b, a) a -&gt; Pat (d, c, b, a) b -&gt; Pat (d, c, b, a) (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#PPair"><span class="hs-identifier hs-var">PPair</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) a
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, a, c, a) c
forall d c b a. Pat (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#P3"><span class="hs-identifier hs-var">P3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
-&gt; Expr (k, a, c, a) k
-&gt; Expr (k, a, c, a) (a, b)
-&gt; Expr (k, a, c, a) d
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; (a, b) -&gt; d)
</span><a href="#local-6989586621679130090"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
-&gt; Expr (k, a, c, a) b -&gt; Expr (k, a, c, a) (a, b)
forall e a b. Expr e a -&gt; Expr e b -&gt; Expr e (a, b)
</span><a href="Control.Iterate.SetAlgebra.html#EPair"><span class="hs-identifier hs-var">EPair</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
-&gt; Expr (k, a, c, a) a
-&gt; Expr (k, a, c, a) c
-&gt; Expr (k, a, c, a) b
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; c -&gt; b)
</span><a href="#local-6989586621679130088"><span class="hs-identifier hs-var">eg</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) a
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, a, c, a) c
forall d c b a. Expr (d, c, b, a) b
</span><a href="Control.Iterate.SetAlgebra.html#X3"><span class="hs-identifier hs-var">X3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130086"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130086"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130085"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130085"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130084"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679130084"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; (a, b) -&gt; d
</span><a href="#local-6989586621679130089"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130086"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130085"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a -&gt; c -&gt; b
</span><a href="#local-6989586621679130087"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130085"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679130084"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span id="local-6989586621679132744"><span id="local-6989586621679132745"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-type">nEgate</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132745"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132744"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132745"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132744"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-886"></span><span id="nEgate"><span class="annot"><span class="annottext">nEgate :: Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var hs-var">nEgate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130082"><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679130082"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679130081"><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool
</span><a href="#local-6989586621679130081"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool) -&gt; (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) k
-&gt; Pat (k, v, Any, Any) v
-&gt; Expr (k, v, Any, Any) Bool
-&gt; Lam (k -&gt; v -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) k
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (k, v, Any, Any) v
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) Bool -&gt; Expr (k, v, Any, Any) Bool
forall e. Expr e Bool -&gt; Expr e Bool
</span><a href="Control.Iterate.SetAlgebra.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
-&gt; Expr (k, v, Any, Any) k
-&gt; Expr (k, v, Any, Any) v
-&gt; Expr (k, v, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679130082"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) k
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (k, v, Any, Any) v
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130080"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130080"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130079"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130079"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool
</span><a href="#local-6989586621679130081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130080"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130079"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span id="local-6989586621679130077"><span id="local-6989586621679130078"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#always"><span class="hs-identifier hs-type">always</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130077"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-889"></span><span id="always"><span class="annot"><span class="annottext">always :: Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#always"><span class="hs-identifier hs-var hs-var">always</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Fun (a -&gt; b -&gt; Bool)
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span id="local-6989586621679132834"><span id="local-6989586621679132835"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-type">both</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132834"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132834"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132834"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-892"></span><span id="both"><span class="annot"><span class="annottext">both :: Fun (a -&gt; b -&gt; Bool)
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130074"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679130074"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621679130073"><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679130073"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span id="local-6989586621679130072"><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679130072"><span class="hs-identifier hs-var">ff</span></a></span></span><span> </span><span id="local-6989586621679130071"><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679130071"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool) -&gt; (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
-&gt; Pat (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Lam (a -&gt; b -&gt; Bool)
forall d c b a m a b.
Pat (d, c, b, a) m
-&gt; Pat (d, c, b, a) a -&gt; Expr (d, c, b, a) b -&gt; Lam (m -&gt; a -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) a
forall d c b a. Pat (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#P1"><span class="hs-identifier hs-var">P1</span></a></span><span> </span><span class="annot"><span class="annottext">Pat (a, b, Any, Any) b
forall d c b a. Pat (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#P2"><span class="hs-identifier hs-var">P2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (Bool -&gt; Bool -&gt; Bool)
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Expr (a, b, Any, Any) Bool
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (Bool -&gt; Bool -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#Both"><span class="hs-identifier hs-var">Both</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
-&gt; Expr (a, b, Any, Any) a
-&gt; Expr (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679130074"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) a
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) b
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
-&gt; Expr (a, b, Any, Any) a
-&gt; Expr (a, b, Any, Any) b
-&gt; Expr (a, b, Any, Any) Bool
forall a b c e.
Lam (a -&gt; b -&gt; c) -&gt; Expr e a -&gt; Expr e b -&gt; Expr e c
</span><a href="Control.Iterate.SetAlgebra.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679130072"><span class="hs-identifier hs-var">ff</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) a
forall d c b a. Expr (d, c, b, a) d
</span><a href="Control.Iterate.SetAlgebra.html#X1"><span class="hs-identifier hs-var">X1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr (a, b, Any, Any) b
forall d c b a. Expr (d, c, b, a) c
</span><a href="Control.Iterate.SetAlgebra.html#X2"><span class="hs-identifier hs-var">X2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130070"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130070"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679130069"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130069"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679130073"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130070"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130069"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679130071"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130070"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130069"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span id="local-6989586621679130066"><span id="local-6989586621679130067"><span id="local-6989586621679130068"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lift"><span class="hs-identifier hs-type">lift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130066"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130066"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>  </span><span class="hs-comment">-- This is used in the tests, not good to use it elsewhere.</span><span>
</span><span id="line-895"></span><span id="lift"><span class="annot"><span class="annottext">lift :: (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#lift"><span class="hs-identifier hs-var hs-var">lift</span></a></span></span><span> </span><span id="local-6989586621679130064"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679130064"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lam (a -&gt; b -&gt; c) -&gt; (a -&gt; b -&gt; c) -&gt; Fun (a -&gt; b -&gt; c)
forall t. Lam t -&gt; t -&gt; Fun t
</span><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-var">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; Lam (a -&gt; b -&gt; c)
forall a b c. (a -&gt; b -&gt; c) -&gt; Lam (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#Lift"><span class="hs-identifier hs-var">Lift</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679130064"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679130064"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- ============================================================================================</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- | Given a BaseRep we can materialize a (Collect k v) into the type witnessed by the BaseRep.</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- Recall a (Collect k v) has no intrinsic type (it is just an ABSTRACT sequence of tuples), so</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- the witness describes how to turn them into the chosen datatype. Note that materialize is meant</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- to be applied to a collection built by iterating over a Query. This produces the keys in</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- ascending order, with no duplicate keys. So we do not need to specify how to merge values.</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- =============================================================================================</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span id="local-6989586621679132701"><span id="local-6989586621679132702"><span id="local-6989586621679132703"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-type">materialize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132703"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132702"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132703"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132701"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132703"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132701"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132702"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132703"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132701"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-908"></span><span id="materialize"><span class="annot"><span class="annottext">materialize :: BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var hs-var">materialize</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679130062"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679130061"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130061"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679130060"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130060"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130061"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; [(k, v)] -&gt; ((k, v) -&gt; [(k, v)] -&gt; [(k, v)]) -&gt; [(k, v)]
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679130058"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130058"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; Map k v -&gt; ((k, v) -&gt; Map k v -&gt; Map k v) -&gt; Map k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130058"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130057"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130057"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130056"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130056"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130055"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130055"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130057"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130056"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679130055"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679130053"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130053"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (k, v) -&gt; Set k -&gt; ((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130053"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130052"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130052"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130051"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130051"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130052"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679130051"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679130050"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130050"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; BiMap v k v
-&gt; ((k, v) -&gt; BiMap v k v -&gt; BiMap v k v)
-&gt; BiMap v k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130050"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">BiMap v k v
forall v k. BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapEmpty"><span class="hs-identifier hs-var">biMapEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130049"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130049"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130048"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130048"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130047"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679130047"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; v -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addpair"><span class="hs-identifier hs-var">addpair</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130049"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130048"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679130047"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679130046"><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
-&gt; Single k v -&gt; ((k, v) -&gt; Single k v -&gt; Single k v) -&gt; Single k v
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="annot"><span class="annottext">Collect (k, v)
</span><a href="#local-6989586621679130046"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130045"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130045"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130044"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130044"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130043"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679130043"><span class="hs-identifier hs-var">_ignore</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130045"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130044"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- On the flip side, a witness can be used to specifiy how to build a datatype from</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- a CONCRETE sequence of tuples (a [(k,v)]). This is a way to import a type from from</span><span>
</span><span id="line-917"></span><span class="hs-comment">--  a list. But unlike 'materialize' an arbitray [(k,v)] may have duplicate keys,</span><span>
</span><span id="line-918"></span><span class="hs-comment">--  so when that happens, use 'combine' to merge the associated values.</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span id="local-6989586621679132931"><span id="local-6989586621679132932"><span id="local-6989586621679132933"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-type">addp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132933"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132932"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132933"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132933"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132933"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132931"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-922"></span><span id="addp"><span class="annot"><span class="annottext">addp :: (v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var hs-var">addp</span></a></span></span><span> </span><span id="local-6989586621679130041"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130041"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130040"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130040"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130039"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130039"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679130038"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130038"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130040"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679130039"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679130038"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130041"><span class="hs-identifier hs-var">combine</span></a></span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="hs-comment">-- The combine function comb = (\ earlier later -&gt; later) will let values</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- later in the list override ones earlier in the list, and comb =</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- (\ earlier later -&gt; earlier) will keep the value that appears first in the list</span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span id="local-6989586621679130035"><span id="local-6989586621679130036"><span id="local-6989586621679130037"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130037"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130036"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130037"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130037"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130036"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130037"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130035"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-929"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: BaseRep f k v -&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679130033"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130033"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679130032"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130032"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130033"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130032"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-930"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679130030"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130030"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679130029"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130029"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130030"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130029"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-931"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679130028"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130028"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679130027"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130027"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Sett k v -&gt; Sett k v)
-&gt; Sett k v -&gt; [(k, v)] -&gt; Sett k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; Sett k v -&gt; Sett k v
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var">addp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130028"><span class="hs-identifier hs-var">combine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130027"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-932"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679130026"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130026"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679130025"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130025"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
forall k v.
(Ord k, Ord v) =&gt;
(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#biMapFromList"><span class="hs-identifier hs-var">biMapFromList</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130026"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130025"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-933"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679130024"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130024"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679130023"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130023"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Single k v -&gt; Single k v)
-&gt; Single k v -&gt; [(k, v)] -&gt; Single k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; Single k v -&gt; Single k v
forall k (f :: * -&gt; * -&gt; *) v.
(Ord k, Basic f) =&gt;
(v -&gt; v -&gt; v) -&gt; (k, v) -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addp"><span class="hs-identifier hs-var">addp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679130024"><span class="hs-identifier hs-var">combine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679130023"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="hs-comment">-- =========================================================================================</span><span>
</span><span id="line-936"></span><span class="hs-comment">-- Now we make an iterator that collects triples, on the intersection</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- of the domain of the two Iter types 'f' and 'g'. An answer of (k,b,c) means that</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- (k,b) is in m::f k a, and (k,c) is in n::g k c. All the other possible triples</span><span>
</span><span id="line-939"></span><span class="hs-comment">-- are skipped over.  This is an instance of a thing called a &quot;Generic Join&quot;</span><span>
</span><span id="line-940"></span><span class="hs-comment">-- See https://arxiv.org/pdf/1310.3314.pdf  or  http://personales.dcc.uchile.cl/~pbarcelo/ngo.pdf</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- The number of tuples it touches is proportional to the size of the output (modulo log factors).</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- It's cost is unrelated to the size of its inputs (modulo log factors)</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- This is a very specific version of the AndD compound iterator. It is used in the function 'eval'</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- =========================================================================================</span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span id="local-6989586621679130018"><span id="local-6989586621679130019"><span id="local-6989586621679130020"><span id="local-6989586621679130021"><span id="local-6989586621679130022"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#%2A1D"><span class="hs-operator hs-type">(&#10781;)</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130022"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130020"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679130021"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130022"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130019"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130020"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130022"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130018"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130022"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130019"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679130018"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-947"></span><span id="%2A1D"><span class="annot"><span class="annottext">&#10781; :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#%2A1D"><span class="hs-operator hs-var hs-var">(&#10781;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; g k c -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var">domEq</span></a></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span id="local-6989586621679132919"><span id="local-6989586621679132920"><span id="local-6989586621679132921"><span id="local-6989586621679132922"><span id="local-6989586621679132923"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-type">domEq</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132923"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132922"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132921"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679132922"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132923"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132920"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132921"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132923"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132919"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132923"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132920"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679132919"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-950"></span><span id="domEq"><span class="annot"><span class="annottext">domEq :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var hs-var">domEq</span></a></span></span><span> </span><span id="local-6989586621679130015"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130015"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130014"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679130014"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-951"></span><span>    </span><span id="local-6989586621679130013"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130013"><span class="hs-identifier hs-var">triplem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130015"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-952"></span><span>    </span><span id="local-6989586621679130012"><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679130012"><span class="hs-identifier hs-var">triplen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">g k c -&gt; Collect (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679130014"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-953"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679130011"><span class="annot"><span class="annottext">loop :: (k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679130011"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130010"><span class="annot"><span class="annottext">mt :: (k, b, f k b)
</span><a href="#local-6989586621679130010"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679130009"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130009"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130008"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130008"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130007"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130007"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130006"><span class="annot"><span class="annottext">nt :: (k, b, f k b)
</span><a href="#local-6989586621679130006"><span class="hs-identifier hs-var">nt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679130005"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130005"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130004"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130004"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679130003"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130003"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-954"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130009"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130005"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-955"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, b) -&gt; Collect (k, b, b) -&gt; Collect (k, b, b)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130009"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130008"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679130004"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k b -&gt; f k b -&gt; Collect (k, b, b)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-identifier hs-var">domEq</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130007"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130003"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679130002"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130002"><span class="hs-identifier hs-var">mt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130005"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130007"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679130011"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130002"><span class="hs-identifier hs-var">mt'</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130006"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-957"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679130001"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130001"><span class="hs-identifier hs-var">nt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679130009"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679130003"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679130011"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130010"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130001"><span class="hs-identifier hs-var">nt'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-958"></span><span>    </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, c, g k c) -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord k, Iter f, Iter f) =&gt;
(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679130011"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679130013"><span class="hs-identifier hs-var">triplem</span></a></span><span> </span><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679130012"><span class="hs-identifier hs-var">triplen</span></a></span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span class="hs-comment">-- This is included here for the benchmark tests. It is much slower because it does not use lub.</span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span id="local-6989586621679129996"><span id="local-6989586621679129997"><span id="local-6989586621679129998"><span id="local-6989586621679129999"><span id="local-6989586621679130000"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-type">domEqSlow</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679130000"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129999"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129998"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679129999"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130000"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129997"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129998"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130000"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129996"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130000"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129997"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129996"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-963"></span><span id="domEqSlow"><span class="annot"><span class="annottext">domEqSlow :: f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-var hs-var">domEqSlow</span></a></span></span><span> </span><span id="local-6989586621679129994"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679129994"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679129993"><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679129993"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-964"></span><span>    </span><span id="local-6989586621679129992"><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679129992"><span class="hs-identifier hs-var">triplem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679129994"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-965"></span><span>    </span><span id="local-6989586621679129991"><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679129991"><span class="hs-identifier hs-var">triplen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">g k c -&gt; Collect (k, c, g k c)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">g k c
</span><a href="#local-6989586621679129993"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-966"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679129990"><span class="annot"><span class="annottext">loop :: (a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679129990"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129989"><span class="annot"><span class="annottext">mt :: (a, b, f a b)
</span><a href="#local-6989586621679129989"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129988"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129987"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129987"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129986"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129986"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129985"><span class="annot"><span class="annottext">nt :: (a, b, f a b)
</span><a href="#local-6989586621679129985"><span class="hs-identifier hs-var">nt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129984"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129984"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129983"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129983"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129982"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129982"><span class="hs-identifier hs-var">nextn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-967"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129988"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129984"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-968"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, b) -&gt; Collect (a, b, b) -&gt; Collect (a, b, b)
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129988"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129987"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129983"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; f a b -&gt; Collect (a, b, b)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEqSlow"><span class="hs-identifier hs-var">domEqSlow</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129986"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129982"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129981"><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129981"><span class="hs-identifier hs-var">mt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129986"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679129990"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129981"><span class="hs-identifier hs-var">mt'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129985"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-970"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129980"><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129980"><span class="hs-identifier hs-var">nt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129982"><span class="hs-identifier hs-var">nextn</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, f a b) -&gt; (a, b, f a b) -&gt; Collect (a, b, b)
</span><a href="#local-6989586621679129990"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129989"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, f a b)
</span><a href="#local-6989586621679129980"><span class="hs-identifier hs-var">nt'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-971"></span><span>    </span><span class="annot"><span class="annottext">(k, b, f k b) -&gt; (k, c, g k c) -&gt; Collect (k, b, c)
forall k (f :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) b b.
(Ord k, Iter f, Iter f) =&gt;
(k, b, f k b) -&gt; (k, b, f k b) -&gt; Collect (k, b, b)
</span><a href="#local-6989586621679129990"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(k, b, f k b)
</span><a href="#local-6989586621679129992"><span class="hs-identifier hs-var">triplem</span></a></span><span> </span><span class="annot"><span class="annottext">(k, c, g k c)
</span><a href="#local-6989586621679129991"><span class="hs-identifier hs-var">triplen</span></a></span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-974"></span><span class="hs-comment">-- Query is a single datatype that incorporates a language that describes how to build</span><span>
</span><span id="line-975"></span><span class="hs-comment">-- compound iterators, from other iterators.</span><span>
</span><span id="line-976"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span class="hs-keyword">data</span><span> </span><span id="Query"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-var">Query</span></a></span></span><span> </span><span id="local-6989586621679129979"><span class="annot"><a href="#local-6989586621679129979"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679129978"><span class="annot"><a href="#local-6989586621679129978"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-979"></span><span>   </span><span id="local-6989586621679129977"><span id="local-6989586621679132818"><span id="local-6989586621679132819"><span id="BaseD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129977"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132819"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129977"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132819"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132818"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129977"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132819"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132818"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132819"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132818"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-980"></span><span>   </span><span id="local-6989586621679129973"><span id="local-6989586621679129974"><span id="local-6989586621679129975"><span id="ProjectD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129975"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129975"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129974"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129975"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129974"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129973"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129975"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129973"><span class="hs-identifier hs-type">u</span></a></span></span></span></span><span>
</span><span id="line-981"></span><span>   </span><span id="local-6989586621679129970"><span id="local-6989586621679129971"><span id="local-6989586621679132861"><span id="AndD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129971"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129970"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132861"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129971"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129970"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-982"></span><span>   </span><span id="local-6989586621679129965"><span id="local-6989586621679129966"><span id="local-6989586621679129967"><span id="local-6989586621679129968"><span id="ChainD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129968"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129967"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129968"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129967"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129967"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129966"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129968"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129967"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129966"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129965"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129968"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129965"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-983"></span><span>   </span><span id="local-6989586621679129960"><span id="local-6989586621679129961"><span id="local-6989586621679129962"><span id="local-6989586621679129963"><span id="AndPD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span></span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129963"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129963"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129962"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129963"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129961"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129963"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129962"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129961"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129960"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129963"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129960"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span><span>
</span><span id="line-984"></span><span>   </span><span id="local-6989586621679132737"><span id="local-6989586621679132738"><span id="OrD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132737"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-985"></span><span>   </span><span id="local-6989586621679132836"><span id="local-6989586621679132837"><span id="GuardD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132836"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132836"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132837"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132836"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-986"></span><span>   </span><span id="local-6989586621679129956"><span id="local-6989586621679132764"><span id="local-6989586621679132765"><span id="DiffD"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132764"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129956"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132764"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-989"></span><span class="hs-comment">-- smart constructors for Query. These apply semantic preserving rewrites when applicable</span><span>
</span><span id="line-990"></span><span class="hs-comment">-- ======================================================================================</span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-type">smart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-993"></span><span id="smart"><span class="annot"><span class="annottext">smart :: Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var hs-var">smart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-comment">-- for debugging purposes, this can be set to False, in which case no rewrites occurr.</span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span id="local-6989586621679132891"><span id="local-6989586621679132892"><span id="local-6989586621679132893"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-type">projD</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132893"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132893"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132892"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132893"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132892"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132891"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132893"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132891"><span class="hs-identifier hs-type">u</span></a></span></span></span></span><span>
</span><span id="line-996"></span><span id="projD"><span class="annot"><span class="annottext">projD :: Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var hs-var">projD</span></a></span></span><span> </span><span id="local-6989586621679129952"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129952"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129951"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129951"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129952"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129951"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-997"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129950"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129950"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129949"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679129949"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129948"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129948"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129950"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; Fun (k -&gt; v -&gt; v) -&gt; Fun (k -&gt; v -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129948"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679129949"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679129947"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129947"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129946"><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679129946"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129945"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129945"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129947"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679129946"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; Fun (k -&gt; v -&gt; v) -&gt; Fun (k -&gt; v -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129945"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679129943"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129943"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129942"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129942"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129941"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679129941"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129940"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129940"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; u) -&gt; Query k u
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129943"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129942"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
-&gt; Fun (k -&gt; (v, u) -&gt; v) -&gt; Fun (k -&gt; (v, u) -&gt; u)
forall t1 t2 t3 t4.
Fun (t1 -&gt; t2 -&gt; t3)
-&gt; Fun (t1 -&gt; t4 -&gt; t2) -&gt; Fun (t1 -&gt; t4 -&gt; t3)
</span><a href="Control.Iterate.SetAlgebra.html#compose1"><span class="hs-identifier hs-var">compose1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129940"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679129941"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679129939"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129939"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679129938"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129938"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129939"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129938"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span id="local-6989586621679129935"><span id="local-6989586621679129936"><span id="local-6989586621679129937"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-type">andD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129937"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129937"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129936"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129937"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129935"><span class="hs-identifier hs-type">v2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129937"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129936"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129935"><span class="hs-identifier hs-type">v2</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1003"></span><span id="andD"><span class="annot"><span class="annottext">andD :: Query k v1 -&gt; Query k v2 -&gt; Query k (v1, v2)
</span><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var hs-var">andD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129933"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129933"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129932"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679129932"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129931"><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679129931"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v
-&gt; Query k v2 -&gt; Fun (k -&gt; (v, v2) -&gt; (v1, v2)) -&gt; Query k (v1, v2)
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679129931"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
-&gt; Fun (k -&gt; v -&gt; v1) -&gt; Fun (k -&gt; (v, v2) -&gt; (v1, v2))
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var">compSndL</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679129932"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1004"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span id="local-6989586621679129930"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129930"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129929"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129929"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129928"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v2)
</span><a href="#local-6989586621679129928"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1
-&gt; Query k v -&gt; Fun (k -&gt; (v1, v) -&gt; (v1, v2)) -&gt; Query k (v1, v2)
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129930"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129929"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
-&gt; Fun (k -&gt; v -&gt; v2) -&gt; Fun (k -&gt; (v1, v) -&gt; (v1, v2))
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; b) -&gt; Fun (k -&gt; (a, d) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndR"><span class="hs-identifier hs-var">compSndR</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, v2) -&gt; (v1, v2))
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v2)
</span><a href="#local-6989586621679129928"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span id="local-6989586621679129927"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129927"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129926"><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679129926"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1 -&gt; Query k v2 -&gt; Query k (v1, v2)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129927"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v2
</span><a href="#local-6989586621679129926"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span id="local-6989586621679132881"><span id="local-6989586621679132882"><span id="local-6989586621679132883"><span id="local-6989586621679132884"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-type">andPD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132883"><span class="hs-identifier hs-type">v1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132882"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132883"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679132882"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132881"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132881"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-1008"></span><span id="andPD"><span class="annot"><span class="annottext">andPD :: Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var hs-var">andPD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129925"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129925"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129924"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679129924"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129923"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129923"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129922"><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679129922"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; v) -&gt; Query k v
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129925"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129923"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
-&gt; Fun (k -&gt; v -&gt; v1) -&gt; Fun (k -&gt; (v, u) -&gt; v)
forall k a b c d.
Fun (k -&gt; (a, b) -&gt; c)
-&gt; Fun (k -&gt; d -&gt; a) -&gt; Fun (k -&gt; (d, b) -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#compSndL"><span class="hs-identifier hs-var">compSndL</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679129922"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v1)
</span><a href="#local-6989586621679129924"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span id="local-6989586621679129921"><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129921"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129920"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129920"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129919"><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679129919"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v1
</span><a href="#local-6989586621679129921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129920"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v1, u) -&gt; v)
</span><a href="#local-6989586621679129919"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span id="local-6989586621679132845"><span id="local-6989586621679132846"><span id="local-6989586621679132847"><span id="local-6989586621679132848"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-type">chainD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132848"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132847"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132847"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132847"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132846"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132847"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679132846"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132845"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132845"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-1012"></span><span id="chainD"><span class="annot"><span class="annottext">chainD :: Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var hs-var">chainD</span></a></span></span><span> </span><span id="local-6989586621679129917"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129917"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129916"><span class="annot"><span class="annottext">Query v v
</span><a href="#local-6989586621679129916"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129915"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; w)
</span><a href="#local-6989586621679129915"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129914"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129914"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v v -&gt; Fun (k -&gt; (v, v) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query v v
</span><a href="#local-6989586621679129916"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
-&gt; Fun (v -&gt; v -&gt; w) -&gt; Fun (k -&gt; (v, v) -&gt; u)
forall k a b d c.
Fun (k -&gt; (a, b) -&gt; d)
-&gt; Fun (a -&gt; c -&gt; b) -&gt; Fun (k -&gt; (a, c) -&gt; d)
</span><a href="Control.Iterate.SetAlgebra.html#compCurryR"><span class="hs-identifier hs-var">compCurryR</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129914"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; w)
</span><a href="#local-6989586621679129915"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span id="local-6989586621679129913"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129913"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129912"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129912"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129911"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129911"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129913"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129912"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129911"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span id="local-6989586621679129909"><span id="local-6989586621679129910"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-type">guardD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129910"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129910"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129909"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129910"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129909"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129910"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129909"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-1016"></span><span id="guardD"><span class="annot"><span class="annottext">guardD :: Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-var hs-var">guardD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679129907"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129907"><span class="hs-identifier hs-var">q1</span></a></span></span><span> </span><span id="local-6989586621679129906"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129906"><span class="hs-identifier hs-var">test1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129905"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129905"><span class="hs-identifier hs-var">test2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#smart"><span class="hs-identifier hs-var">smart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129907"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
-&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall a b.
Fun (a -&gt; b -&gt; Bool)
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Fun (a -&gt; b -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#both"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129906"><span class="hs-identifier hs-var">test1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129905"><span class="hs-identifier hs-var">test2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1017"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardD"><span class="hs-identifier hs-var">guardD</span></a></span><span> </span><span id="local-6989586621679129904"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129904"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span id="local-6989586621679129903"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129903"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129904"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129903"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-1018"></span><span>
</span><span id="line-1019"></span><span>
</span><span id="line-1020"></span><span>
</span><span id="line-1021"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-1022"></span><span class="hs-comment">-- | Compile the (Exp (f k v)) to a Query iterator, and a BaseRep that indicates</span><span>
</span><span id="line-1023"></span><span class="hs-comment">--   how to materialize the iterator to the correct type. Recall the iterator</span><span>
</span><span id="line-1024"></span><span class="hs-comment">--   can be used to constuct many things using runCollect, but here we want</span><span>
</span><span id="line-1025"></span><span class="hs-comment">--   to materialize it to the same type as the (Exp (f k v)), i.e. (f k v).</span><span>
</span><span id="line-1026"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span id="local-6989586621679132682"><span id="local-6989586621679132683"><span id="local-6989586621679132684"><span id="local-6989586621679132685"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-type">compileSubterm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132684"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132683"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132682"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132683"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132682"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-1029"></span><span id="compileSubterm"><span class="annot"><span class="annottext">compileSubterm :: Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var hs-var">compileSubterm</span></a></span></span><span> </span><span id="local-6989586621679129901"><span class="annot"><span class="annottext">Exp a
</span><a href="#local-6989586621679129901"><span class="hs-identifier hs-var">_whole</span></a></span></span><span> </span><span id="local-6989586621679129900"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129900"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129900"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span id="local-6989586621679132827"><span id="local-6989586621679132828"><span id="local-6989586621679132829"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132829"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132828"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132828"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132829"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132828"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1032"></span><span id="compile"><span class="annot"><span class="annottext">compile :: Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129898"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129898"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129897"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129897"><span class="hs-identifier hs-var">relation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep f k v -&gt; f k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129898"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129897"><span class="hs-identifier hs-var">relation</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129898"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129896"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129896"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679129895"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129895"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129896"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129895"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129894"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129894"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Single k () -&gt; Single k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k ()
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129894"><span class="hs-identifier hs-var">d</span></a></span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129893"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129893"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Sett k ()
</span><a href="#local-6989586621679129893"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129892"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129892"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129891"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129891"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129892"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129890"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129890"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129890"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span id="local-6989586621679129889"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129889"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; ()) -&gt; Query k ()
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129889"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Fun (k -&gt; v -&gt; ())
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129888"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129888"><span class="hs-identifier hs-var">_rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett () () -&gt; Sett () () -&gt; Query () ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett () ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129887"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129887"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129886"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129886"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Sett v () -&gt; Query v ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129886"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129885"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129885"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett () () -&gt; Sett () () -&gt; Query () ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett () ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span id="local-6989586621679129884"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129884"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Sett v () -&gt; Query v ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Sett v ()
forall v k. Ord v =&gt; Query k v -&gt; Sett v ()
</span><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-var">rngStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129884"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- We really ought to memoize this. It might be computed many times.</span><span>
</span><span id="line-1043"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679129882"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129882"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679129881"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129881"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k ((), v) -&gt; Fun (k -&gt; ((), v) -&gt; v) -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projD"><span class="hs-identifier hs-var">projD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k () -&gt; Query k v -&gt; Query k ((), v)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#andD"><span class="hs-identifier hs-var">andD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k (), BaseRep g k ()) -&gt; Query k ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; (Query k (), BaseRep g k ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129882"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129880"><span class="hs-identifier hs-var">reld</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; ((), v) -&gt; v)
forall x a b. Fun (x -&gt; (a, b) -&gt; b)
</span><a href="Control.Iterate.SetAlgebra.html#rngSnd"><span class="hs-identifier hs-var">rngSnd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129879"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129880"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129880"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129879"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129879"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129881"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1045"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679129878"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129878"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679129877"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129877"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k () -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129876"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k (), BaseRep g k ()) -&gt; Query k ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; (Query k (), BaseRep g k ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129878"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129875"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>       </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129876"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129876"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129875"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129875"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129877"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1047"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span id="local-6989586621679129874"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129874"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679129873"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129873"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1048"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129874"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129873"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1049"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129872"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129872"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129871"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129871"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f v ()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129870"><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679129870"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129872"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679129870"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129871"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129869"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129869"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129868"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129868"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679129867"><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679129867"><span class="hs-identifier hs-var">setd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query v () -&gt; Fun (k -&gt; (v, ()) -&gt; v) -&gt; Query k v
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainD"><span class="hs-identifier hs-var">chainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129869"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679129867"><span class="hs-identifier hs-var">setd</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, ()) -&gt; v)
forall x a b. Fun (x -&gt; (a, b) -&gt; a)
</span><a href="Control.Iterate.SetAlgebra.html#rngFst"><span class="hs-identifier hs-var">rngFst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129868"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1051"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span id="local-6989586621679129866"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129866"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679129865"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129865"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1052"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129866"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129865"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1053"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129864"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129864"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129863"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129863"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f v ()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129862"><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679129862"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129864"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall k v. Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var">nEgate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="annot"><span class="annottext">f v ()
</span><a href="#local-6989586621679129862"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129863"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1054"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679129861"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129861"><span class="hs-identifier hs-var">reld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129860"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129860"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Query v (), BaseRep g v ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129861"><span class="hs-identifier hs-var">reld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
forall k v. Fun (k -&gt; v -&gt; Bool) -&gt; Fun (k -&gt; v -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#nEgate"><span class="hs-identifier hs-var">nEgate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g v () -&gt; Fun (k -&gt; v -&gt; Bool)
forall rng (f :: * -&gt; * -&gt; *) v dom.
(Ord rng, Iter f) =&gt;
f rng v -&gt; Fun (dom -&gt; rng -&gt; Bool)
</span><a href="Control.Iterate.SetAlgebra.html#rngElem"><span class="hs-identifier hs-var">rngElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; g v ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129865"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129860"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- This could be expensive</span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span id="local-6989586621679129858"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129858"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679129857"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129857"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129856"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep g k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k v) -&gt; (Query k v, BaseRep g k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129857"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; v)
</span><a href="Control.Iterate.SetAlgebra.html#first"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129855"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- first uses value from rel1 to override value from rel2</span><span>
</span><span id="line-1057"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129856"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129856"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129855"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129855"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129858"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1058"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span id="local-6989586621679129854"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129854"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679129853"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129853"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129852"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep g k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k v) -&gt; (Query k v, BaseRep g k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129853"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
forall v s. Fun (v -&gt; s -&gt; s)
</span><a href="Control.Iterate.SetAlgebra.html#second"><span class="hs-identifier hs-var">second</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k v
</span><a href="#local-6989586621679129851"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- second uses value from rel2 to override value from rel1</span><span>
</span><span id="line-1059"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129852"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129852"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129851"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129851"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129854"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1060"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span id="local-6989586621679129850"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129850"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679129849"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129849"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k n -&gt; Query k n -&gt; Fun (n -&gt; n -&gt; n) -&gt; Query k n
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k n
</span><a href="#local-6989586621679129848"><span class="hs-identifier hs-var">rel1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k n, BaseRep f k n) -&gt; Query k n
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k n) -&gt; (Query k n, BaseRep f k n)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129849"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (n -&gt; n -&gt; n)
forall t. Monoid t =&gt; Fun (t -&gt; t -&gt; t)
</span><a href="Control.Iterate.SetAlgebra.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
BaseRep f k n
</span><a href="#local-6989586621679129847"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129848"><span class="annot"><span class="annottext">Query k n
</span><a href="#local-6989586621679129848"><span class="hs-identifier hs-var">rel1d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129847"><span class="annot"><span class="annottext">BaseRep f k n
</span><a href="#local-6989586621679129847"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; (Query k n, BaseRep f k n)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129850"><span class="hs-identifier hs-var">rel1</span></a></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span id="local-6989586621679129846"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129846"><span class="hs-identifier hs-var">rel1</span></a></span></span><span> </span><span id="local-6989586621679129845"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129845"><span class="hs-identifier hs-var">rel2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; ()) -&gt; Query k ()
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#andPD"><span class="hs-identifier hs-var">andPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; Query k v
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129846"><span class="hs-identifier hs-var">rel1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Query k u, BaseRep g k u) -&gt; Query k u
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k u) -&gt; (Query k u, BaseRep g k u)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129845"><span class="hs-identifier hs-var">rel2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Fun (k -&gt; (v, u) -&gt; ())
forall c a b. Show c =&gt; c -&gt; Fun (a -&gt; b -&gt; c)
</span><a href="Control.Iterate.SetAlgebra.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- run materializes compiled code, only if it is not already data</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-type">testing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1069"></span><span id="testing"><span class="annot"><span class="annottext">testing :: Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var hs-var">testing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span id="local-6989586621679132533"><span id="local-6989586621679132534"><span id="local-6989586621679132535"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-type">runSetExp</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132535"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679132534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132535"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132533"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132535"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132533"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1072"></span><span id="runSetExp"><span class="annot"><span class="annottext">runSetExp :: Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var hs-var">runSetExp</span></a></span></span><span> </span><span id="local-6989586621679129842"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129842"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1073"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var">testing</span></a></span><span>
</span><span id="line-1074"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f k v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In Testing mode, SetAlgebra expression: &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129842"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; falls through to slow mode.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1075"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; f k v
forall k v (f :: * -&gt; * -&gt; *).
Ord k =&gt;
(Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129842"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- Only for use in the SetAlgebra internal tests</span><span>
</span><span id="line-1078"></span><span id="local-6989586621679129838"><span id="local-6989586621679129839"><span id="local-6989586621679129840"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runSet"><span class="hs-identifier hs-type">runSet</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129839"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129838"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129839"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129840"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129838"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1079"></span><span id="runSet"><span class="annot"><span class="annottext">runSet :: Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSet"><span class="hs-identifier hs-var hs-var">runSet</span></a></span></span><span> </span><span id="local-6989586621679129836"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129836"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query k v, BaseRep f k v) -&gt; f k v
forall k v (f :: * -&gt; * -&gt; *).
Ord k =&gt;
(Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (f k v) -&gt; (Query k v, BaseRep f k v)
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129836"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>
</span><span id="line-1081"></span><span id="local-6989586621679132716"><span id="local-6989586621679132717"><span id="local-6989586621679132718"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132718"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132718"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132717"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132716"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132718"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132717"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132716"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132718"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132717"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1082"></span><span id="run"><span class="annot"><span class="annottext">run :: (Query k v, BaseRep f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129835"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129835"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129835"><span class="hs-identifier hs-var">x</span></a></span><span>               </span><span class="hs-comment">-- If it is already data (BaseD)</span><span>
</span><span id="line-1083"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129834"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129834"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129834"><span class="hs-identifier hs-var">x</span></a></span><span>               </span><span class="hs-comment">-- and in the right form (the BaseRep's match)</span><span>
</span><span id="line-1084"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span id="local-6989586621679129833"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129833"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129833"><span class="hs-identifier hs-var">x</span></a></span><span>         </span><span class="hs-comment">-- just return the data</span><span>
</span><span id="line-1085"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129832"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129832"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129832"><span class="hs-identifier hs-var">x</span></a></span><span>           </span><span class="hs-comment">-- only need to materialize data</span><span>
</span><span id="line-1086"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679129831"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129831"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129831"><span class="hs-identifier hs-var">x</span></a></span><span>             </span><span class="hs-comment">-- if the forms do not match.</span><span>
</span><span id="line-1087"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679129830"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129830"><span class="hs-identifier hs-var">_source</span></a></span></span><span> </span><span id="local-6989586621679129829"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129829"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; Collect (k, v) -&gt; List k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129829"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- use fifo, since the order matters for Lists.</span><span>
</span><span id="line-1088"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679129828"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129828"><span class="hs-identifier hs-var">_source</span></a></span></span><span> </span><span id="local-6989586621679129827"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129827"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129826"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129826"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129826"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129827"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- use lifo, for others</span><span>
</span><span id="line-1089"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129825"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129825"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; Collect (k, v) -&gt; List k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#fifo"><span class="hs-identifier hs-var">fifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129825"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- If it is a compund Iterator, for List, than materialize it using fifo</span><span>
</span><span id="line-1090"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129824"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129824"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129823"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129823"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129823"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129824"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- If it is a compund Iterator, for anything else than materialize it using lifo</span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-type">runBoolExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1093"></span><span id="runBoolExp"><span class="annot"><span class="annottext">runBoolExp :: Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var hs-var">runBoolExp</span></a></span></span><span> </span><span id="local-6989586621679129821"><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129821"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1094"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Control.Iterate.SetAlgebra.html#testing"><span class="hs-identifier hs-var">testing</span></a></span><span>
</span><span id="line-1095"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In Testing mode, SetAlgebra expression: &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp Bool -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129821"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; falls through to slow mode.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129821"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- Only for use inthe SetAlgebra internal tests</span><span>
</span><span id="line-1099"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-type">runBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1100"></span><span id="runBool"><span class="annot"><span class="annottext">runBool :: Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var hs-var">runBool</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129819"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129819"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129818"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129818"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; g k () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129819"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129818"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129817"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129817"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129816"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129816"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; g k () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129817"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129816"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129815"><span class="annot"><span class="annottext">w :: Exp Bool
</span><a href="#local-6989586621679129815"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span id="local-6989586621679129814"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129814"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129813"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129813"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Bool
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#sameDomain"><span class="hs-identifier hs-var">sameDomain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (f k v) -&gt; Query k v
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129815"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129814"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (g k u) -&gt; Query k u
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129815"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129813"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#runBool"><span class="hs-identifier hs-var">runBool</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129812"><span class="annot"><span class="annottext">w :: Exp Bool
</span><a href="#local-6989586621679129812"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span id="local-6989586621679129811"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129811"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129810"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129810"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v) -&gt; Bool -&gt; ((k, v) -&gt; Bool -&gt; Bool) -&gt; Bool
forall tuple.
Collect tuple -&gt; forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans
</span><a href="Control.Iterate.Collect.html#runCollect"><span class="hs-identifier hs-var hs-var">runCollect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129809"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129808"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129808"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129807"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129807"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129806"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129806"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Query k u -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129808"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129805"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129806"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129809"><span class="annot"><span class="annottext">left :: Query k v
</span><a href="#local-6989586621679129809"><span class="hs-identifier hs-var hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (f k v) -&gt; Query k v
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129812"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129811"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1105"></span><span>          </span><span id="local-6989586621679129805"><span class="annot"><span class="annottext">right :: Query k u
</span><a href="#local-6989586621679129805"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Exp (g k u) -&gt; Query k u
forall a (f :: * -&gt; * -&gt; *) k v. Exp a -&gt; Exp (f k v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#compileSubterm"><span class="hs-identifier hs-var">compileSubterm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp Bool
</span><a href="#local-6989586621679129812"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129810"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- Evaluate an (Exp t) into real data of type t. Try domain and type specific algorithms first,</span><span>
</span><span id="line-1110"></span><span class="hs-comment">-- and if those fail. Compile the formula as an iterator, then run the iterator to get an answer.</span><span>
</span><span id="line-1111"></span><span class="hs-comment">-- Here are some sample of the type specific algorithms we incorporate</span><span>
</span><span id="line-1112"></span><span class="hs-comment">--  x  &#8712; (dom y)            haskey</span><span>
</span><span id="line-1113"></span><span class="hs-comment">--  x  &#8713; (dom y)            not . haskey</span><span>
</span><span id="line-1114"></span><span class="hs-comment">-- x &#8746; (singleton y)        addpair</span><span>
</span><span id="line-1115"></span><span class="hs-comment">-- (Set.singleton x) &#8938; y    removekey</span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- x &#8939; (Set.singleton y)    easy on Bimap  remove val</span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- (dom x) &#8838; (dom y)</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span id="local-6989586621679132743"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-type">compute</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132743"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679132743"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-1122"></span><span id="compute"><span class="annot"><span class="annottext">compute :: Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var hs-var">compute</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129804"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129804"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129803"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129803"><span class="hs-identifier hs-var">relation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679129803"><span class="hs-identifier hs-var">relation</span></a></span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129802"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129802"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679129802"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1125"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129801"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129801"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129801"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129800"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129800"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129799"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129799"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129800"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129798"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129798"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129798"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129797"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129797"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129796"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129796"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Set k
forall (f :: * -&gt; * -&gt; *) k v. (Basic f, Ord k) =&gt; f k v -&gt; Set k
</span><a href="Control.Iterate.SetAlgebra.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129796"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1129"></span><span>  </span><span class="hs-comment">-- (dom (Map(62)? &#9655; (setSingleton _ )))</span><span>
</span><span id="line-1130"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129795"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129795"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129794"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129794"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129792"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129795"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129792"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129792"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129791"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129791"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679129790"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129790"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129789"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129789"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129789"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129794"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129790"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129791"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129791"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1132"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129788"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129788"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129787"><span class="annot"><a href="#local-6989586621679129787"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129786"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129788"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129786"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129786"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129785"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129785"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679129784"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129784"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129783"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129783"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129783"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129787"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129784"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129785"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129785"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1134"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129782"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129782"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129781"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129781"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129780"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129782"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129780"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129780"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129779"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129779"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679129778"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129778"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129777"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129777"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129777"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129781"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129778"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129779"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129779"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1136"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129776"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129776"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129775"><span class="annot"><a href="#local-6989586621679129775"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Set k -&gt; k -&gt; k -&gt; Set k) -&gt; Set k -&gt; Map k k -&gt; Set k
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129774"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129776"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129774"><span class="annot"><span class="annottext">accum :: Set k -&gt; k -&gt; k -&gt; Set k
</span><a href="#local-6989586621679129774"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129773"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129773"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679129772"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129772"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129771"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129771"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129771"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129775"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129772"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129773"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129773"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1138"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129770"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129770"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129769"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129769"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129768"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129769"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129770"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129768"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129768"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129767"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129767"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129766"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679129766"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679129765"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129765"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129767"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129765"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1140"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129764"><span class="annot"><a href="#local-6989586621679129764"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129763"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129763"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#intersectMapSetFold"><span class="hs-identifier hs-var">intersectMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129762"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129763"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129764"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129762"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129762"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129761"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129761"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129760"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679129760"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679129759"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129759"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129761"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129759"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1142"></span><span>
</span><span id="line-1143"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129758"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129758"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129757"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129757"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129756"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129757"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129758"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129756"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129756"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129755"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129755"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129754"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679129754"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679129753"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129753"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129755"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129753"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1145"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129752"><span class="annot"><a href="#local-6989586621679129752"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129751"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129751"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set k -&gt; Set k) -&gt; Map k v -&gt; Set k -&gt; Set k -&gt; Set k
forall k v ans.
Ord k =&gt;
(k -&gt; v -&gt; ans -&gt; ans) -&gt; Map k v -&gt; Set k -&gt; ans -&gt; ans
</span><a href="Control.Iterate.SetAlgebra.html#disjointMapSetFold"><span class="hs-identifier hs-var">disjointMapSetFold</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Set k -&gt; Set k
forall a p. Ord a =&gt; a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129750"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129751"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129752"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129750"><span class="annot"><span class="annottext">accum :: a -&gt; p -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621679129750"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129749"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129749"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129748"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679129748"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679129747"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129747"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129749"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679129747"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1147"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129746"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129746"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett k ())
</span><a href="#local-6989586621679129746"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1148"></span><span>
</span><span id="line-1149"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129745"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129745"><span class="hs-identifier hs-var">_rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129744"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129744"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129743"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129743"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129743"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1151"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129742"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129742"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set () -&gt; Sett () ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129741"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129741"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129740"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129740"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Sett v ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Set v
forall (f :: * -&gt; * -&gt; *) v k. (Basic f, Ord v) =&gt; f k v -&gt; Set v
</span><a href="Control.Iterate.SetAlgebra.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129740"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129739"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129739"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett v ()) -&gt; Sett v ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett v ())
</span><a href="#local-6989586621679129739"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1154"></span><span>
</span><span id="line-1155"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129738"><span class="annot"><a href="#local-6989586621679129738"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129737"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129737"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129737"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129738"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129735"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129735"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129734"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129734"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129734"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129735"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129733"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129733"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129732"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129732"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129731"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129731"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129731"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129733"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1158"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129730"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129730"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129729"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129729"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.intersection</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129729"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129730"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1159"></span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- This case inspired by set expression in EpochBoundary.hs</span><span>
</span><span id="line-1161"></span><span>   </span><span class="hs-comment">-- (dom (delegs &#9655; Set.singleton hk) &#9665; stake) in EpochBoundart.hs</span><span>
</span><span id="line-1162"></span><span>   </span><span class="hs-comment">-- ((dom (Map(62)? &#9655; (setSingleton _ ))) &#9665; Map(63)?) which has this structure</span><span>
</span><span id="line-1163"></span><span>   </span><span class="hs-comment">-- materialize MapR (do { (x,y,z) &lt;- delegs `domEq` stake; when (y==hk); one(x,z) })</span><span>
</span><span id="line-1164"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129727"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129727"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129726"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129726"><span class="hs-identifier hs-var">hk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129725"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129725"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1165"></span><span>   </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k v
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129724"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129724"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129723"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129723"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129723"><span class="hs-identifier hs-var">v2</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129726"><span class="hs-identifier hs-var">hk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129725"><span class="hs-identifier hs-var">stake</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129727"><span class="hs-identifier hs-var">delegs</span></a></span><span>
</span><span id="line-1166"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129722"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129722"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129721"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129721"><span class="hs-identifier hs-var">rngf</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129720"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129720"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1167"></span><span>   </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k v
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v1
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomPLeft"><span class="hs-identifier hs-var">intersectDomPLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129719"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129719"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129718"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129718"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129718"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129721"><span class="hs-identifier hs-var">rngf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129720"><span class="hs-identifier hs-var">stake</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129722"><span class="hs-identifier hs-var">delegs</span></a></span><span>
</span><span id="line-1168"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679129717"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129717"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129716"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129716"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129716"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129715"><span class="hs-identifier hs-var">set2</span></a></span><span> </span><span class="hs-comment">-- Pay the cost of materializing set to use O(n* log n) restictKeys</span><span>
</span><span id="line-1169"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129715"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129715"><span class="hs-identifier hs-var">set2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Collect (k, ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g k () -&gt; Collect (k, ())
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; g k ()
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129717"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129714"><span class="annot"><a href="#local-6989586621679129714"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129713"><span class="annot"><a href="#local-6989586621679129713"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129714"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129713"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span id="local-6989586621679129711"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129711"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129710"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129710"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129709"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129709"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129710"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129708"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129708"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129707"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129707"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129711"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129709"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129708"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129707"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1173"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129706"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129706"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129705"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129705"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129704"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129704"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129705"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129703"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129703"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129702"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129702"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129706"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129704"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129703"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129702"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1174"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129701"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129701"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129700"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129700"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129699"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129699"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129700"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129698"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129698"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129697"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129697"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129701"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k () -&gt; f k v -&gt; Collect (k, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129699"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129698"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129697"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1175"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129696"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129696"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129695"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129695"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129694"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129694"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129695"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129693"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129693"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129692"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129692"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129696"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single k () -&gt; f k v -&gt; Collect (k, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129694"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129693"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129692"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1176"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129691"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129691"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129690"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129690"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129689"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129689"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129690"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129688"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129688"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129687"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129687"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Single v ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129691"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Single v () -&gt; f v v -&gt; Collect (v, (), v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679129689"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(v, v) -&gt; Collect (v, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129688"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129687"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1177"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129686"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129686"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129686"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1178"></span><span>
</span><span id="line-1179"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129685"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129685"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129684"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129684"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129684"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129685"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129682"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129682"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679129681"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129681"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129680"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129680"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129680"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129682"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1181"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129679"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129679"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span id="local-6989586621679129678"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129678"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129677"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129677"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129677"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129678"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1182"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129676"><span class="annot"><a href="#local-6989586621679129676"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129675"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129675"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129675"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129676"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129674"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129674"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129673"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129673"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="Control.Iterate.SetAlgebra.html#noKeys"><span class="hs-identifier hs-var">noKeys</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129673"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129674"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-1184"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129672"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129672"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129671"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129671"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129672"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129671"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1185"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129670"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129670"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129669"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129669"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129670"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129669"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1186"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129668"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129668"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129667"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129667"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; f v v -&gt; f v v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
k -&gt; f k v -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129668"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679129667"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129666"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129666"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129666"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129665"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129665"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129664"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129664"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; BiMap k k k -&gt; BiMap k k k
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129664"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap k k k
</span><a href="#local-6989586621679129665"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1190"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129663"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129663"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129662"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129662"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129661"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129661"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; BiMap k k k -&gt; BiMap k k k
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129662"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap k k k
</span><a href="#local-6989586621679129663"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1191"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span id="local-6989586621679129660"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129660"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129659"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129659"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129658"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129658"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; BiMap v k v -&gt; BiMap v k v
forall k v. (Ord k, Ord v) =&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Control.Iterate.SetAlgebra.html#removeval"><span class="hs-identifier hs-var">removeval</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129658"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
BiMap v k v
</span><a href="#local-6989586621679129660"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1192"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129657"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129657"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129656"><span class="annot"><a href="#local-6989586621679129656"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129654"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129654"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129654"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129656"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129657"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1193"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129653"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129653"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129652"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129652"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (k -&gt; Bool) -&gt; k -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129652"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129653"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1194"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129650"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129650"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129649"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129649"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129648"><span class="annot"><a href="#local-6989586621679129648"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129648"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679129649"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1195"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129647"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129647"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129646"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129646"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="Control.Iterate.SetAlgebra.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
f k v
</span><a href="#local-6989586621679129646"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1196"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129645"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129645"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129644"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129644"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129643"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129643"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1197"></span><span>   </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129645"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129642"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129642"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129641"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129641"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v)
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Collect (k, v)
</span><a href="Control.Iterate.SetAlgebra.html#lifo"><span class="hs-identifier hs-var">lifo</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129644"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Query v () -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129641"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Query v ()
Query v ()
</span><a href="#local-6989586621679129640"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129642"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129641"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129640"><span class="annot"><span class="annottext">Query v ()
</span><a href="#local-6989586621679129640"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep g v ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; (Query v (), BaseRep g v ())
forall (f :: * -&gt; * -&gt; *) k v.
Exp (f k v) -&gt; (Query k v, BaseRep f k v)
</span><a href="Control.Iterate.SetAlgebra.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129643"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1198"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129639"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129639"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129639"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- (dom (Map(16)? &#9655; (setSingleton _ )))</span><span>
</span><span id="line-1201"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129638"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129638"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129637"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129637"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k k -&gt; Map k k
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129636"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129636"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129636"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129637"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129638"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- ((dom rewards' &#9665; delegs) &#9655; dom poolParams)  in LedgerState.hs</span><span>
</span><span id="line-1203"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129635"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129635"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129634"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129634"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129633"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129633"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; Map k v -&gt; Map k k -&gt; Map k k
forall k v2 v1.
Ord k =&gt;
(k -&gt; v2 -&gt; Bool) -&gt; Map k v1 -&gt; Map k v2 -&gt; Map k v2
</span><a href="Control.Iterate.SetAlgebra.html#intersectDomP"><span class="hs-identifier hs-var">intersectDomP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129632"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129632"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679129631"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129631"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129631"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129633"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129635"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k k
</span><a href="#local-6989586621679129634"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1204"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129629"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129629"><span class="hs-identifier hs-var">_r1</span></a></span></span><span> </span><span id="local-6989586621679129628"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129628"><span class="hs-identifier hs-var">stkcreds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129627"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129627"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621679129626"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129626"><span class="hs-identifier hs-var">delegs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129625"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129625"><span class="hs-identifier hs-var">_r3</span></a></span></span><span> </span><span id="local-6989586621679129624"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129624"><span class="hs-identifier hs-var">stpools</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1205"></span><span>   </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129627"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">(Collect (k, v) -&gt; f k v) -&gt; Collect (k, v) -&gt; f k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129623"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129623"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679129622"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129622"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129628"><span class="hs-identifier hs-var">stkcreds</span></a></span><span> </span><span class="annot"><span class="annottext">f k v -&gt; f k v -&gt; Collect (k, v, v)
forall k (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) b c.
(Ord k, Iter f, Iter g) =&gt;
f k b -&gt; g k c -&gt; Collect (k, b, c)
</span><a href="Control.Iterate.SetAlgebra.html#domEq"><span class="hs-operator hs-var">`domEq`</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129626"><span class="hs-identifier hs-var">delegs</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129622"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; f v v -&gt; Collect ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
k -&gt; f k v -&gt; Collect ()
</span><a href="Control.Iterate.SetAlgebra.html#element"><span class="hs-operator hs-var">`element`</span></a></span><span> </span><span class="annot"><span class="annottext">f v v
f k v
</span><a href="#local-6989586621679129624"><span class="hs-identifier hs-var">stpools</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Collect (k, v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129623"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129622"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1206"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129621"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129621"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129621"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1207"></span><span>
</span><span id="line-1208"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129620"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129620"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129619"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129619"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129618"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129618"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129620"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129618"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1209"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129617"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129617"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129616"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129616"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129615"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129615"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129617"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129615"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1210"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129614"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129614"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129613"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129613"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679129612"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129612"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129614"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679129613"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1211"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129611"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129611"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129610"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129610"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129611"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
v
</span><a href="#local-6989586621679129610"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1212"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129609"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129609"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129608"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129608"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129609"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679129608"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1213"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129607"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129607"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129606"><span class="annot"><a href="#local-6989586621679129606"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129605"><span class="annot"><a href="#local-6989586621679129605"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129607"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129607"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129605"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1214"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129603"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129603"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129602"><span class="annot"><a href="#local-6989586621679129602"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129601"><span class="annot"><a href="#local-6989586621679129601"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129603"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129602"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129603"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129601"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129600"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129600"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129599"><span class="annot"><a href="#local-6989586621679129599"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129598"><span class="annot"><a href="#local-6989586621679129598"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129600"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129600"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129598"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129597"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129597"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129596"><span class="annot"><a href="#local-6989586621679129596"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129595"><span class="annot"><a href="#local-6989586621679129595"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129597"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129597"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129595"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1217"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129594"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129594"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679129593"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129593"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679129592"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129592"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129594"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
Exp (g k ())
</span><a href="#local-6989586621679129593"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (f k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129594"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k ())
Exp (f k v)
</span><a href="#local-6989586621679129592"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129591"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129591"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679129590"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129590"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679129589"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129589"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (g k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129591"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
Exp (g k ())
</span><a href="#local-6989586621679129590"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Exp (f k ()) -&gt; Exp Bool
forall k (g :: * -&gt; * -&gt; *).
(Ord k, Iter g, Show k) =&gt;
k -&gt; Exp (g k ()) -&gt; Exp Bool
</span><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129591"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k ())
Exp (f k v)
</span><a href="#local-6989586621679129589"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1219"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129588"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129588"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679129588"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129587"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129587"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129586"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129586"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129585"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129585"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129587"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129585"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1222"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129584"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129584"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129583"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129583"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129582"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129582"><span class="hs-identifier hs-var">rel</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129584"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129582"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-1223"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129581"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129581"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129580"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129580"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679129579"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129579"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129581"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679129580"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1224"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129578"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129578"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679129577"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129577"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129578"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
v
</span><a href="#local-6989586621679129577"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1225"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129576"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129576"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129575"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129575"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129576"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">k
k
</span><a href="#local-6989586621679129575"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-1226"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129574"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129574"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129573"><span class="annot"><a href="#local-6989586621679129573"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129572"><span class="annot"><a href="#local-6989586621679129572"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129574"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129573"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129574"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129572"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129571"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129571"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129570"><span class="annot"><a href="#local-6989586621679129570"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129569"><span class="annot"><a href="#local-6989586621679129569"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129571"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129570"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129571"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129569"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129568"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129568"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129567"><span class="annot"><a href="#local-6989586621679129567"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129566"><span class="annot"><a href="#local-6989586621679129566"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129568"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129567"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129568"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129566"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129565"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129565"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129564"><span class="annot"><a href="#local-6989586621679129564"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129563"><span class="annot"><a href="#local-6989586621679129563"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129564"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129563"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129562"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129562"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679129562"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1231"></span><span>
</span><span id="line-1232"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129561"><span class="annot"><a href="#local-6989586621679129561"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129560"><span class="annot"><a href="#local-6989586621679129560"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.isSubsetOf</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129561"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129560"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1233"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129558"><span class="annot"><a href="#local-6989586621679129558"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129557"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129557"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Set k -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129557"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129558"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1234"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129555"><span class="annot"><a href="#local-6989586621679129555"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129554"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129554"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Set k -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129554"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129555"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1235"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129553"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129553"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129552"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129552"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map k v -&gt; Bool
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679129551"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129553"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1236"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129551"><span class="annot"><span class="annottext">accum :: k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679129551"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129550"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129550"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129549"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129549"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679129548"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129548"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129550"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129552"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129548"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1237"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129547"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129547"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129546"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129546"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map k v -&gt; Bool
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679129545"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129547"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1238"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129545"><span class="annot"><span class="annottext">accum :: k -&gt; v -&gt; Bool -&gt; Bool
</span><a href="#local-6989586621679129545"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621679129544"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129544"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129543"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129543"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679129542"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129542"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129544"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129546"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679129542"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1239"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129541"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129541"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679129541"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1240"></span><span>
</span><span id="line-1241"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129540"><span class="annot"><a href="#local-6989586621679129540"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129539"><span class="annot"><a href="#local-6989586621679129539"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129540"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129539"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129538"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129538"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129537"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129537"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.intersection</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129538"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129537"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129536"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129536"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (Sett k ()) -&gt; Sett k ()
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (Sett k ())
</span><a href="#local-6989586621679129536"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1244"></span><span>
</span><span id="line-1245"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129535"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129535"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129534"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129534"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129533"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129533"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129532"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129532"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129533"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129532"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129534"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129531"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129531"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679129530"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129530"><span class="hs-identifier hs-var">_new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129531"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The value on the left is preferred over the right, so 'addkv' chooses 'old'</span><span>
</span><span id="line-1246"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129529"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129529"><span class="hs-identifier hs-var">d0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129528"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129528"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129529"><span class="hs-identifier hs-var">d0</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129528"><span class="hs-identifier hs-var">d1</span></a></span><span>  </span><span class="hs-comment">-- 'Map.union' is left biased, just what we want.</span><span>
</span><span id="line-1247"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129526"><span class="annot"><a href="#local-6989586621679129526"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129525"><span class="annot"><a href="#local-6989586621679129525"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129526"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129525"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129524"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129524"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129523"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129523"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129522"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129522"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129524"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129523"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129522"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1249"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129521"><span class="annot"><a href="#local-6989586621679129521"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129520"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129520"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129519"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129519"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Set k -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.withoutKeys</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129520"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129521"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129519"><span class="hs-identifier hs-var">m3</span></a></span><span>
</span><span id="line-1250"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129518"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129518"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129518"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1251"></span><span>
</span><span id="line-1252"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129517"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129517"><span class="hs-identifier hs-var">_rep</span></a></span></span><span> </span><span id="local-6989586621679129516"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129516"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129515"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129515"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129514"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129514"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129515"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129514"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
f k v
</span><a href="#local-6989586621679129516"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129513"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129513"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679129512"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129512"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129512"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The value on the right is preferred over the left, so 'addkv' chooses 'new'</span><span>
</span><span id="line-1253"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129511"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129511"><span class="hs-identifier hs-var">d0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129510"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129510"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129510"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129511"><span class="hs-identifier hs-var">d0</span></a></span><span>   </span><span class="hs-comment">-- we pass @d1@ as first argument, since 'Map.union' is left biased.</span><span>
</span><span id="line-1254"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129509"><span class="annot"><a href="#local-6989586621679129509"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129508"><span class="annot"><a href="#local-6989586621679129508"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129509"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129508"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129507"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129507"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k v) -&gt; f k v
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k v)
</span><a href="#local-6989586621679129507"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129506"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129506"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129505"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129505"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; Map k v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129506"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129505"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1258"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129503"><span class="annot"><a href="#local-6989586621679129503"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129502"><span class="annot"><a href="#local-6989586621679129502"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129503"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129502"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Recall (Sett k):: f k (), so () &lt;&gt; () = ()</span><span>
</span><span id="line-1259"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129501"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129501"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp (f k n) -&gt; f k n
forall k (f :: * -&gt; * -&gt; *) v. Ord k =&gt; Exp (f k v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#runSetExp"><span class="hs-identifier hs-var">runSetExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp (f k n)
</span><a href="#local-6989586621679129501"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679129500"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129500"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129499"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129499"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129500"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129499"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1262"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span id="local-6989586621679129498"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129498"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129498"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129497"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129497"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129496"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129496"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129497"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129496"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1265"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679129495"><span class="annot"><a href="#local-6989586621679129495"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679129494"><span class="annot"><a href="#local-6989586621679129494"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679129495"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
Map k v
</span><a href="#local-6989586621679129494"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1266"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129493"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129493"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129492"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129492"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129493"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129492"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1267"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679129491"><span class="annot"><a href="#local-6989586621679129491"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679129490"><span class="annot"><a href="#local-6989586621679129490"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall k v1 v2. Ord k =&gt; Map k v1 -&gt; Map k v2 -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#keysEqual"><span class="hs-identifier hs-var">keysEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679129491"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
Map k v
</span><a href="#local-6989586621679129490"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1268"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129489"><span class="annot"><a href="#local-6989586621679129489"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129488"><span class="annot"><a href="#local-6989586621679129488"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129488"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129489"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1269"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129487"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129487"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129486"><span class="annot"><a href="#local-6989586621679129486"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129487"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set k
Set k
</span><a href="#local-6989586621679129486"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1270"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129485"><span class="annot"><span class="annottext">e :: Exp t
</span><a href="#local-6989586621679129485"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp Bool -&gt; Bool
</span><a href="Control.Iterate.SetAlgebra.html#runBoolExp"><span class="hs-identifier hs-var">runBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
Exp Bool
</span><a href="#local-6989586621679129485"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1271"></span><span>
</span><span id="line-1272"></span><span id="local-6989586621679129483"><span id="local-6989586621679129484"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129484"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129483"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129483"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129484"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-1273"></span><span id="eval"><span class="annot"><span class="annottext">eval :: Exp t -&gt; s
</span><a href="Control.Iterate.SetAlgebra.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679129481"><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679129481"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; s
forall concrete base. Embed concrete base =&gt; base -&gt; concrete
</span><a href="Control.Iterate.SetAlgebra.html#fromBase"><span class="hs-identifier hs-var">fromBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp t -&gt; t
forall t. Exp t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">Exp t
</span><a href="#local-6989586621679129481"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- To make compound iterators, i.e. instance (Iter Query), we need &quot;step&quot; functions for each kind</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- ==============================================================================================</span><span>
</span><span id="line-1278"></span><span>
</span><span id="line-1279"></span><span class="hs-comment">-- ==== Project ====</span><span>
</span><span id="line-1280"></span><span id="local-6989586621679131579"><span id="local-6989586621679131580"><span id="local-6989586621679131581"><span id="local-6989586621679131582"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-type">projStep</span></a></span><span>
</span><span id="line-1281"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1282"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131581"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131580"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131580"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1283"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131580"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131579"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131581"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131579"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131579"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1284"></span><span id="projStep"><span class="annot"><span class="annottext">projStep :: (t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var hs-var">projStep</span></a></span></span><span> </span><span id="local-6989586621679129479"><span class="annot"><span class="annottext">t -&gt; Collect (k, v, Query k v)
</span><a href="#local-6989586621679129479"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679129478"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129478"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679129477"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679129477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129476"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129476"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129475"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129475"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129474"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129474"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t -&gt; Collect (k, v, Query k v)
</span><a href="#local-6989586621679129479"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679129477"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, u, Query k u) -&gt; Collect (k, u, Query k u)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129476"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u) -&gt; k -&gt; v -&gt; u
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129478"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129475"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129474"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129478"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1285"></span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- ===== And = ====</span><span>
</span><span id="line-1287"></span><span id="local-6989586621679131621"><span id="local-6989586621679131622"><span id="local-6989586621679131623"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-type">andStep</span></a></span><span>
</span><span id="line-1288"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1289"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131622"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131622"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131621"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131621"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131622"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131621"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131622"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131621"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1291"></span><span id="andStep"><span class="annot"><span class="annottext">andStep :: (a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var hs-var">andStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129472"><span class="annot"><span class="annottext">ftrip :: (a, b1, Query a b1)
</span><a href="#local-6989586621679129472"><span class="hs-identifier hs-var">ftrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129471"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129471"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129470"><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679129470"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129469"><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129469"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129468"><span class="annot"><span class="annottext">gtrip :: (a, b2, Query a b2)
</span><a href="#local-6989586621679129468"><span class="hs-identifier hs-var">gtrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129467"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129467"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129466"><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679129466"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129465"><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129465"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1292"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129471"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129467"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1293"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, (b1, b2), Query a (b1, b2))
-&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129471"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679129470"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679129466"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query a b1 -&gt; Query a b2 -&gt; Query a (b1, b2)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129469"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129465"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1294"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129464"><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129464"><span class="hs-identifier hs-var">ftrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b1 -&gt; Collect (a, b1, Query a b1)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129467"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129469"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129464"><span class="hs-identifier hs-var">ftrip'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129468"><span class="hs-identifier hs-var">gtrip</span></a></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1295"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129462"><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129462"><span class="hs-identifier hs-var">gtrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b2 -&gt; Collect (a, b2, Query a b2)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129471"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129465"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129472"><span class="hs-identifier hs-var">ftrip</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129462"><span class="hs-identifier hs-var">gtrip'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1296"></span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- ==== Chain ====</span><span>
</span><span id="line-1298"></span><span id="local-6989586621679131611"><span id="local-6989586621679131612"><span id="local-6989586621679131613"><span id="local-6989586621679131614"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-type">chainStep</span></a></span><span>
</span><span id="line-1299"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1300"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131614"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131612"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131612"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131611"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131611"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131611"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1302"></span><span id="chainStep"><span class="annot"><span class="annottext">chainStep :: (a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var hs-var">chainStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129460"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129460"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129459"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129459"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129458"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129458"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129457"><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679129457"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129456"><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679129456"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1303"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">b -&gt; Query b w -&gt; Maybe w
forall (f :: * -&gt; * -&gt; *) key rng.
(Iter f, Ord key) =&gt;
key -&gt; f key rng -&gt; Maybe rng
</span><a href="Control.Iterate.SetAlgebra.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129459"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679129457"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- recall that the values 'r1' from f, are not iterated in ascending order, only the keys 'd' are ascending</span><span>
</span><span id="line-1304"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679129455"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679129455"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u) -&gt; Collect (a, u, Query a u)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129460"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u) -&gt; a -&gt; (b, w) -&gt; u
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679129456"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129460"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129459"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679129455"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query a b -&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Query a u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129458"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679129457"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679129456"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1305"></span><span>     </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129454"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129454"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129458"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129454"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query b w
</span><a href="#local-6989586621679129457"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b, w) -&gt; u)
</span><a href="#local-6989586621679129456"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>
</span><span id="line-1308"></span><span class="hs-comment">-- ==== And with Projection ====</span><span>
</span><span id="line-1309"></span><span id="local-6989586621679131603"><span id="local-6989586621679131604"><span id="local-6989586621679131605"><span id="local-6989586621679131606"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-type">andPstep</span></a></span><span>
</span><span id="line-1310"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1311"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131605"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131605"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1312"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131604"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131604"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1313"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131605"><span class="hs-identifier hs-type">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131604"><span class="hs-identifier hs-type">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131603"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1314"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131603"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131603"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1315"></span><span id="andPstep"><span class="annot"><span class="annottext">andPstep :: (a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var hs-var">andPstep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129451"><span class="annot"><span class="annottext">ftrip :: (a, b1, Query a b1)
</span><a href="#local-6989586621679129451"><span class="hs-identifier hs-var">ftrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129450"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129450"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129449"><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679129449"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129448"><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129448"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129447"><span class="annot"><span class="annottext">gtrip :: (a, b2, Query a b2)
</span><a href="#local-6989586621679129447"><span class="hs-identifier hs-var">gtrip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679129446"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129446"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129445"><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679129445"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129444"><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129444"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129443"><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679129443"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1316"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129450"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129446"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1317"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w) -&gt; Collect (a, w, Query a w)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129450"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w) -&gt; a -&gt; (b1, b2) -&gt; w
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679129443"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129450"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b1
</span><a href="#local-6989586621679129449"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b2
</span><a href="#local-6989586621679129445"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query a b1 -&gt; Query a b2 -&gt; Fun (a -&gt; (b1, b2) -&gt; w) -&gt; Query a w
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129448"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129444"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679129443"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1318"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129442"><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129442"><span class="hs-identifier hs-var">ftrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b1 -&gt; Collect (a, b1, Query a b1)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129446"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b1
</span><a href="#local-6989586621679129448"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129442"><span class="hs-identifier hs-var">ftrip'</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129447"><span class="hs-identifier hs-var">gtrip</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679129443"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1319"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129441"><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129441"><span class="hs-identifier hs-var">gtrip'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b2 -&gt; Collect (a, b2, Query a b2)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129450"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b2
</span><a href="#local-6989586621679129444"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b1, Query a b1)
</span><a href="#local-6989586621679129451"><span class="hs-identifier hs-var">ftrip</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b2, Query a b2)
</span><a href="#local-6989586621679129441"><span class="hs-identifier hs-var">gtrip'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (b1, b2) -&gt; w)
</span><a href="#local-6989586621679129443"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- ==== Or with combine ====</span><span>
</span><span id="line-1322"></span><span id="local-6989586621679131570"><span id="local-6989586621679131571"><span id="local-6989586621679131572"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-type">orStep</span></a></span><span>
</span><span id="line-1323"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131571"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1324"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131571"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1325"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1326"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1327"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1328"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131571"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131572"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1329"></span><span id="orStep"><span class="annot"><span class="annottext">orStep :: (Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var hs-var">orStep</span></a></span></span><span> </span><span id="local-6989586621679129439"><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679129439"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679129438"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129438"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129437"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129437"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129436"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1330"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Collect (a, v, Query k v) -&gt; Maybe (a, v, Query k v)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679129439"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129438"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Collect (a, v, Query k v) -&gt; Maybe (a, v, Query k v)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (a, v, Query k v)
</span><a href="#local-6989586621679129439"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129437"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-comment">-- We have to be careful, because if only one has a nxt, there is still an answer</span><span>
</span><span id="line-1331"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (a, v, Query k v)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-1332"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679129435"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129435"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129434"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129434"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129433"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129433"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129435"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129434"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129433"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129437"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1333"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (a, v, Query k v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679129432"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129432"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129431"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129431"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129430"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129430"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129432"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129431"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129430"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1334"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679129429"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129429"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129428"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129428"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129427"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129427"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">(</span><span id="local-6989586621679129426"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129426"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129425"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129425"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129424"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129424"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1335"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129429"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129426"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1336"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129429"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129428"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129425"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129427"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129424"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129429"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129428"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129427"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129437"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1338"></span><span>           </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query k v) -&gt; Collect (a, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129426"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129425"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129424"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129436"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>
</span><span id="line-1340"></span><span class="hs-comment">-- ===== Guard =====</span><span>
</span><span id="line-1341"></span><span id="local-6989586621679131568"><span id="local-6989586621679131569"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-type">guardStep</span></a></span><span>
</span><span id="line-1342"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1343"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1344"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1345"></span><span id="guardStep"><span class="annot"><span class="annottext">guardStep :: (Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var hs-var">guardStep</span></a></span></span><span> </span><span id="local-6989586621679129422"><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129422"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679129421"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129421"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679129420"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129420"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129419"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129419"><span class="hs-identifier hs-var">triple</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129422"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129420"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129418"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129419"><span class="hs-identifier hs-var">triple</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1346"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129418"><span class="annot"><span class="annottext">loop :: (a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129418"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129417"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129417"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129416"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129416"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129415"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129415"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool) -&gt; a -&gt; b -&gt; Bool
forall t. Fun t -&gt; t
</span><a href="Control.Iterate.SetAlgebra.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129421"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129417"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129416"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129417"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129416"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query a b -&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129415"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129421"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129414"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129414"><span class="hs-identifier hs-var">triple</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129415"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129418"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129414"><span class="hs-identifier hs-var">triple</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- ===== Difference by key =====</span><span>
</span><span id="line-1349"></span><span id="local-6989586621679131592"><span id="local-6989586621679131593"><span id="local-6989586621679131594"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-type">diffStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131593"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131593"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131592"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131593"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131594"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131593"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1350"></span><span id="diffStep"><span class="annot"><span class="annottext">diffStep :: (k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var hs-var">diffStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129412"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129411"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129411"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129410"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129410"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679129409"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129409"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1351"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Collect (k, u, Query k u) -&gt; Maybe (k, u, Query k u)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Query k u -&gt; Collect (k, u, Query k u)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129409"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1352"></span><span>      </span><span class="annot"><span class="annottext">Maybe (k, u, Query k u)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129411"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129410"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129409"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- g has nothing to subtract</span><span>
</span><span id="line-1353"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129408"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129408"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129407"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679129407"><span class="hs-identifier hs-var">_u2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129406"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129406"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129408"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1354"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129405"><span class="annot"><span class="annottext">(k, v, Query k v)
</span><a href="#local-6989586621679129405"><span class="hs-identifier hs-var">tup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Collect (k, v, Query k v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129410"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v)
</span><a href="#local-6989586621679129405"><span class="hs-identifier hs-var">tup</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129406"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1355"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129411"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129410"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129409"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1356"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, v, Query k v) -&gt; Collect (k, v, Query k v)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129412"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129411"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Query k v
forall k v u. Ord k =&gt; Query k v -&gt; Query k u -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-var">DiffD</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129410"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129409"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- the hasLub guarantees k1 &lt;= k2, so this case is dead code</span><span>
</span><span id="line-1357"></span><span>
</span><span id="line-1358"></span><span class="hs-comment">-- ========== Rng ====================</span><span>
</span><span id="line-1359"></span><span id="local-6989586621679132777"><span id="local-6989586621679132778"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-type">rngStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679132778"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132777"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132778"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679132778"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1360"></span><span id="rngStep"><span class="annot"><span class="annottext">rngStep :: Query k v -&gt; Sett v ()
</span><a href="Control.Iterate.SetAlgebra.html#rngStep"><span class="hs-identifier hs-var hs-var">rngStep</span></a></span></span><span> </span><span id="local-6989586621679129404"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129404"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v () -&gt; Collect (v, ()) -&gt; Sett v ()
forall k (f :: * -&gt; * -&gt; *) v.
Ord k =&gt;
BaseRep f k v -&gt; Collect (k, v) -&gt; f k v
</span><a href="Control.Iterate.SetAlgebra.html#materialize"><span class="hs-identifier hs-var">materialize</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett v ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Collect (v, ())
forall (f :: * -&gt; * -&gt; *) a a. Iter f =&gt; f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679129403"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129404"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1361"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679129403"><span class="annot"><span class="annottext">loop :: f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679129403"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679129402"><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679129402"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679129401"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129401"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129400"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129400"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129399"><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679129399"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a a -&gt; Collect (a, a, f a a)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679129402"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, ()) -&gt; Collect (a, ()) -&gt; Collect (a, ())
forall t. t -&gt; Collect t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#front"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129400"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a a -&gt; Collect (a, ())
</span><a href="#local-6989586621679129403"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">f a a
</span><a href="#local-6989586621679129399"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1362"></span><span>
</span><span id="line-1363"></span><span class="hs-comment">-- =========================== Now the Iter instance for Query ======================</span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span id="local-6989586621679131615"><span id="local-6989586621679131616"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-type">nxtQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131615"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131616"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131615"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131615"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1366"></span><span id="nxtQuery"><span class="annot"><span class="annottext">nxtQuery :: Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var hs-var">nxtQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679129398"><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679129398"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129397"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129397"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679129396"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129396"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129395"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129395"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129394"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129394"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129397"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129396"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129395"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f a b -&gt; f a b -&gt; Query a b
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679129398"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129394"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1367"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129393"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129393"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129392"><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679129392"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a v -&gt; Collect (a, v, Query a v))
-&gt; Fun (a -&gt; v -&gt; b) -&gt; Query a v -&gt; Collect (a, b, Query a b)
forall k t v u.
Ord k =&gt;
(t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var">projStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679129392"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129393"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1368"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679129391"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129391"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129390"><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679129390"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129389"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129389"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129391"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679129388"><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679129388"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a w -&gt; Collect (a, w, Query a w)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679129390"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, w, Query a w) -&gt; Collect (a, (v, w), Query a (v, w))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129389"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679129388"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1369"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679129387"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129387"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129386"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129386"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129385"><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679129385"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129384"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129384"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129387"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; Query v w -&gt; Fun (a -&gt; (v, w) -&gt; b) -&gt; Collect (a, b, Query a b)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129384"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129386"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679129385"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1370"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679129383"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129383"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129382"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129382"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129381"><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679129381"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129380"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129380"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a v -&gt; Collect (a, v, Query a v)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129383"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679129379"><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679129379"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a u -&gt; Collect (a, u, Query a u)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129382"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, u, Query a u)
-&gt; Fun (a -&gt; (v, u) -&gt; b)
-&gt; Collect (a, b, Query a b)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129380"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679129379"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679129381"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1371"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679129378"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129378"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129377"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129377"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129376"><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679129376"><span class="hs-identifier hs-var">comb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Query a b
-&gt; Query a b
-&gt; Fun (b -&gt; b -&gt; b)
-&gt; Collect (a, b, Query a b)
forall k a v.
(Ord k, Ord a) =&gt;
(Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var">orStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129378"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129377"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679129376"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1372"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679129375"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129375"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129374"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129374"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b.
Ord a =&gt;
(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var">guardStep</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129374"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129375"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1373"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679129373"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129373"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129372"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129372"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129371"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129371"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129373"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Query a u -&gt; Collect (a, b, Query a b)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129371"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129372"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span id="local-6989586621679131624"><span id="local-6989586621679131625"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-type">lubQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679131625"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131625"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131625"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131624"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131625"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131624"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131625"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131624"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1376"></span><span id="lubQuery"><span class="annot"><span class="annottext">lubQuery :: a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var hs-var">lubQuery</span></a></span></span><span> </span><span id="local-6989586621679129370"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129370"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679129369"><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679129369"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129368"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129368"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679129367"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129367"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129366"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129366"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679129365"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129365"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.SetAlgebra.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129370"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129368"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Collect (a, b, Query a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129367"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679129366"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BaseRep f a b -&gt; f a b -&gt; Query a b
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f a b
</span><a href="#local-6989586621679129369"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679129365"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1377"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129364"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129364"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129363"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129363"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129362"><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679129362"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a v -&gt; Collect (a, v, Query a v))
-&gt; Fun (a -&gt; v -&gt; b) -&gt; Query a v -&gt; Collect (a, b, Query a b)
forall k t v u.
Ord k =&gt;
(t -&gt; Collect (k, v, Query k v))
-&gt; Fun (k -&gt; v -&gt; u) -&gt; t -&gt; Collect (k, u, Query k u)
</span><a href="Control.Iterate.SetAlgebra.html#projStep"><span class="hs-identifier hs-var">projStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129364"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; v -&gt; b)
</span><a href="#local-6989586621679129362"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129363"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1378"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129361"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129361"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679129360"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129360"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129359"><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679129359"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129358"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129358"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129361"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129360"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679129357"><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679129357"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a w -&gt; Collect (a, w, Query a w)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129361"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a w
</span><a href="#local-6989586621679129359"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, w, Query a w) -&gt; Collect (a, (v, w), Query a (v, w))
forall a b1 b2.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2) -&gt; Collect (a, (b1, b2), Query a (b1, b2))
</span><a href="Control.Iterate.SetAlgebra.html#andStep"><span class="hs-identifier hs-var">andStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129358"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, w, Query a w)
</span><a href="#local-6989586621679129357"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1379"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129356"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129356"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679129355"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129355"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129354"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129354"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129353"><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679129353"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129352"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129352"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129356"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129355"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; Query v w -&gt; Fun (a -&gt; (v, w) -&gt; b) -&gt; Collect (a, b, Query a b)
forall b a w u.
(Ord b, Ord a) =&gt;
(a, b, Query a b)
-&gt; Query b w -&gt; Fun (a -&gt; (b, w) -&gt; u) -&gt; Collect (a, u, Query a u)
</span><a href="Control.Iterate.SetAlgebra.html#chainStep"><span class="hs-identifier hs-var">chainStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129352"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129354"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, w) -&gt; b)
</span><a href="#local-6989586621679129353"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1380"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span>  </span><span id="local-6989586621679129351"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129351"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679129350"><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129350"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129349"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129349"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129348"><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679129348"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129347"><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129347"><span class="hs-identifier hs-var">triple1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a v -&gt; Collect (a, v, Query a v)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129351"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a v
</span><a href="#local-6989586621679129350"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679129346"><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679129346"><span class="hs-identifier hs-var">triple2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a u -&gt; Collect (a, u, Query a u)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129351"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129349"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
-&gt; (a, u, Query a u)
-&gt; Fun (a -&gt; (v, u) -&gt; b)
-&gt; Collect (a, b, Query a b)
forall a b1 b2 w.
Ord a =&gt;
(a, b1, Query a b1)
-&gt; (a, b2, Query a b2)
-&gt; Fun (a -&gt; (b1, b2) -&gt; w)
-&gt; Collect (a, w, Query a w)
</span><a href="Control.Iterate.SetAlgebra.html#andPstep"><span class="hs-identifier hs-var">andPstep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, v, Query a v)
</span><a href="#local-6989586621679129347"><span class="hs-identifier hs-var">triple1</span></a></span><span> </span><span class="annot"><span class="annottext">(a, u, Query a u)
</span><a href="#local-6989586621679129346"><span class="hs-identifier hs-var">triple2</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; (v, u) -&gt; b)
</span><a href="#local-6989586621679129348"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1381"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129345"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129345"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679129344"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129344"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129343"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129343"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129342"><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679129342"><span class="hs-identifier hs-var">comb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Query a b
-&gt; Query a b
-&gt; Fun (b -&gt; b -&gt; b)
-&gt; Collect (a, b, Query a b)
forall k a v.
(Ord k, Ord a) =&gt;
(Query k v -&gt; Collect (a, v, Query k v))
-&gt; Query k v
-&gt; Query k v
-&gt; Fun (v -&gt; v -&gt; v)
-&gt; Collect (a, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#orStep"><span class="hs-identifier hs-var">orStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129345"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129344"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129343"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Fun (b -&gt; b -&gt; b)
</span><a href="#local-6989586621679129342"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1382"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129341"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129341"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679129340"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129340"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129339"><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129339"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b.
Ord a =&gt;
(Query a b -&gt; Collect (a, b, Query a b))
-&gt; Fun (a -&gt; b -&gt; Bool) -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#guardStep"><span class="hs-identifier hs-var">guardStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129341"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (a -&gt; b -&gt; Bool)
</span><a href="#local-6989586621679129339"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129340"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1383"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span id="local-6989586621679129338"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129338"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679129337"><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129337"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129336"><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129336"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679129335"><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129335"><span class="hs-identifier hs-var">trip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Query a b -&gt; Collect (a, b, Query a b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679129338"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Query a b
</span><a href="#local-6989586621679129337"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b) -&gt; Query a u -&gt; Collect (a, b, Query a b)
forall k v u.
Ord k =&gt;
(k, v, Query k v) -&gt; Query k u -&gt; Collect (k, v, Query k v)
</span><a href="Control.Iterate.SetAlgebra.html#diffStep"><span class="hs-identifier hs-var">diffStep</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, Query a b)
</span><a href="#local-6989586621679129335"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">Query a u
</span><a href="#local-6989586621679129336"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1384"></span><span>
</span><span id="line-1385"></span><span>
</span><span id="line-1386"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679129321"><span id="local-6989586621679129323"><span id="local-6989586621679129325"><span id="local-6989586621679129327"><span id="local-6989586621679129329"><span id="local-6989586621679129331"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1387"></span><span>   </span><span id="local-6989586621679129320"><span class="annot"><span class="annottext">nxt :: Query a b -&gt; Collect (a, b, Query a b)
</span><a href="#local-6989586621679129320"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query a b -&gt; Collect (a, b, Query a b)
forall a b. Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#nxtQuery"><span class="hs-identifier hs-var">nxtQuery</span></a></span><span>
</span><span id="line-1388"></span><span>   </span><span id="local-6989586621679129319"><span class="annot"><span class="annottext">lub :: k -&gt; Query k b -&gt; Collect (k, b, Query k b)
</span><a href="#local-6989586621679129319"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Query k b -&gt; Collect (k, b, Query k b)
forall a b. Ord a =&gt; a -&gt; Query a b -&gt; Collect (a, b, Query a b)
</span><a href="Control.Iterate.SetAlgebra.html#lubQuery"><span class="hs-identifier hs-var">lubQuery</span></a></span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span class="hs-comment">-- =======================================================================================</span><span>
</span><span id="line-1391"></span><span class="hs-comment">-- Finally we make smart constructors for Query, so we can lift un-embedded Base types</span><span>
</span><span id="line-1392"></span><span class="hs-comment">-- into Queries, so programmers don't need to know about List and Sett.</span><span>
</span><span id="line-1393"></span><span>
</span><span id="line-1394"></span><span id="local-6989586621679129315"><span id="local-6989586621679129316"><span id="local-6989586621679129317"><span id="local-6989586621679129318"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#projectQ"><span class="hs-identifier hs-type">projectQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129318"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129317"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129318"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129316"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129317"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129318"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129316"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129318"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129315"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span><span>
</span><span id="line-1395"></span><span id="projectQ"><span class="annot"><span class="annottext">projectQ :: c -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#projectQ"><span class="hs-identifier hs-var hs-var">projectQ</span></a></span></span><span> </span><span id="local-6989586621679129313"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679129313"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679129312"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129312"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
forall k v u. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-var">ProjectD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679129313"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; u)
</span><a href="#local-6989586621679129312"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span id="local-6989586621679129306"><span id="local-6989586621679129307"><span id="local-6989586621679129308"><span id="local-6989586621679129309"><span id="local-6989586621679129310"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andQ"><span class="hs-identifier hs-type">andQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129310"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129309"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129310"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129308"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129307"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129310"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129306"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129309"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129307"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129310"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129308"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129306"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1398"></span><span id="andQ"><span class="annot"><span class="annottext">andQ :: concrete1 -&gt; concrete2 -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#andQ"><span class="hs-identifier hs-var hs-var">andQ</span></a></span></span><span> </span><span id="local-6989586621679129304"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129303"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129303"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k w -&gt; Query k (v, w)
forall k v w. Ord k =&gt; Query k v -&gt; Query k w -&gt; Query k (v, w)
</span><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-var">AndD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129304"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k w
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129303"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span id="local-6989586621679129299"><span id="local-6989586621679129300"><span id="local-6989586621679129301"><span id="local-6989586621679129302"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#orQ"><span class="hs-identifier hs-type">orQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1401"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129301"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129299"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1402"></span><span>  </span><span class="annot"><a href="#local-6989586621679129301"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129299"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129302"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129300"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-1403"></span><span id="orQ"><span class="annot"><span class="annottext">orQ :: concrete1 -&gt; concrete2 -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#orQ"><span class="hs-identifier hs-var hs-var">orQ</span></a></span></span><span> </span><span id="local-6989586621679129297"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129297"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129296"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129296"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679129295"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129295"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
forall k v.
Ord k =&gt;
Query k v -&gt; Query k v -&gt; Fun (v -&gt; v -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-var">OrD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129297"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129296"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129295"><span class="hs-identifier hs-var">comb</span></a></span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span id="local-6989586621679129289"><span id="local-6989586621679129290"><span id="local-6989586621679129291"><span id="local-6989586621679129292"><span id="local-6989586621679129293"><span id="local-6989586621679129294"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#chainQ"><span class="hs-identifier hs-type">chainQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1406"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129294"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129292"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129294"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129291"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129293"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129290"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1407"></span><span>   </span><span class="annot"><a href="#local-6989586621679129292"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129291"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129294"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129293"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129290"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129289"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129294"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129289"><span class="hs-identifier hs-type">u</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1408"></span><span id="chainQ"><span class="annot"><span class="annottext">chainQ :: concrete1 -&gt; concrete2 -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#chainQ"><span class="hs-identifier hs-var hs-var">chainQ</span></a></span></span><span> </span><span id="local-6989586621679129287"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129287"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129286"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129286"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679129285"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129285"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
forall k v w u.
(Ord k, Ord v) =&gt;
Query k v -&gt; Query v w -&gt; Fun (k -&gt; (v, w) -&gt; u) -&gt; Query k u
</span><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-var">ChainD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129287"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query v w
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129286"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; u)
</span><a href="#local-6989586621679129285"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span id="local-6989586621679129279"><span id="local-6989586621679129280"><span id="local-6989586621679129281"><span id="local-6989586621679129282"><span id="local-6989586621679129283"><span id="local-6989586621679129284"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#andPQ"><span class="hs-identifier hs-type">andPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1411"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129284"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129283"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129284"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129282"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129281"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129284"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129280"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1412"></span><span>   </span><span class="annot"><a href="#local-6989586621679129283"><span class="hs-identifier hs-type">concrete1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129281"><span class="hs-identifier hs-type">concrete2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129284"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129282"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679129280"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129279"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129284"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129279"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1413"></span><span id="andPQ"><span class="annot"><span class="annottext">andPQ :: concrete1 -&gt; concrete2 -&gt; Fun (k -&gt; (v, u) -&gt; w) -&gt; Query k w
</span><a href="Control.Iterate.SetAlgebra.html#andPQ"><span class="hs-identifier hs-var hs-var">andPQ</span></a></span></span><span> </span><span id="local-6989586621679129277"><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129277"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129276"><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129276"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679129275"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; w)
</span><a href="#local-6989586621679129275"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Query k u -&gt; Fun (k -&gt; (v, u) -&gt; w) -&gt; Query k w
forall k v1 u v.
Ord k =&gt;
Query k v1 -&gt; Query k u -&gt; Fun (k -&gt; (v1, u) -&gt; v) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-var">AndPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete1 -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete1
</span><a href="#local-6989586621679129277"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete2 -&gt; Query k u
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete2
</span><a href="#local-6989586621679129276"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; w)
</span><a href="#local-6989586621679129275"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1414"></span><span>
</span><span id="line-1415"></span><span id="local-6989586621679129272"><span id="local-6989586621679129273"><span id="local-6989586621679129274"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#guardQ"><span class="hs-identifier hs-type">guardQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1416"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129273"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1417"></span><span>   </span><span class="annot"><a href="#local-6989586621679129273"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Fun"><span class="hs-identifier hs-type">Fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129274"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129272"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1418"></span><span id="guardQ"><span class="annot"><span class="annottext">guardQ :: concrete -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#guardQ"><span class="hs-identifier hs-var hs-var">guardQ</span></a></span></span><span> </span><span id="local-6989586621679129270"><span class="annot"><span class="annottext">concrete
</span><a href="#local-6989586621679129270"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129269"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129269"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
forall k v. Ord k =&gt; Query k v -&gt; Fun (k -&gt; v -&gt; Bool) -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-var">GuardD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">concrete -&gt; Query k v
forall concrete k v. HasQuery concrete k v =&gt; concrete -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">concrete
</span><a href="#local-6989586621679129270"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129269"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1419"></span><span>
</span><span id="line-1420"></span><span class="hs-comment">-- Don't know why this won't type check</span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- diffQ :: (Ord k, HasQuery concrete1 k v, HasQuery concrete2 k u) =&gt; concrete1 -&gt; concrete2 -&gt; Query k v</span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- diffQ = \ x y -&gt; DiffD (query x) (query y)</span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span class="hs-keyword">class</span><span> </span><span id="HasQuery"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-var">HasQuery</span></a></span></span><span> </span><span id="local-6989586621679131535"><span class="annot"><a href="#local-6989586621679131535"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679131534"><span class="annot"><a href="#local-6989586621679131534"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679131533"><span class="annot"><a href="#local-6989586621679131533"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1425"></span><span>  </span><span id="query"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#query"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679131535"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131534"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131533"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1426"></span><span>
</span><span id="line-1427"></span><span id="local-6989586621679129267"><span id="local-6989586621679129268"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129268"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129267"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129268"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129267"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1428"></span><span>   </span><span id="local-6989586621679129264"><span class="annot"><span class="annottext">query :: Query k v -&gt; Query k v
</span><a href="#local-6989586621679129264"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129263"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129263"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129263"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1429"></span><span>
</span><span id="line-1430"></span><span id="local-6989586621679129261"><span id="local-6989586621679129262"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129262"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679129262"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679129261"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679129262"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129261"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1431"></span><span>   </span><span id="local-6989586621679129259"><span class="annot"><span class="annottext">query :: [(k, v)] -&gt; Query k v
</span><a href="#local-6989586621679129259"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129258"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679129258"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep List k v -&gt; List k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep List k v
forall k v. Basic List =&gt; BaseRep List k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.SetAlgebra.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679129257"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129257"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679129256"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129256"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679129257"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679129258"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1432"></span><span>
</span><span id="line-1433"></span><span id="local-6989586621679129255"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129255"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679129255"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129255"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1434"></span><span>   </span><span id="local-6989586621679129253"><span class="annot"><span class="annottext">query :: Set k -&gt; Query k ()
</span><a href="#local-6989586621679129253"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129252"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129252"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k () -&gt; Sett k () -&gt; Query k ()
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Sett k ()
forall k. Basic Sett =&gt; BaseRep Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129252"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1435"></span><span>
</span><span id="line-1436"></span><span id="local-6989586621679129250"><span id="local-6989586621679129251"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129251"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679129251"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129250"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129251"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129250"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1437"></span><span>   </span><span id="local-6989586621679129248"><span class="annot"><span class="annottext">query :: Map k v -&gt; Query k v
</span><a href="#local-6989586621679129248"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129247"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679129247"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v -&gt; Map k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Map k v
forall k v. Basic Map =&gt; BaseRep Map k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679129247"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span id="local-6989586621679129245"><span id="local-6989586621679129246"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129245"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129245"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129245"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129246"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1440"></span><span>   </span><span id="local-6989586621679129243"><span class="annot"><span class="annottext">query :: BiMap v k v -&gt; Query k v
</span><a href="#local-6989586621679129243"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129242"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679129242"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v -&gt; BiMap v k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep (BiMap v) k v
forall v k. (Basic (BiMap v), Ord v) =&gt; BaseRep (BiMap v) k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679129242"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1441"></span><span>
</span><span id="line-1442"></span><span id="local-6989586621679129240"><span id="local-6989586621679129241"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679129241"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#HasQuery"><span class="hs-identifier hs-type">HasQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129241"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679129241"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129240"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1443"></span><span>   </span><span id="local-6989586621679129238"><span class="annot"><span class="annottext">query :: Single k v -&gt; Query k v
</span><a href="#local-6989586621679129238"><span class="hs-identifier hs-var hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679129237"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679129237"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v -&gt; Single k v -&gt; Query k v
forall (f :: * -&gt; * -&gt; *) k v.
(Iter f, Ord k) =&gt;
BaseRep f k v -&gt; f k v -&gt; Query k v
</span><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-var">BaseD</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep Single k v
forall k v. Basic Single =&gt; BaseRep Single k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679129237"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-1446"></span><span class="hs-comment">-- Show Instances</span><span>
</span><span id="line-1447"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-1448"></span><span>
</span><span id="line-1449"></span><span id="local-6989586621679129234"><span id="local-6989586621679129235"><span id="local-6989586621679129236"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679129229"><span id="local-6989586621679129232"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129236"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129235"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129234"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1450"></span><span>  </span><span id="local-6989586621679129228"><span class="annot"><span class="annottext">show :: BaseRep f k v -&gt; [Char]
</span><a href="#local-6989586621679129228"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map&quot;</span></span><span>
</span><span id="line-1451"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Set&quot;</span></span><span>
</span><span id="line-1452"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;List&quot;</span></span><span>
</span><span id="line-1453"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Single&quot;</span></span><span>
</span><span id="line-1454"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BiMap&quot;</span></span></span></span></span><span>
</span><span id="line-1455"></span><span>
</span><span id="line-1456"></span><span id="local-6989586621679129227"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679129222"><span id="local-6989586621679129225"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129227"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1457"></span><span>  </span><span id="local-6989586621679129221"><span class="annot"><span class="annottext">show :: Exp t -&gt; [Char]
</span><a href="#local-6989586621679129221"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span id="local-6989586621679129220"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129220"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">f k v
Map k v
</span><a href="#local-6989586621679129220"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1458"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679129218"><span class="annot"><a href="#local-6989586621679129218"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Set(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set k -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679129218"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1459"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span id="local-6989586621679129217"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129217"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;List(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List k v -&gt; [(k, v)]
forall k v. List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.SetAlgebra.html#unList"><span class="hs-identifier hs-var">unList</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
List k v
</span><a href="#local-6989586621679129217"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)?&quot;</span></span><span>
</span><span id="line-1460"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Single(_ _)&quot;</span></span><span>
</span><span id="line-1461"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.SetAlgebra.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;SetSingle(_)&quot;</span></span><span>
</span><span id="line-1462"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679129215"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129215"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129214"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129214"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseRep f k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129215"><span class="hs-identifier hs-var">rep</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-1463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span id="local-6989586621679129213"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129213"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(dom &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129213"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span id="local-6989586621679129212"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129212"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(rng &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129212"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1465"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DRestrict"><span class="hs-identifier hs-type">DRestrict</span></a></span><span> </span><span id="local-6989586621679129211"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129211"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129210"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129210"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129211"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#9665; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129210"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1466"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DExclude"><span class="hs-identifier hs-type">DExclude</span></a></span><span> </span><span id="local-6989586621679129209"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129209"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129208"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129208"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129209"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8938; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129208"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1467"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RRestrict"><span class="hs-identifier hs-type">RRestrict</span></a></span><span> </span><span id="local-6989586621679129207"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129207"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129206"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129206"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129207"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#9655; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129206"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#RExclude"><span class="hs-identifier hs-type">RExclude</span></a></span><span> </span><span id="local-6989586621679129205"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129205"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129204"><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129204"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129205"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8939; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g v ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g v ())
</span><a href="#local-6989586621679129204"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1469"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679129203"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129203"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129202"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129202"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129203"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8712; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129202"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1470"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#NotElem"><span class="hs-identifier hs-type">NotElem</span></a></span><span> </span><span id="local-6989586621679129201"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129201"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679129200"><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129200"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679129201"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8713; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k ()) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k ())
</span><a href="#local-6989586621679129200"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1471"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Intersect"><span class="hs-identifier hs-type">Intersect</span></a></span><span> </span><span id="local-6989586621679129199"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129199"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129198"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129198"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129199"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8745; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129198"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1472"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span id="local-6989586621679129197"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129197"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129196"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129196"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129197"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8838; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129196"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1473"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideLeft"><span class="hs-identifier hs-type">UnionOverrideLeft</span></a></span><span> </span><span id="local-6989586621679129195"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129195"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129194"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129194"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129195"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8746; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129194"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionPlus"><span class="hs-identifier hs-type">UnionPlus</span></a></span><span> </span><span id="local-6989586621679129193"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129193"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129192"><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129192"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k n) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129193"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8746;+ &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k n) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k n)
</span><a href="#local-6989586621679129192"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1475"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#UnionOverrideRight"><span class="hs-identifier hs-type">UnionOverrideRight</span></a></span><span> </span><span id="local-6989586621679129191"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129191"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129190"><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129190"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129191"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#10755; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k v)
</span><a href="#local-6989586621679129190"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(singleton _ _ )&quot;</span></span><span>
</span><span id="line-1477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#SetSingleton"><span class="hs-identifier hs-type">SetSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(setSingleton _ )&quot;</span></span><span>
</span><span id="line-1478"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#KeyEqual"><span class="hs-identifier hs-type">KeyEqual</span></a></span><span> </span><span id="local-6989586621679129189"><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129189"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679129188"><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129188"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (f k v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (f k v)
</span><a href="#local-6989586621679129189"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &#8781; &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Exp (g k u) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Exp (g k u)
</span><a href="#local-6989586621679129188"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span></span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span id="local-6989586621679131408"><span id="local-6989586621679131409"><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-type">ppQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131409"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131408"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span></span><span>
</span><span id="line-1481"></span><span id="ppQuery"><span class="annot"><span class="annottext">ppQuery :: Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var hs-var">ppQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#BaseD"><span class="hs-identifier hs-type">BaseD</span></a></span><span> </span><span id="local-6989586621679129186"><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129186"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679129185"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679129185"><span class="hs-identifier hs-var">_f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseRep f k v -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="#local-6989586621679129186"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1482"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ProjectD"><span class="hs-identifier hs-type">ProjectD</span></a></span><span> </span><span id="local-6989586621679129184"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129183"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679129183"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129184"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; v)
</span><a href="#local-6989586621679129183"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndD"><span class="hs-identifier hs-type">AndD</span></a></span><span> </span><span id="local-6989586621679129182"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129182"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129181"><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679129181"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;And&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129182"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k w -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k w
</span><a href="#local-6989586621679129181"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ChainD"><span class="hs-identifier hs-type">ChainD</span></a></span><span> </span><span id="local-6989586621679129180"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129180"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129179"><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129179"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129178"><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v)
</span><a href="#local-6989586621679129178"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Chain&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129180"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query v w -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query v w
</span><a href="#local-6989586621679129179"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, w) -&gt; v)
</span><a href="#local-6989586621679129178"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1485"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#OrD"><span class="hs-identifier hs-type">OrD</span></a></span><span> </span><span id="local-6989586621679129177"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129177"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129176"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129176"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129175"><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129175"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Or&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129177"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129176"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (v -&gt; v -&gt; v)
</span><a href="#local-6989586621679129175"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1486"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#GuardD"><span class="hs-identifier hs-type">GuardD</span></a></span><span> </span><span id="local-6989586621679129174"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129174"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129173"><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129173"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Guard&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129174"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; v -&gt; Bool)
</span><a href="#local-6989586621679129173"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1487"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#DiffD"><span class="hs-identifier hs-type">DiffD</span></a></span><span> </span><span id="local-6989586621679129172"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129172"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129171"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129171"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Diff&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129172"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k u -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129171"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#AndPD"><span class="hs-identifier hs-type">AndPD</span></a></span><span> </span><span id="local-6989586621679129170"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129170"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679129169"><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129169"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679129168"><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679129168"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AndP&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">align</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">vsep</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129170"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query k u -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k u
</span><a href="#local-6989586621679129169"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Fun (k -&gt; (v, u) -&gt; v)
</span><a href="#local-6989586621679129168"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1489"></span><span>
</span><span id="line-1490"></span><span>
</span><span id="line-1491"></span><span id="local-6989586621679129166"><span id="local-6989586621679129167"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679129161"><span id="local-6989586621679129164"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.SetAlgebra.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129167"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679129166"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1492"></span><span>   </span><span id="local-6989586621679129160"><span class="annot"><span class="annottext">show :: Query k v -&gt; [Char]
</span><a href="#local-6989586621679129160"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679129159"><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129159"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query k v -&gt; Doc
forall k v. Query k v -&gt; Doc
</span><a href="Control.Iterate.SetAlgebra.html#ppQuery"><span class="hs-identifier hs-var">ppQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query k v
</span><a href="#local-6989586621679129159"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1493"></span></pre></body></html>